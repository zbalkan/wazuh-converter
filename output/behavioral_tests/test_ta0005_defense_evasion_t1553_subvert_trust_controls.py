import unittest

from internal.logtest import LogtestStatus, send_multiple_logs  # type: ignore


class TestTa0005DefenseEvasionT1553SubvertTrustControls(unittest.TestCase):

    def test_id12_13_sip_provider_registration(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4075398Z", "eventRecordID": "133", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1543,technique_name=Service Creation\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.406\nProcessGuid: {668ea4ef-a6d3-626b-4601-000000001400}\nProcessId: 4720\nImage: C:\\Windows\\system32\\cmd.exe\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\bam\\UserSettings\\S-1-5-21-113448046-927799223-410490820-1001\\\\Device\\HarddiskVolume4\\Windows\\System32\\regsvr32.exe\nDetails: Binary Data\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1543,technique_name=Service Creation", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.406", "processGuid": "{668ea4ef-a6d3-626b-4601-000000001400}", "processId": "4720", "image": "C:\\Windows\\system32\\cmd.exe", "targetObject": "HKLM\\System\\CurrentControlSet\\Services\\bam\\UserSettings\\S-1-5-21-113448046-927799223-410490820-1001\\\\Device\\HarddiskVolume4\\Windows\\System32\\regsvr32.exe", "details": "Binary Data", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4327552Z", "eventRecordID": "135", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllPutSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllPutSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4328760Z", "eventRecordID": "136", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllPutSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll\nDetails: C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllPutSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll", "details": "C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4329872Z", "eventRecordID": "137", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllPutSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllPutSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4330905Z", "eventRecordID": "138", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllPutSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName\nDetails: MyPutSignature\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllPutSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName", "details": "MyPutSignature", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4331954Z", "eventRecordID": "139", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllGetSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllGetSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4333021Z", "eventRecordID": "140", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllGetSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll\nDetails: C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllGetSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll", "details": "C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4333912Z", "eventRecordID": "141", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllGetSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllGetSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4334905Z", "eventRecordID": "142", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllGetSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName\nDetails: GetLegitMSSignature\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllGetSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName", "details": "GetLegitMSSignature", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4335796Z", "eventRecordID": "143", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllRemoveSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllRemoveSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4336777Z", "eventRecordID": "144", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllRemoveSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll\nDetails: C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllRemoveSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll", "details": "C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4337657Z", "eventRecordID": "145", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllRemoveSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllRemoveSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4338615Z", "eventRecordID": "146", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllRemoveSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName\nDetails: MyDelSignature\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllRemoveSignedDataMsg\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName", "details": "MyDelSignature", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4339512Z", "eventRecordID": "147", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllCreateIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllCreateIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4340420Z", "eventRecordID": "148", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllCreateIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll\nDetails: C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllCreateIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll", "details": "C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4341310Z", "eventRecordID": "149", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllCreateIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllCreateIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4342337Z", "eventRecordID": "150", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllCreateIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName\nDetails: MyCreateHash\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllCreateIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName", "details": "MyCreateHash", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4343217Z", "eventRecordID": "151", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllVerifyIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllVerifyIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4344113Z", "eventRecordID": "152", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllVerifyIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll\nDetails: C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllVerifyIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll", "details": "C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4344993Z", "eventRecordID": "153", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllVerifyIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllVerifyIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4345980Z", "eventRecordID": "154", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllVerifyIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName\nDetails: AutoApproveHash\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllVerifyIndirectData\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName", "details": "AutoApproveHash", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4346933Z", "eventRecordID": "155", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllIsMyFileType2\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllIsMyFileType2\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4347818Z", "eventRecordID": "156", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllIsMyFileType2\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll\nDetails: C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllIsMyFileType2\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\Dll", "details": "C:\\Users\\Admin\\source\\repos\\PoCSubjectInterfacePackage\\x64\\Debug\\MySIP.dll", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4348686Z", "eventRecordID": "157", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: CreateKey\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllIsMyFileType2\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "CreateKey", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllIsMyFileType2\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:21.4349583Z", "eventRecordID": "158", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:21.422\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllIsMyFileType2\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName\nDetails: IsMyFileExtension\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1553.003,technique_name=SIP and Trust Provider Hijacking", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:21.422", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType 0\\CryptSIPDllIsMyFileType2\\{E59B6E68-3312-4738-961F-DB9405B2DDCB}\\FuncName", "details": "IsMyFileExtension", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:58:30.5586138Z", "eventRecordID": "159", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1543,technique_name=Service Creation\nEventType: SetValue\nUtcTime: 2022-04-29 08:58:30.550\nProcessGuid: {668ea4ef-a8ad-626b-9601-000000001400}\nProcessId: 2760\nImage: C:\\Windows\\system32\\regsvr32.exe\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\bam\\UserSettings\\S-1-5-21-113448046-927799223-410490820-1001\\\\Device\\HarddiskVolume4\\Windows\\System32\\regsvr32.exe\nDetails: Binary Data\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1543,technique_name=Service Creation", "eventType": "SetValue", "utcTime": "2022-04-29 08:58:30.550", "processGuid": "{668ea4ef-a8ad-626b-9601-000000001400}", "processId": "2760", "image": "C:\\Windows\\system32\\regsvr32.exe", "targetObject": "HKLM\\System\\CurrentControlSet\\Services\\bam\\UserSettings\\S-1-5-21-113448046-927799223-410490820-1001\\\\Device\\HarddiskVolume4\\Windows\\System32\\regsvr32.exe", "details": "Binary Data", "user": "WIN\\Admin"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-29T08:59:01.0638862Z", "eventRecordID": "162", "processID": "8940", "threadID": "7716", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "WIN", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1546.001,technique_name=Change Default File Association\nEventType: CreateKey\nUtcTime: 2022-04-29 08:59:01.059\nProcessGuid: {668ea4ef-a43a-626b-3c00-000000001400}\nProcessId: 3572\nImage: C:\\Windows\\Explorer.EXE\nTargetObject: HKU\\S-1-5-21-113448046-927799223-410490820-1001\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts\\.evtx\nUser: WIN\\Admin"}, "eventdata": {"ruleName": "technique_id=T1546.001,technique_name=Change Default File Association", "eventType": "CreateKey", "utcTime": "2022-04-29 08:59:01.059", "processGuid": "{668ea4ef-a43a-626b-3c00-000000001400}", "processId": "3572", "image": "C:\\Windows\\Explorer.EXE", "targetObject": "HKU\\S-1-5-21-113448046-927799223-410490820-1001\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts\\.evtx", "user": "WIN\\Admin"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")
