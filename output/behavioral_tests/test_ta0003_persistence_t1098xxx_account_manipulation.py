import unittest

from internal.logtest import LogtestStatus, send_multiple_logs  # type: ignore


class TestTa0003PersistenceT1098xxxAccountManipulation(unittest.TestCase):

    def test_id33205_sql_server_member_added_to_database_role(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "MSSQL$RADAR", "providerGuid": {"@Name": "MSSQL$RADAR"}, "eventID": "33205", "level": "0", "task": "5", "keywords": "0xa0000000000000", "systemTime": "2020-07-15T21:10:18.6086660Z", "eventRecordID": "59127", "channel": "Application", "computer": "mssql01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Failed to get metadata for provider MSSQL$RADAR)"}, "eventdata": {}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id33205_sql_server_member_added_to_server_role(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "MSSQL$RADAR", "providerGuid": {"@Name": "MSSQL$RADAR"}, "eventID": "33205", "level": "0", "task": "5", "keywords": "0xa0000000000000", "systemTime": "2020-07-15T21:06:38.2888830Z", "eventRecordID": "59082", "channel": "Application", "computer": "mssql01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Failed to get metadata for provider MSSQL$RADAR)"}, "eventdata": {}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id33205_sql_server_user_linked_to_a_database(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "MSSQL$RADAR", "providerGuid": {"@Name": "MSSQL$RADAR"}, "eventID": "33205", "level": "0", "task": "5", "keywords": "0xa0000000000000", "systemTime": "2020-07-15T21:09:08.5124304Z", "eventRecordID": "59120", "channel": "Application", "computer": "mssql01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Failed to get metadata for provider MSSQL$RADAR)"}, "eventdata": {}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4688_spn_added_to_an_account(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-09T21:29:05.9858058Z", "eventRecordID": "2558200", "processID": "4", "threadID": "1028", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x1D41A5FA\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x23c8\n\tNew Process Name:\tC:\\Windows\\System32\\setspn.exe\n\tToken Elevation Type:\t%%1938\n\tMandatory Label:\t\tS-1-16-8192\n\tCreator Process ID:\t0xcd4\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tSetSPN  -a MSSQLSvc/HACK-ME-PC.offsec.lan offsec\\honey-pot1\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x1d41a5fa", "newProcessId": "0x23c8", "newProcessName": "C:\\Windows\\System32\\setspn.exe", "tokenElevationType": "%%1938", "processId": "0xcd4", "commandLine": "SetSPN  -a MSSQLSvc/HACK-ME-PC.offsec.lan offsec\\honey-pot1", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-8192"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-09T21:29:17.9820284Z", "eventRecordID": "2558212", "processID": "4", "threadID": "4904", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x1D41A5FA\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x1cbc\n\tNew Process Name:\tC:\\Windows\\System32\\setspn.exe\n\tToken Elevation Type:\t%%1938\n\tMandatory Label:\t\tS-1-16-8192\n\tCreator Process ID:\t0xcd4\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tsetspn  -T offsec -Q */*\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x1d41a5fa", "newProcessId": "0x1cbc", "newProcessName": "C:\\Windows\\System32\\setspn.exe", "tokenElevationType": "%%1938", "processId": "0xcd4", "commandLine": "setspn  -T offsec -Q */*", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-8192"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4723_5145_password_reset_with_changentlm_mimikatz(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4723", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8010000000000000", "systemTime": "2021-12-04T22:47:47.8727739Z", "eventRecordID": "233289145", "processID": "596", "threadID": "3492", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_FAILURE", "message": "An attempt was made to change an account's password.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x10E7C4430\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1242\n\tAccount Name:\t\thacker2\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges\t\t-"}, "eventdata": {"targetUserName": "hacker2", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1242", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x10e7c4430"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4724_5145_password_reset_with_setntlm_mimikatz(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T22:09:13.6664275Z", "eventRecordID": "233279979", "processID": "596", "threadID": "4780", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tDelegation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x10E6E8EF8\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{4a99fb41-3d1c-317c-6c30-6c1a1706259b}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t59450\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x10e6e8ef8", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{4a99fb41-3d1c-317c-6c30-6c1a1706259b}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "59450", "impersonationLevel": "%%1840", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T22:09:13.6677039Z", "eventRecordID": "233279982", "processID": "4", "threadID": "2760", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x10E6E8EF8\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t59450\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\IPC$\n\tShare Path:\t\t\n\tRelative Target Name:\tsamr\n\nAccess Request Information:\n\tAccess Mask:\t\t0x12019F\n\tAccesses:\t\tREAD_CONTROL\n\t\t\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tWriteData (or AddFile)\n\t\t\t\tAppendData (or AddSubdirectory or CreatePipeInstance)\n\t\t\t\tReadEA\n\t\t\t\tWriteEA\n\t\t\t\tReadAttributes\n\t\t\t\tWriteAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x10e6e8ef8", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "59450", "shareName": "\\\\*\\IPC$", "relativeTargetName": "samr", "accessMask": "0x12019f", "accessList": "%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4417\n\t\t\t\t%%4418\n\t\t\t\t%%4419\n\t\t\t\t%%4420\n\t\t\t\t%%4423\n\t\t\t\t%%4424"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T22:09:13.6719309Z", "eventRecordID": "233279986", "processID": "596", "threadID": "4780", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tDelegation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x10E6E8F26\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{4a99fb41-3d1c-317c-6c30-6c1a1706259b}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t59451\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x10e6e8f26", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{4a99fb41-3d1c-317c-6c30-6c1a1706259b}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "59451", "impersonationLevel": "%%1840", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T22:09:13.6723569Z", "eventRecordID": "233279990", "processID": "596", "threadID": "3492", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tDelegation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x10E6E8F3E\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{4a99fb41-3d1c-317c-6c30-6c1a1706259b}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t59452\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x10e6e8f3e", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{4a99fb41-3d1c-317c-6c30-6c1a1706259b}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "59452", "impersonationLevel": "%%1840", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T22:09:13.6731831Z", "eventRecordID": "233279994", "processID": "596", "threadID": "4780", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tDelegation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x10E6E8F54\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{4a99fb41-3d1c-317c-6c30-6c1a1706259b}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t59453\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x10e6e8f54", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{4a99fb41-3d1c-317c-6c30-6c1a1706259b}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "59453", "impersonationLevel": "%%1840", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4724", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T22:09:13.6801274Z", "eventRecordID": "233279999", "processID": "596", "threadID": "4780", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to reset an account's password.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x10E6E8EF8\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1242\n\tAccount Name:\t\thacker2\n\tAccount Domain:\t\tOFFSEC"}, "eventdata": {"targetUserName": "hacker2", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1242", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x10e6e8ef8"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T22:09:13.6807937Z", "eventRecordID": "233280000", "processID": "596", "threadID": "4780", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x10E6E8EF8\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1242\n\tAccount Name:\t\thacker2\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t12/4/2021 10:09:13 PM\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hacker2", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1242", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x10e6e8ef8", "passwordLastSet": "12/4/2021 10:09:13 PM"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T22:09:18.6520614Z", "eventRecordID": "233280005", "processID": "596", "threadID": "3076", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x10E6E929B\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{95bd7e3b-1cab-10bc-5696-7f43ce9b8024}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\tfe80::1cae:5aa4:9d8d:106a\n\tSource Port:\t\t51287\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-18", "targetUserName": "ROOTDC1$", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x10e6e929b", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{95bd7e3b-1cab-10bc-5696-7f43ce9b8024}", "keyLength": "0", "processId": "0x0", "ipAddress": "fe80::1cae:5aa4:9d8d:106a", "ipPort": "51287", "impersonationLevel": "%%1833", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4728_4756_member_added_to_sensitive_domain_groups(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T06:01:13.7587346Z", "eventRecordID": "16088263", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x80E25B9\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1159\n\tAccount Name:\t\tCN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-512\n\tGroup Name:\t\tDomain Admins\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1159", "targetUserName": "Domain Admins", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-512", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x80e25b9"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T06:01:13.7655726Z", "eventRecordID": "16088267", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x80E25B9\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1159\n\tAccount Name:\t\tCN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-519\n\tAccount Name:\t\tEnterprise Admins\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1159", "targetUserName": "Enterprise Admins", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-519", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x80e25b9"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T06:01:13.7677497Z", "eventRecordID": "16088270", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x80E25B9\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1159\n\tAccount Name:\t\tCN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-527\n\tAccount Name:\t\tEnterprise Key Admins\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1159", "targetUserName": "Enterprise Key Admins", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-527", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x80e25b9"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T06:01:13.7699394Z", "eventRecordID": "16088274", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x80E25B9\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1159\n\tAccount Name:\t\tCN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-518\n\tAccount Name:\t\tSchema Admins\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1159", "targetUserName": "Schema Admins", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-518", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x80e25b9"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4728_massive_account_group_membership_change(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:19:54.5618177Z", "eventRecordID": "16078256", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8084443\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1150\n\tAccount Name:\t\tCN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1134\n\tGroup Name:\t\tGroup01\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1150", "targetUserName": "Group01", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1134", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8084443"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:19:54.5640484Z", "eventRecordID": "16078259", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8084443\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1150\n\tAccount Name:\t\tCN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1135\n\tGroup Name:\t\tGroup02\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1150", "targetUserName": "Group02", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1135", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8084443"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:19:54.5660037Z", "eventRecordID": "16078262", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8084443\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1150\n\tAccount Name:\t\tCN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1136\n\tGroup Name:\t\tGroup03\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1150", "targetUserName": "Group03", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1136", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8084443"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:19:54.5680960Z", "eventRecordID": "16078265", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8084443\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1150\n\tAccount Name:\t\tCN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1137\n\tGroup Name:\t\tGroup04\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1150", "targetUserName": "Group04", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1137", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8084443"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:19:54.5700560Z", "eventRecordID": "16078268", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8084443\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1150\n\tAccount Name:\t\tCN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1138\n\tGroup Name:\t\tGroup05\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1150", "targetUserName": "Group05", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1138", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8084443"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:19:54.5720244Z", "eventRecordID": "16078271", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8084443\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1150\n\tAccount Name:\t\tCN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1139\n\tGroup Name:\t\tGroup06\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1150", "targetUserName": "Group06", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1139", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8084443"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:19:54.5742505Z", "eventRecordID": "16078274", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8084443\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1150\n\tAccount Name:\t\tCN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1140\n\tGroup Name:\t\tGroup07\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1150", "targetUserName": "Group07", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1140", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8084443"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:19:54.5762398Z", "eventRecordID": "16078277", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8084443\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1150\n\tAccount Name:\t\tCN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1141\n\tGroup Name:\t\tGroup08\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1150", "targetUserName": "Group08", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1141", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8084443"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:19:54.5782585Z", "eventRecordID": "16078280", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8084443\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1150\n\tAccount Name:\t\tCN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1142\n\tGroup Name:\t\tGroup09\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1150", "targetUserName": "Group09", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1142", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8084443"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:19:54.5802297Z", "eventRecordID": "16078283", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8084443\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1150\n\tAccount Name:\t\tCN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1143\n\tGroup Name:\t\tGroup10\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1150", "targetUserName": "Group10", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1143", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8084443"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:19:54.5821911Z", "eventRecordID": "16078286", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8084443\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1150\n\tAccount Name:\t\tCN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1144\n\tGroup Name:\t\tGroup11\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=hack-adm-hack,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1150", "targetUserName": "Group11", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1144", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8084443"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4728_member_adding_to_a_group_by_the_same_account(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4728", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:17:23.1073923Z", "eventRecordID": "16078010", "processID": "528", "threadID": "3156", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled global group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x807AFCB\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tCN=lambda-user,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1135\n\tGroup Name:\t\tGroup02\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=lambda-user,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "targetUserName": "Group02", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1135", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x807afcb"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4732_4733_quick_added_removed_user_from_local_group(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4732", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:12:58.3122807Z", "eventRecordID": "2775256", "processID": "708", "threadID": "8464", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled local group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x58D874\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-1470532092-3758209836-3742276719-1001\n\tAccount Name:\t\t-\n\nGroup:\n\tSecurity ID:\t\tS-1-5-32-545\n\tGroup Name:\t\tUsers\n\tGroup Domain:\t\tBuiltin\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberSid": "S-1-5-21-1470532092-3758209836-3742276719-1001", "targetUserName": "Users", "targetDomainName": "Builtin", "targetSid": "S-1-5-32-545", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x58d874"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4732", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:14:30.9766127Z", "eventRecordID": "2775952", "processID": "708", "threadID": "748", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled local group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x58D874\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-1470532092-3758209836-3742276719-1001\n\tAccount Name:\t\t-\n\nGroup:\n\tSecurity ID:\t\tS-1-5-32-544\n\tGroup Name:\t\tAdministrators\n\tGroup Domain:\t\tBuiltin\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberSid": "S-1-5-21-1470532092-3758209836-3742276719-1001", "targetUserName": "Administrators", "targetDomainName": "Builtin", "targetSid": "S-1-5-32-544", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x58d874"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4732", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:14:44.1253444Z", "eventRecordID": "2775954", "processID": "708", "threadID": "5992", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled local group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x58D874\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-1470532092-3758209836-3742276719-1001\n\tAccount Name:\t\t-\n\nGroup:\n\tSecurity ID:\t\tS-1-5-32-551\n\tGroup Name:\t\tBackup Operators\n\tGroup Domain:\t\tBuiltin\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberSid": "S-1-5-21-1470532092-3758209836-3742276719-1001", "targetUserName": "Backup Operators", "targetDomainName": "Builtin", "targetSid": "S-1-5-32-551", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x58d874"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4733", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:15:26.6793305Z", "eventRecordID": "2775957", "processID": "708", "threadID": "4224", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was removed from a security-enabled local group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x58D874\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-1470532092-3758209836-3742276719-1001\n\tAccount Name:\t\t-\n\nGroup:\n\tSecurity ID:\t\tS-1-5-32-544\n\tGroup Name:\t\tAdministrators\n\tGroup Domain:\t\tBuiltin\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberSid": "S-1-5-21-1470532092-3758209836-3742276719-1001", "targetUserName": "Administrators", "targetDomainName": "Builtin", "targetSid": "S-1-5-32-544", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x58d874"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4733", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:15:32.5841375Z", "eventRecordID": "2775959", "processID": "708", "threadID": "9156", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was removed from a security-enabled local group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x58D874\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-1470532092-3758209836-3742276719-1001\n\tAccount Name:\t\t-\n\nGroup:\n\tSecurity ID:\t\tS-1-5-32-551\n\tGroup Name:\t\tBackup Operators\n\tGroup Domain:\t\tBuiltin\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberSid": "S-1-5-21-1470532092-3758209836-3742276719-1001", "targetUserName": "Backup Operators", "targetDomainName": "Builtin", "targetSid": "S-1-5-32-551", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x58d874"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4732_dnsadmin_new_member_added(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4732", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-05-18T20:51:03.1088179Z", "eventRecordID": "147781717", "processID": "548", "threadID": "3896", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled local group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x903FC37B\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1154\n\tAccount Name:\t\tCN=Test-ADM,CN=Users,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1101\n\tGroup Name:\t\tDnsAdmins\n\tGroup Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=Test-ADM,CN=Users,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1154", "targetUserName": "DnsAdmins", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1101", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x903fc37b"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4732_user_added_to_local_admin_groups(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4732", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:12:58.3122807Z", "eventRecordID": "2775256", "processID": "708", "threadID": "8464", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled local group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x58D874\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-1470532092-3758209836-3742276719-1001\n\tAccount Name:\t\t-\n\nGroup:\n\tSecurity ID:\t\tS-1-5-32-545\n\tGroup Name:\t\tUsers\n\tGroup Domain:\t\tBuiltin\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberSid": "S-1-5-21-1470532092-3758209836-3742276719-1001", "targetUserName": "Users", "targetDomainName": "Builtin", "targetSid": "S-1-5-32-545", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x58d874"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4732", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:14:30.9766127Z", "eventRecordID": "2775952", "processID": "708", "threadID": "748", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled local group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x58D874\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-1470532092-3758209836-3742276719-1001\n\tAccount Name:\t\t-\n\nGroup:\n\tSecurity ID:\t\tS-1-5-32-544\n\tGroup Name:\t\tAdministrators\n\tGroup Domain:\t\tBuiltin\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberSid": "S-1-5-21-1470532092-3758209836-3742276719-1001", "targetUserName": "Administrators", "targetDomainName": "Builtin", "targetSid": "S-1-5-32-544", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x58d874"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4732", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-12T05:14:44.1253444Z", "eventRecordID": "2775954", "processID": "708", "threadID": "5992", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled local group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x58D874\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-1470532092-3758209836-3742276719-1001\n\tAccount Name:\t\t-\n\nGroup:\n\tSecurity ID:\t\tS-1-5-32-551\n\tGroup Name:\t\tBackup Operators\n\tGroup Domain:\t\tBuiltin\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberSid": "S-1-5-21-1470532092-3758209836-3742276719-1001", "targetUserName": "Backup Operators", "targetDomainName": "Builtin", "targetSid": "S-1-5-32-551", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x58d874"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id47385136_spn_set_on_user_account(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-09T21:22:22.8538367Z", "eventRecordID": "15779580", "processID": "528", "threadID": "860", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6529663\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1159\n\tAccount Name:\t\thoney-pot1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "honey-pot1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1159", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6529663"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-09T21:22:31.1630624Z", "eventRecordID": "15779594", "processID": "528", "threadID": "992", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6529663\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tCN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{259162f1-58e4-4ee9-9b9c-2baf2a03d376}\n\tClass:\tuser\n\t\nAttribute:\n\tLDAP Display Name:\tservicePrincipalName\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tHTTP/HACK-ME-PC.offsec.lan\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{52bfbf59-4cf4-4d5e-98d1-09d1ebe12fde}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{52bfbf59-4cf4-4d5e-98d1-09d1ebe12fde}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6529663", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "CN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{259162f1-58e4-4ee9-9b9c-2baf2a03d376}", "objectClass": "user", "attributeLDAPDisplayName": "servicePrincipalName", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "HTTP/HACK-ME-PC.offsec.lan", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-09T21:25:39.2665963Z", "eventRecordID": "15779969", "processID": "528", "threadID": "3836", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6531F37\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1159\n\tAccount Name:\t\thoney-pot1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "honey-pot1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1159", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6531f37"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-09T21:25:41.7739237Z", "eventRecordID": "15779983", "processID": "528", "threadID": "860", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6531F37\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tCN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{259162f1-58e4-4ee9-9b9c-2baf2a03d376}\n\tClass:\tuser\n\t\nAttribute:\n\tLDAP Display Name:\tservicePrincipalName\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tMSSQLSvc/HACK-ME-PC.offsec.lan\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{23e10b6b-4bc4-4cd5-bd5f-9b9ba2ef95a3}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{23e10b6b-4bc4-4cd5-bd5f-9b9ba2ef95a3}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6531f37", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "CN=honey-pot1,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{259162f1-58e4-4ee9-9b9c-2baf2a03d376}", "objectClass": "user", "attributeLDAPDisplayName": "servicePrincipalName", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "MSSQLSvc/HACK-ME-PC.offsec.lan", "operationType": "%%14674"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4738_account_is_sensitive_and_cannot_be_delegated(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:05:31.8646555Z", "eventRecordID": "105297351", "processID": "556", "threadID": "5116", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x210\n\tNew UAC Value:\t\t0x4210\n\tUser Account Control:\t\n\t\t'Not Delegated' - Enabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598", "oldUacValue": "0x210", "newUacValue": "0x4210", "userAccountControl": "%%2094"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:05:35.2007030Z", "eventRecordID": "105297359", "processID": "556", "threadID": "5116", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x4210\n\tNew UAC Value:\t\t0x210\n\tUser Account Control:\t\n\t\t'Not Delegated' - Disabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598", "oldUacValue": "0x4210", "newUacValue": "0x210", "userAccountControl": "%%2062"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4738_account_with_password_not_required(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:09:59.3829806Z", "eventRecordID": "105299141", "processID": "556", "threadID": "5116", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123D4393\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x10\n\tNew UAC Value:\t\t0x14\n\tUser Account Control:\t\n\t\t'Password Not Required' - Enabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123d4393", "oldUacValue": "0x10", "newUacValue": "0x14", "userAccountControl": "%%2082"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:10:03.5238398Z", "eventRecordID": "105299157", "processID": "556", "threadID": "972", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123D4393\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x14\n\tNew UAC Value:\t\t0x10\n\tUser Account Control:\t\n\t\t'Password Not Required' - Disabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123d4393", "oldUacValue": "0x14", "newUacValue": "0x10", "userAccountControl": "%%2050"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4738_do_not_require_kerberos_preauthentication(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:06:53.4071042Z", "eventRecordID": "105298661", "processID": "556", "threadID": "972", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x210\n\tNew UAC Value:\t\t0x10210\n\tUser Account Control:\t\n\t\t'Don't Require Preauth' - Enabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598", "oldUacValue": "0x210", "newUacValue": "0x10210", "userAccountControl": "%%2096"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:06:55.0150284Z", "eventRecordID": "105298669", "processID": "556", "threadID": "972", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x10210\n\tNew UAC Value:\t\t0x210\n\tUser Account Control:\t\n\t\t'Don't Require Preauth' - Disabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598", "oldUacValue": "0x10210", "newUacValue": "0x210", "userAccountControl": "%%2064"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4738_password_cannot_be_changed(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:08:12.1162669Z", "eventRecordID": "105298891", "processID": "556", "threadID": "2768", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:08:13.8780322Z", "eventRecordID": "105298903", "processID": "556", "threadID": "5116", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4738_password_never_expires(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:08:43.1608866Z", "eventRecordID": "105298983", "processID": "556", "threadID": "972", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x10\n\tNew UAC Value:\t\t0x210\n\tUser Account Control:\t\n\t\t'Don't Expire Password' - Enabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598", "oldUacValue": "0x10", "newUacValue": "0x210", "userAccountControl": "%%2089"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:08:45.2487181Z", "eventRecordID": "105298988", "processID": "556", "threadID": "972", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x210\n\tNew UAC Value:\t\t0x10\n\tUser Account Control:\t\n\t\t'Don't Expire Password' - Disabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598", "oldUacValue": "0x210", "newUacValue": "0x10", "userAccountControl": "%%2057"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4738_use_only_kerberos_des_encryption_types(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:06:15.6086242Z", "eventRecordID": "105297489", "processID": "556", "threadID": "2768", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x210\n\tNew UAC Value:\t\t0x8210\n\tUser Account Control:\t\n\t\t'Use DES Key Only' - Enabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598", "oldUacValue": "0x210", "newUacValue": "0x8210", "userAccountControl": "%%2095"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:06:19.1527271Z", "eventRecordID": "105297500", "processID": "556", "threadID": "972", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x8210\n\tNew UAC Value:\t\t0x210\n\tUser Account Control:\t\n\t\t'Use DES Key Only' - Disabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598", "oldUacValue": "0x8210", "newUacValue": "0x210", "userAccountControl": "%%2063"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4738_user_set_with_reversible_psw_encryption(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:03:02.7760072Z", "eventRecordID": "105296866", "processID": "556", "threadID": "972", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x210\n\tNew UAC Value:\t\t0xA10\n\tUser Account Control:\t\n\t\t'Encrypted Text Password Allowed' - Enabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598", "oldUacValue": "0x210", "newUacValue": "0xa10", "userAccountControl": "%%2091"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-08T12:03:06.6563522Z", "eventRecordID": "105296876", "processID": "556", "threadID": "2768", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x123BE598\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0xA10\n\tNew UAC Value:\t\t0x210\n\tUser Account Control:\t\n\t\t'Encrypted Text Password Allowed' - Disabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "hack1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x123be598", "oldUacValue": "0xa10", "newUacValue": "0x210", "userAccountControl": "%%2059"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id47425136_enable_trust_this_computer_for_delegation_to_any_service_kerberos_only(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4742", "version": "0", "level": "0", "task": "13825", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:02:53.1494987Z", "eventRecordID": "138041035", "processID": "548", "threadID": "3896", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A computer account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nComputer Account That Was Changed:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1240\n\tAccount Name:\t\tMYTARGET-PC$\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t0x84\n\tNew UAC Value:\t\t0x2084\n\tUser Account Control:\t\n\t\t'Trusted For Delegation' - Enabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\tDNS Host Name:\t\t-\n\tService Principal Names:\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "MYTARGET-PC$", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1240", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "oldUacValue": "0x84", "newUacValue": "0x2084", "userAccountControl": "%%2093"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:02:59.7496952Z", "eventRecordID": "138041056", "processID": "548", "threadID": "3984", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tuserAccountControl\n\tSyntax (OID):\t2.5.5.9\n\tValue:\t4128\n\t\nOperation:\n\tType:\tValue Deleted\n\tCorrelation ID:\t{b7e7f54a-5352-4bfb-b051-865342dc220e}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{b7e7f54a-5352-4bfb-b051-865342dc220e}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "userAccountControl", "attributeSyntaxOID": "2.5.5.9", "attributeValue": "4128", "operationType": "%%14675"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:02:59.7499366Z", "eventRecordID": "138041057", "processID": "548", "threadID": "4624", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tuserAccountControl\n\tSyntax (OID):\t2.5.5.9\n\tValue:\t528416\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{b7e7f54a-5352-4bfb-b051-865342dc220e}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{b7e7f54a-5352-4bfb-b051-865342dc220e}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "userAccountControl", "attributeSyntaxOID": "2.5.5.9", "attributeValue": "528416", "operationType": "%%14674"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id47425136_enable_trust_this_computer_for_delegation_to_specified_service_any_protocol(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4742", "version": "0", "level": "0", "task": "13825", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:07:56.2919036Z", "eventRecordID": "138042977", "processID": "548", "threadID": "32", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A computer account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nComputer Account That Was Changed:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1240\n\tAccount Name:\t\tMYTARGET-PC$\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t\n\t\tbrowser/ATANIDS01\n\t\tbrowser/atanids01.offsec.lan\n\t\tcifs/ATANIDS01\n\t\tcifs/atanids01.offsec.lan\n\t\tcisvc/ATANIDS01\n\t\tcisvc/atanids01.offsec.lan\n\tOld UAC Value:\t\t0x84\n\tNew UAC Value:\t\t0x40084\n\tUser Account Control:\t\n\t\t'Trusted To Authenticate For Delegation' - Enabled\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\tDNS Host Name:\t\t-\n\tService Principal Names:\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "MYTARGET-PC$", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1240", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "allowedToDelegateTo": "browser/ATANIDS01\n\t\tbrowser/atanids01.offsec.lan\n\t\tcifs/ATANIDS01\n\t\tcifs/atanids01.offsec.lan\n\t\tcisvc/ATANIDS01\n\t\tcisvc/atanids01.offsec.lan", "oldUacValue": "0x84", "newUacValue": "0x40084", "userAccountControl": "%%2098"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:08:00.3823868Z", "eventRecordID": "138042990", "processID": "548", "threadID": "3984", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tuserAccountControl\n\tSyntax (OID):\t2.5.5.9\n\tValue:\t4128\n\t\nOperation:\n\tType:\tValue Deleted\n\tCorrelation ID:\t{8e7732ce-04b5-4359-9bdc-0337e83419b4}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8e7732ce-04b5-4359-9bdc-0337e83419b4}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "userAccountControl", "attributeSyntaxOID": "2.5.5.9", "attributeValue": "4128", "operationType": "%%14675"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:08:00.3826320Z", "eventRecordID": "138042991", "processID": "548", "threadID": "3984", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tuserAccountControl\n\tSyntax (OID):\t2.5.5.9\n\tValue:\t16781344\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8e7732ce-04b5-4359-9bdc-0337e83419b4}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8e7732ce-04b5-4359-9bdc-0337e83419b4}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "userAccountControl", "attributeSyntaxOID": "2.5.5.9", "attributeValue": "16781344", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:08:00.3828906Z", "eventRecordID": "138042992", "processID": "548", "threadID": "3984", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tbrowser/ATANIDS01\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8e7732ce-04b5-4359-9bdc-0337e83419b4}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8e7732ce-04b5-4359-9bdc-0337e83419b4}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "browser/ATANIDS01", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:08:00.3831539Z", "eventRecordID": "138042993", "processID": "548", "threadID": "3984", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tbrowser/atanids01.offsec.lan\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8e7732ce-04b5-4359-9bdc-0337e83419b4}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8e7732ce-04b5-4359-9bdc-0337e83419b4}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "browser/atanids01.offsec.lan", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:08:00.3834060Z", "eventRecordID": "138042994", "processID": "548", "threadID": "4624", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tcifs/ATANIDS01\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8e7732ce-04b5-4359-9bdc-0337e83419b4}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8e7732ce-04b5-4359-9bdc-0337e83419b4}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "cifs/ATANIDS01", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:08:00.3836404Z", "eventRecordID": "138042995", "processID": "548", "threadID": "4624", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tcifs/atanids01.offsec.lan\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8e7732ce-04b5-4359-9bdc-0337e83419b4}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8e7732ce-04b5-4359-9bdc-0337e83419b4}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "cifs/atanids01.offsec.lan", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:08:00.3838818Z", "eventRecordID": "138042996", "processID": "548", "threadID": "3984", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tcisvc/ATANIDS01\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8e7732ce-04b5-4359-9bdc-0337e83419b4}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8e7732ce-04b5-4359-9bdc-0337e83419b4}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "cisvc/ATANIDS01", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:08:00.3841339Z", "eventRecordID": "138042997", "processID": "548", "threadID": "4624", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tcisvc/atanids01.offsec.lan\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8e7732ce-04b5-4359-9bdc-0337e83419b4}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8e7732ce-04b5-4359-9bdc-0337e83419b4}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "cisvc/atanids01.offsec.lan", "operationType": "%%14674"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id47425136_enable_trust_this_computer_for_delegation_to_specified_service_kerberos_only(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4742", "version": "0", "level": "0", "task": "13825", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:06:55.3992204Z", "eventRecordID": "138042668", "processID": "548", "threadID": "3896", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A computer account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nComputer Account That Was Changed:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1240\n\tAccount Name:\t\tMYTARGET-PC$\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t\n\t\tcifs/ATACORE01\n\t\tcifs/atacore01.offsec.lan\n\t\tcisvc/ATACORE01\n\t\tcisvc/atacore01.offsec.lan\n\t\tclipsrv/ATACORE01\n\t\tclipsrv/atacore01.offsec.lan\n\t\tdcom/ATACORE01\n\t\tdcom/atacore01.offsec.lan\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\tDNS Host Name:\t\t-\n\tService Principal Names:\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "MYTARGET-PC$", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1240", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "allowedToDelegateTo": "cifs/ATACORE01\n\t\tcifs/atacore01.offsec.lan\n\t\tcisvc/ATACORE01\n\t\tcisvc/atacore01.offsec.lan\n\t\tclipsrv/ATACORE01\n\t\tclipsrv/atacore01.offsec.lan\n\t\tdcom/ATACORE01\n\t\tdcom/atacore01.offsec.lan"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:07:00.3306980Z", "eventRecordID": "138042681", "processID": "548", "threadID": "3848", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tcifs/ATACORE01\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "cifs/ATACORE01", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:07:00.3309324Z", "eventRecordID": "138042682", "processID": "548", "threadID": "3848", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tcifs/atacore01.offsec.lan\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "cifs/atacore01.offsec.lan", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:07:00.3311672Z", "eventRecordID": "138042683", "processID": "548", "threadID": "3848", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tcisvc/ATACORE01\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "cisvc/ATACORE01", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:07:00.3314226Z", "eventRecordID": "138042684", "processID": "548", "threadID": "3848", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tcisvc/atacore01.offsec.lan\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "cisvc/atacore01.offsec.lan", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:07:00.3316481Z", "eventRecordID": "138042685", "processID": "548", "threadID": "3848", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tclipsrv/ATACORE01\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "clipsrv/ATACORE01", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:07:00.3319003Z", "eventRecordID": "138042686", "processID": "548", "threadID": "3848", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tclipsrv/atacore01.offsec.lan\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "clipsrv/atacore01.offsec.lan", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:07:00.3321267Z", "eventRecordID": "138042687", "processID": "548", "threadID": "3848", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tdcom/ATACORE01\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "dcom/ATACORE01", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T09:07:00.3323700Z", "eventRecordID": "138042688", "processID": "548", "threadID": "3984", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tcn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{7ef1a358-e3d8-4d68-906d-4c9389cad31a}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToDelegateTo\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tdcom/atacore01.offsec.lan\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{8d4e40fe-2e0e-4553-93ab-1c20097bc93c}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "cn=MYTARGET-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{7ef1a358-e3d8-4d68-906d-4c9389cad31a}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToDelegateTo", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "dcom/atacore01.offsec.lan", "operationType": "%%14674"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id47425136_spn_set_on_computer_account(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4742", "version": "0", "level": "0", "task": "13825", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-09T21:40:54.2511412Z", "eventRecordID": "15781772", "processID": "528", "threadID": "992", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A computer account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6552CBB\n\nComputer Account That Was Changed:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1160\n\tAccount Name:\t\tHACK-ME-PC$\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\tDNS Host Name:\t\t-\n\tService Principal Names:\t\n\t\tHOST/HACK-ME-PC.offsec.lan\n\t\tHOST/HACK-ME-PC\n\t\tHTTP/HACK-ME-PC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "HACK-ME-PC$", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1160", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6552cbb", "servicePrincipalNames": "HOST/HACK-ME-PC.offsec.lan\n\t\tHOST/HACK-ME-PC\n\t\tHTTP/HACK-ME-PC"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-09T21:41:03.6526292Z", "eventRecordID": "15781791", "processID": "528", "threadID": "3836", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1158\n\tAccount Name:\t\tlambda-user\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6552CBB\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tCN=HACK-ME-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{e360f654-725e-48bd-8169-10b17fbdd4d5}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tservicePrincipalName\n\tSyntax (OID):\t2.5.5.12\n\tValue:\tHTTP/HACK-ME-PC\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{c3d91180-4e10-4ccd-86e7-91145c96553f}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{c3d91180-4e10-4ccd-86e7-91145c96553f}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1158", "subjectUserName": "lambda-user", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6552cbb", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "CN=HACK-ME-PC,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{e360f654-725e-48bd-8169-10b17fbdd4d5}", "objectClass": "computer", "attributeLDAPDisplayName": "servicePrincipalName", "attributeSyntaxOID": "2.5.5.12", "attributeValue": "HTTP/HACK-ME-PC", "operationType": "%%14674"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4742_spn_set_on_computer_account_dcshadow(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4742", "version": "0", "level": "0", "task": "13825", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:41:38.9661649Z", "eventRecordID": "125592802", "processID": "560", "threadID": "2872", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A computer account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x882D87\n\nComputer Account That Was Changed:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1106\n\tAccount Name:\t\tJUMP01$\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\tDNS Host Name:\t\t-\n\tService Principal Names:\t\n\t\tHOST/jump01.offsec.lan\n\t\tRestrictedKrbHost/jump01.offsec.lan\n\t\tHOST/JUMP01\n\t\tRestrictedKrbHost/JUMP01\n\t\tWSMAN/jump01.offsec.lan\n\t\tWSMAN/jump01\n\t\tTERMSRV/jump01.offsec.lan\n\t\tTERMSRV/JUMP01\n\t\tGC/jump01.offsec.lan/offsec.lan\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "JUMP01$", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1106", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x882d87", "servicePrincipalNames": "HOST/jump01.offsec.lan\n\t\tRestrictedKrbHost/jump01.offsec.lan\n\t\tHOST/JUMP01\n\t\tRestrictedKrbHost/JUMP01\n\t\tWSMAN/jump01.offsec.lan\n\t\tWSMAN/jump01\n\t\tTERMSRV/jump01.offsec.lan\n\t\tTERMSRV/JUMP01\n\t\tGC/jump01.offsec.lan/offsec.lan"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4742", "version": "0", "level": "0", "task": "13825", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:41:39.0097192Z", "eventRecordID": "125592808", "processID": "560", "threadID": "652", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A computer account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x882E4A\n\nComputer Account That Was Changed:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1106\n\tAccount Name:\t\tJUMP01$\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\tDNS Host Name:\t\t-\n\tService Principal Names:\t\n\t\tHOST/jump01.offsec.lan\n\t\tRestrictedKrbHost/jump01.offsec.lan\n\t\tHOST/JUMP01\n\t\tRestrictedKrbHost/JUMP01\n\t\tWSMAN/jump01.offsec.lan\n\t\tWSMAN/jump01\n\t\tTERMSRV/jump01.offsec.lan\n\t\tTERMSRV/JUMP01\n\t\tGC/jump01.offsec.lan/offsec.lan\n\t\tE3514235-4B06-11D1-AB04-00C04FC2DCD2/097b2e16-f2c3-44ef-b300-ec7e11e2a9f2/offsec.lan\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "JUMP01$", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1106", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x882e4a", "servicePrincipalNames": "HOST/jump01.offsec.lan\n\t\tRestrictedKrbHost/jump01.offsec.lan\n\t\tHOST/JUMP01\n\t\tRestrictedKrbHost/JUMP01\n\t\tWSMAN/jump01.offsec.lan\n\t\tWSMAN/jump01\n\t\tTERMSRV/jump01.offsec.lan\n\t\tTERMSRV/JUMP01\n\t\tGC/jump01.offsec.lan/offsec.lan\n\t\tE3514235-4B06-11D1-AB04-00C04FC2DCD2/097b2e16-f2c3-44ef-b300-ec7e11e2a9f2/offsec.lan"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4742", "version": "0", "level": "0", "task": "13825", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:42:21.1337829Z", "eventRecordID": "125592911", "processID": "560", "threadID": "2872", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A computer account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x882D87\n\nComputer Account That Was Changed:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1106\n\tAccount Name:\t\tJUMP01$\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\tDNS Host Name:\t\t-\n\tService Principal Names:\t\n\t\tHOST/jump01.offsec.lan\n\t\tRestrictedKrbHost/jump01.offsec.lan\n\t\tHOST/JUMP01\n\t\tRestrictedKrbHost/JUMP01\n\t\tWSMAN/jump01.offsec.lan\n\t\tWSMAN/jump01\n\t\tTERMSRV/jump01.offsec.lan\n\t\tTERMSRV/JUMP01\n\t\tE3514235-4B06-11D1-AB04-00C04FC2DCD2/097b2e16-f2c3-44ef-b300-ec7e11e2a9f2/offsec.lan\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "JUMP01$", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1106", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x882d87", "servicePrincipalNames": "HOST/jump01.offsec.lan\n\t\tRestrictedKrbHost/jump01.offsec.lan\n\t\tHOST/JUMP01\n\t\tRestrictedKrbHost/JUMP01\n\t\tWSMAN/jump01.offsec.lan\n\t\tWSMAN/jump01\n\t\tTERMSRV/jump01.offsec.lan\n\t\tTERMSRV/JUMP01\n\t\tE3514235-4B06-11D1-AB04-00C04FC2DCD2/097b2e16-f2c3-44ef-b300-ec7e11e2a9f2/offsec.lan"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4756_exchange_admin_group_change(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.5740495Z", "eventRecordID": "102653291", "processID": "556", "threadID": "2088", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1201\n\tAccount Name:\t\tCompliance Management\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Compliance Management", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1201", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.5767183Z", "eventRecordID": "102653294", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1199\n\tAccount Name:\t\tDelegated Setup\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Delegated Setup", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1199", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6013523Z", "eventRecordID": "102653302", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1208\n\tAccount Name:\t\tExchangeLegacyInterop\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "ExchangeLegacyInterop", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1208", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6035401Z", "eventRecordID": "102653305", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1195\n\tAccount Name:\t\tHelp Desk\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Help Desk", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1195", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6085570Z", "eventRecordID": "102653308", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1200\n\tAccount Name:\t\tHygiene Management\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Hygiene Management", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1200", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6107547Z", "eventRecordID": "102653311", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1206\n\tAccount Name:\t\tManaged Availability Servers\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Managed Availability Servers", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1206", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6129812Z", "eventRecordID": "102653314", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1190\n\tAccount Name:\t\tOrganization Management\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Organization Management", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1190", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6152311Z", "eventRecordID": "102653317", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1193\n\tAccount Name:\t\tPublic Folder Management\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Public Folder Management", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1193", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6176967Z", "eventRecordID": "102653320", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1191\n\tAccount Name:\t\tRecipient Management\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Recipient Management", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1191", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6199992Z", "eventRecordID": "102653323", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1196\n\tAccount Name:\t\tRecords Management\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Records Management", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1196", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6223548Z", "eventRecordID": "102653326", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1203\n\tAccount Name:\t\tSecurity Administrator\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Security Administrator", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1203", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6274034Z", "eventRecordID": "102653329", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1202\n\tAccount Name:\t\tSecurity Reader\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Security Reader", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1202", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6295959Z", "eventRecordID": "102653332", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1198\n\tAccount Name:\t\tServer Management\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Server Management", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1198", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6317600Z", "eventRecordID": "102653335", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1194\n\tAccount Name:\t\tUM Management\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "UM Management", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1194", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T16:20:48.6339013Z", "eventRecordID": "102653338", "processID": "556", "threadID": "5100", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC3B3537\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1192\n\tAccount Name:\t\tView-Only Organization Management\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "View-Only Organization Management", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1192", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc3b3537"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4781_4738_user_renamed_to_admin_or_likely(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T08:46:53.0268057Z", "eventRecordID": "138036030", "processID": "548", "threadID": "32", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1239\n\tAccount Name:\t\tadminupn42\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\tadminupn42\n\tDisplay Name:\t\tadmin-first-displayname\n\tUser Principal Name:\tadminupn42@offsec.lan\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "adminupn42", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1239", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1", "samAccountName": "adminupn42", "displayName": "admin-first-displayname", "userPrincipalName": "adminupn42@offsec.lan"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4781", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-26T08:46:53.0268337Z", "eventRecordID": "138036031", "processID": "548", "threadID": "32", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The name of an account was changed:\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x2E15BBA1\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1239\n\tAccount Domain:\t\tOFFSEC\n\tOld Account Name:\thacker42\n\tNew Account Name:\tadminupn42\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"oldTargetUserName": "hacker42", "newTargetUserName": "adminupn42", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1239", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x2e15bba1"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4781_computer_account_renamed_without_a_trailing__cve_2021_42278(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4781", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-14T14:42:48.9083771Z", "eventRecordID": "237294532", "processID": "596", "threadID": "2784", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The name of an account was changed:\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x308FABB0C\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1296\n\tAccount Domain:\t\tOFFSEC\n\tOld Account Name:\tcompnay-88$\n\tNew Account Name:\trootdc1\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"oldTargetUserName": "compnay-88$", "newTargetUserName": "rootdc1", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1296", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserName": "hack1", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x308fabb0c"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4781", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-14T14:42:49.2350147Z", "eventRecordID": "237294536", "processID": "596", "threadID": "1120", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The name of an account was changed:\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tAccount Name:\t\thack1\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x308FABB0C\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1296\n\tAccount Domain:\t\tOFFSEC\n\tOld Account Name:\trootdc1\n\tNew Account Name:\tcompnay-88$\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"oldTargetUserName": "rootdc1", "newTargetUserName": "compnay-88$", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1296", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1234", "subjectUserName": "hack1", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x308fabb0c"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id5136_4662_ad_object_owner_changed(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-22T22:35:11.9938268Z", "eventRecordID": "111655522", "processID": "556", "threadID": "15032", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x24D7D370\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{bf967aba-0de6-11d0-a285-00aa003049e2}\n\tObject Name:\t\t%{0948c16d-536f-4a78-b0a3-879febb036ea}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tControl Access\n\t\t\t\t\n\tAccess Mask:\t\t0x100\n\tProperties:\t\tControl Access\n\t\t{91e647de-d96f-4b70-9557-d63ff4f3ccd8}\n\t\t\t{6617e4ac-a2f1-43ab-b60c-11fbd1facf05}\n\t\t\t{b3f93023-9239-4f7c-b99c-6745d87adbc2}\n\t\t\t{b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7}\n\t\t\t{b7ff5a38-0818-42b0-8110-d3d154c97f24}\n\t\t{771727b1-31b8-4cdf-ae62-4fe39fadf89e}\n\t\t\t{612cb747-c0e8-4f92-9221-fdd5f15b550d}\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x24d7d370", "objectServer": "DS", "objectType": "%{bf967aba-0de6-11d0-a285-00aa003049e2}", "objectName": "%{0948c16d-536f-4a78-b0a3-879febb036ea}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%7688", "accessMask": "0x100", "properties": "%%7688\n\t\t{91e647de-d96f-4b70-9557-d63ff4f3ccd8}\n\t\t\t{6617e4ac-a2f1-43ab-b60c-11fbd1facf05}\n\t\t\t{b3f93023-9239-4f7c-b99c-6745d87adbc2}\n\t\t\t{b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7}\n\t\t\t{b7ff5a38-0818-42b0-8110-d3d154c97f24}\n\t\t{771727b1-31b8-4cdf-ae62-4fe39fadf89e}\n\t\t\t{612cb747-c0e8-4f92-9221-fdd5f15b550d}\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-22T22:35:20.7866273Z", "eventRecordID": "111655541", "processID": "556", "threadID": "15032", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x24DDD890\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{bf967aba-0de6-11d0-a285-00aa003049e2}\n\tObject Name:\t\t%{237e2948-81ed-41be-b979-27f0f95b4302}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tWRITE_OWNER\n\t\t\t\t\n\tAccess Mask:\t\t0x80000\n\tProperties:\t\tWRITE_OWNER\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x24ddd890", "objectServer": "DS", "objectType": "%{bf967aba-0de6-11d0-a285-00aa003049e2}", "objectName": "%{237e2948-81ed-41be-b979-27f0f95b4302}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%1540", "accessMask": "0x80000", "properties": "%%1540\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4738", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-22T22:35:20.7876674Z", "eventRecordID": "111655542", "processID": "556", "threadID": "11192", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A user account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x24DDD890\n\nTarget Account:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1232\n\tAccount Name:\t\ttest56\n\tAccount Domain:\t\tOFFSEC\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "test56", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1232", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x24ddd890"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-22T22:35:21.2523756Z", "eventRecordID": "111655575", "processID": "556", "threadID": "12772", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x24DDD890\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tCN=test56,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{237e2948-81ed-41be-b979-27f0f95b4302}\n\tClass:\tuser\n\t\nAttribute:\n\tLDAP Display Name:\tnTSecurityDescriptor\n\tSyntax (OID):\t2.5.5.15\n\tValue:\tO:S-1-5-21-4230534742-2542757381-3142984815-1170G:DAD:AI(OD;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;WD)(OD;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;RP;4c164200-20c0-11d0-a768-00aa006e0529;;RS)(OA;;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;;RS)(OA;;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;;RS)(OA;;RP;037088f8-0ae1-11d2-b422-00a0c968f939;;RS)(OA;;RPWP;bf967a7f-0de6-11d0-a285-00aa003049e2;;CA)(OA;;RP;46a9b11d-60ae-405a-b7e8-ff8a58d456d2;;S-1-5-32-560)(OA;;RPWP;6db69a1c-9422-11d1-aebd-0000f80367c1;;S-1-5-32-561)(OA;;RPWP;5805bc62-bdc9-4428-a5e2-856a0f4c185e;;S-1-5-32-561)(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;WD)(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;CR;ab721a54-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;CR;ab721a56-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;;AU)(OA;;RP;e48d0154-bcf8-11d1-8702-00c04fb96050;;AU)(OA;;RP;77b5b886-944a-11d1-aebd-0000f80367c1;;AU)(OA;;RP;e45795b3-9455-11d1-aebd-0000f80367c1;;AU)(OA;;RPWP;77b5b886-944a-11d1-aebd-0000f80367c1;;PS)(OA;;RPWP;e45795b2-9455-11d1-aebd-0000f80367c1;;PS)(OA;;RPWP;e45795b3-9455-11d1-aebd-0000f80367c1;;PS)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;DA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;AO)(A;;RC;;;AU)(A;;LCRPLORC;;;PS)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(OA;CIID;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1233)(OA;CIID;RPWP;bf967a0a-0de6-11d0-a285-00aa003049e2;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1233)(OA;CIID;CCDC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIID;CCDC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1605)(OD;CIID;WP;f3a64788-5306-11d1-a9c5-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIIOID;RP;4c164200-20c0-11d0-a768-00aa006e0529;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;4c164200-20c0-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;037088f8-0ae1-11d2-b422-00a0c968f939;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;037088f8-0ae1-11d2-b422-00a0c968f939;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-4230534742-2542757381-3142984815-1199)(OA;CIID;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-4230534742-2542757381-3142984815-526)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-4230534742-2542757381-3142984815-527)(OA;CIIOID;DT;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;DT;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SDWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;SDWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIOID;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CIID;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CIID;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIID;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;CIID;LCRPLORC;;;S-1-5-21-4230534742-2542757381-3142984815-1190)(A;CIID;LCRPLORC;;;S-1-5-21-4230534742-2542757381-3142984815-1205)(A;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-4230534742-2542757381-3142984815-519)(A;CIID;LC;;;RU)(A;CIID;CCLCSWRPWPLOCRSDRCWDWO;;;BA)S:AI(AU;CIIDSA;WPWDWO;;;WD)(AU;CIIDSA;CRWD;;;WD)\n\t\nOperation:\n\tType:\tValue Deleted\n\tCorrelation ID:\t{ff60a8e5-d3b1-480d-a55c-f8d3db68277a}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{ff60a8e5-d3b1-480d-a55c-f8d3db68277a}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x24ddd890", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "CN=test56,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{237e2948-81ed-41be-b979-27f0f95b4302}", "objectClass": "user", "attributeLDAPDisplayName": "nTSecurityDescriptor", "attributeSyntaxOID": "2.5.5.15", "attributeValue": "O:S-1-5-21-4230534742-2542757381-3142984815-1170G:DAD:AI(OD;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;WD)(OD;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;RP;4c164200-20c0-11d0-a768-00aa006e0529;;RS)(OA;;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;;RS)(OA;;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;;RS)(OA;;RP;037088f8-0ae1-11d2-b422-00a0c968f939;;RS)(OA;;RPWP;bf967a7f-0de6-11d0-a285-00aa003049e2;;CA)(OA;;RP;46a9b11d-60ae-405a-b7e8-ff8a58d456d2;;S-1-5-32-560)(OA;;RPWP;6db69a1c-9422-11d1-aebd-0000f80367c1;;S-1-5-32-561)(OA;;RPWP;5805bc62-bdc9-4428-a5e2-856a0f4c185e;;S-1-5-32-561)(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;WD)(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;CR;ab721a54-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;CR;ab721a56-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;;AU)(OA;;RP;e48d0154-bcf8-11d1-8702-00c04fb96050;;AU)(OA;;RP;77b5b886-944a-11d1-aebd-0000f80367c1;;AU)(OA;;RP;e45795b3-9455-11d1-aebd-0000f80367c1;;AU)(OA;;RPWP;77b5b886-944a-11d1-aebd-0000f80367c1;;PS)(OA;;RPWP;e45795b2-9455-11d1-aebd-0000f80367c1;;PS)(OA;;RPWP;e45795b3-9455-11d1-aebd-0000f80367c1;;PS)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;DA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;AO)(A;;RC;;;AU)(A;;LCRPLORC;;;PS)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(OA;CIID;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1233)(OA;CIID;RPWP;bf967a0a-0de6-11d0-a285-00aa003049e2;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1233)(OA;CIID;CCDC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIID;CCDC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1605)(OD;CIID;WP;f3a64788-5306-11d1-a9c5-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIIOID;RP;4c164200-20c0-11d0-a768-00aa006e0529;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;4c164200-20c0-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;037088f8-0ae1-11d2-b422-00a0c968f939;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;037088f8-0ae1-11d2-b422-00a0c968f939;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-4230534742-2542757381-3142984815-1199)(OA;CIID;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-4230534742-2542757381-3142984815-526)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-4230534742-2542757381-3142984815-527)(OA;CIIOID;DT;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;DT;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SDWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;SDWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIOID;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CIID;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CIID;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIID;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;CIID;LCRPLORC;;;S-1-5-21-4230534742-2542757381-3142984815-1190)(A;CIID;LCRPLORC;;;S-1-5-21-4230534742-2542757381-3142984815-1205)(A;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-4230534742-2542757381-3142984815-519)(A;CIID;LC;;;RU)(A;CIID;CCLCSWRPWPLOCRSDRCWDWO;;;BA)S:AI(AU;CIIDSA;WPWDWO;;;WD)(AU;CIIDSA;CRWD;;;WD)", "operationType": "%%14675"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-22T22:35:21.2530881Z", "eventRecordID": "111655576", "processID": "556", "threadID": "4060", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x24DDD890\n\nDirectory Service:\n\tName:\toffsec.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tCN=test56,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\tGUID:\t{237e2948-81ed-41be-b979-27f0f95b4302}\n\tClass:\tuser\n\t\nAttribute:\n\tLDAP Display Name:\tnTSecurityDescriptor\n\tSyntax (OID):\t2.5.5.15\n\tValue:\tO:S-1-5-21-4230534742-2542757381-3142984815-1234G:DAD:AI(OD;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;WD)(OD;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;RP;4c164200-20c0-11d0-a768-00aa006e0529;;RS)(OA;;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;;RS)(OA;;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;;RS)(OA;;RP;037088f8-0ae1-11d2-b422-00a0c968f939;;RS)(OA;;RPWP;bf967a7f-0de6-11d0-a285-00aa003049e2;;CA)(OA;;RP;46a9b11d-60ae-405a-b7e8-ff8a58d456d2;;S-1-5-32-560)(OA;;RPWP;6db69a1c-9422-11d1-aebd-0000f80367c1;;S-1-5-32-561)(OA;;RPWP;5805bc62-bdc9-4428-a5e2-856a0f4c185e;;S-1-5-32-561)(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;WD)(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;CR;ab721a54-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;CR;ab721a56-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;;AU)(OA;;RP;e48d0154-bcf8-11d1-8702-00c04fb96050;;AU)(OA;;RP;77b5b886-944a-11d1-aebd-0000f80367c1;;AU)(OA;;RP;e45795b3-9455-11d1-aebd-0000f80367c1;;AU)(OA;;RPWP;77b5b886-944a-11d1-aebd-0000f80367c1;;PS)(OA;;RPWP;e45795b2-9455-11d1-aebd-0000f80367c1;;PS)(OA;;RPWP;e45795b3-9455-11d1-aebd-0000f80367c1;;PS)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;DA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;AO)(A;;RC;;;AU)(A;;LCRPLORC;;;PS)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(OA;CIID;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1233)(OA;CIID;RPWP;bf967a0a-0de6-11d0-a285-00aa003049e2;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1233)(OA;CIID;CCDC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIID;CCDC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1605)(OD;CIID;WP;f3a64788-5306-11d1-a9c5-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIIOID;RP;4c164200-20c0-11d0-a768-00aa006e0529;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;4c164200-20c0-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;037088f8-0ae1-11d2-b422-00a0c968f939;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;037088f8-0ae1-11d2-b422-00a0c968f939;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-4230534742-2542757381-3142984815-1199)(OA;CIID;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-4230534742-2542757381-3142984815-526)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-4230534742-2542757381-3142984815-527)(OA;CIIOID;DT;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;DT;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SDWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;SDWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIOID;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CIID;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CIID;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIID;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;CIID;LCRPLORC;;;S-1-5-21-4230534742-2542757381-3142984815-1190)(A;CIID;LCRPLORC;;;S-1-5-21-4230534742-2542757381-3142984815-1205)(A;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-4230534742-2542757381-3142984815-519)(A;CIID;LC;;;RU)(A;CIID;CCLCSWRPWPLOCRSDRCWDWO;;;BA)S:AI(AU;CIIDSA;WPWDWO;;;WD)(AU;CIIDSA;CRWD;;;WD)\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{ff60a8e5-d3b1-480d-a55c-f8d3db68277a}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{ff60a8e5-d3b1-480d-a55c-f8d3db68277a}", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x24ddd890", "dSName": "offsec.lan", "dSType": "%%14676", "objectDN": "CN=test56,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "objectGUID": "{237e2948-81ed-41be-b979-27f0f95b4302}", "objectClass": "user", "attributeLDAPDisplayName": "nTSecurityDescriptor", "attributeSyntaxOID": "2.5.5.15", "attributeValue": "O:S-1-5-21-4230534742-2542757381-3142984815-1234G:DAD:AI(OD;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;WD)(OD;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;RP;4c164200-20c0-11d0-a768-00aa006e0529;;RS)(OA;;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;;RS)(OA;;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;;RS)(OA;;RP;037088f8-0ae1-11d2-b422-00a0c968f939;;RS)(OA;;RPWP;bf967a7f-0de6-11d0-a285-00aa003049e2;;CA)(OA;;RP;46a9b11d-60ae-405a-b7e8-ff8a58d456d2;;S-1-5-32-560)(OA;;RPWP;6db69a1c-9422-11d1-aebd-0000f80367c1;;S-1-5-32-561)(OA;;RPWP;5805bc62-bdc9-4428-a5e2-856a0f4c185e;;S-1-5-32-561)(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;WD)(OA;;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;CR;ab721a54-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;CR;ab721a56-1e2f-11d0-9819-00aa0040529b;;PS)(OA;;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;;AU)(OA;;RP;e48d0154-bcf8-11d1-8702-00c04fb96050;;AU)(OA;;RP;77b5b886-944a-11d1-aebd-0000f80367c1;;AU)(OA;;RP;e45795b3-9455-11d1-aebd-0000f80367c1;;AU)(OA;;RPWP;77b5b886-944a-11d1-aebd-0000f80367c1;;PS)(OA;;RPWP;e45795b2-9455-11d1-aebd-0000f80367c1;;PS)(OA;;RPWP;e45795b3-9455-11d1-aebd-0000f80367c1;;PS)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;DA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;AO)(A;;RC;;;AU)(A;;LCRPLORC;;;PS)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(OA;CIID;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1233)(OA;CIID;RPWP;bf967a0a-0de6-11d0-a285-00aa003049e2;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1233)(OA;CIID;CCDC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIID;CCDC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1605)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1605)(OD;CIID;WP;f3a64788-5306-11d1-a9c5-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIIOID;RP;4c164200-20c0-11d0-a768-00aa006e0529;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;4c164200-20c0-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;5f202010-79a5-11d0-9020-00c04fc2d4cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;bc0ac240-79a9-11d0-9020-00c04fc2d4cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;59ba2f42-79a2-11d0-9020-00c04fc2d3cf;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;RP;037088f8-0ae1-11d2-b422-00a0c968f939;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIID;RP;037088f8-0ae1-11d2-b422-00a0c968f939;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-4230534742-2542757381-3142984815-1199)(OA;CIID;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-4230534742-2542757381-3142984815-526)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-4230534742-2542757381-3142984815-527)(OA;CIIOID;DT;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;DT;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIID;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-4230534742-2542757381-3142984815-1204)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1190)(OA;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SDWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIID;SDWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-4230534742-2542757381-3142984815-1207)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-4230534742-2542757381-3142984815-1205)(OA;CIIOID;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIOID;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CIID;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CIID;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIID;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;CIID;LCRPLORC;;;S-1-5-21-4230534742-2542757381-3142984815-1190)(A;CIID;LCRPLORC;;;S-1-5-21-4230534742-2542757381-3142984815-1205)(A;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-4230534742-2542757381-3142984815-519)(A;CIID;LC;;;RU)(A;CIID;CCLCSWRPWPLOCRSDRCWDWO;;;BA)S:AI(AU;CIIDSA;WPWDWO;;;WD)(AU;CIIDSA;CRWD;;;WD)", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-22T22:35:41.1517461Z", "eventRecordID": "111655666", "processID": "556", "threadID": "12772", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x24DF9365\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{bf967a86-0de6-11d0-a285-00aa003049e2}\n\tObject Name:\t\t%{832b1c45-2f6e-4c82-be40-d461e377f560}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tControl Access\n\t\t\t\t\n\tAccess Mask:\t\t0x100\n\tProperties:\t\tControl Access\n\t{bf967a86-0de6-11d0-a285-00aa003049e2}\n\t\t{91e647de-d96f-4b70-9557-d63ff4f3ccd8}\n\t\t\t{6617e4ac-a2f1-43ab-b60c-11fbd1facf05}\n\t\t\t{b3f93023-9239-4f7c-b99c-6745d87adbc2}\n\t\t\t{b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7}\n\t\t\t{b7ff5a38-0818-42b0-8110-d3d154c97f24}\n\t\t{771727b1-31b8-4cdf-ae62-4fe39fadf89e}\n\t\t\t{aa4e1a6d-550d-4e05-8c35-4afcb917a9fe}\n\t\t\t{612cb747-c0e8-4f92-9221-fdd5f15b550d}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x24df9365", "objectServer": "DS", "objectType": "%{bf967a86-0de6-11d0-a285-00aa003049e2}", "objectName": "%{832b1c45-2f6e-4c82-be40-d461e377f560}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%7688", "accessMask": "0x100", "properties": "%%7688\n\t{bf967a86-0de6-11d0-a285-00aa003049e2}\n\t\t{91e647de-d96f-4b70-9557-d63ff4f3ccd8}\n\t\t\t{6617e4ac-a2f1-43ab-b60c-11fbd1facf05}\n\t\t\t{b3f93023-9239-4f7c-b99c-6745d87adbc2}\n\t\t\t{b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7}\n\t\t\t{b7ff5a38-0818-42b0-8110-d3d154c97f24}\n\t\t{771727b1-31b8-4cdf-ae62-4fe39fadf89e}\n\t\t\t{aa4e1a6d-550d-4e05-8c35-4afcb917a9fe}\n\t\t\t{612cb747-c0e8-4f92-9221-fdd5f15b550d}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-22T22:35:41.1644170Z", "eventRecordID": "111655670", "processID": "556", "threadID": "4060", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x24DF94E1\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{bf967a86-0de6-11d0-a285-00aa003049e2}\n\tObject Name:\t\t%{832b1c45-2f6e-4c82-be40-d461e377f560}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tControl Access\n\t\t\t\t\n\tAccess Mask:\t\t0x100\n\tProperties:\t\tControl Access\n\t{bf967a86-0de6-11d0-a285-00aa003049e2}\n\t\t{91e647de-d96f-4b70-9557-d63ff4f3ccd8}\n\t\t\t{6617e4ac-a2f1-43ab-b60c-11fbd1facf05}\n\t\t\t{b3f93023-9239-4f7c-b99c-6745d87adbc2}\n\t\t\t{b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7}\n\t\t\t{b7ff5a38-0818-42b0-8110-d3d154c97f24}\n\t\t{771727b1-31b8-4cdf-ae62-4fe39fadf89e}\n\t\t\t{aa4e1a6d-550d-4e05-8c35-4afcb917a9fe}\n\t\t\t{612cb747-c0e8-4f92-9221-fdd5f15b550d}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x24df94e1", "objectServer": "DS", "objectType": "%{bf967a86-0de6-11d0-a285-00aa003049e2}", "objectName": "%{832b1c45-2f6e-4c82-be40-d461e377f560}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%7688", "accessMask": "0x100", "properties": "%%7688\n\t{bf967a86-0de6-11d0-a285-00aa003049e2}\n\t\t{91e647de-d96f-4b70-9557-d63ff4f3ccd8}\n\t\t\t{6617e4ac-a2f1-43ab-b60c-11fbd1facf05}\n\t\t\t{b3f93023-9239-4f7c-b99c-6745d87adbc2}\n\t\t\t{b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7}\n\t\t\t{b7ff5a38-0818-42b0-8110-d3d154c97f24}\n\t\t{771727b1-31b8-4cdf-ae62-4fe39fadf89e}\n\t\t\t{aa4e1a6d-550d-4e05-8c35-4afcb917a9fe}\n\t\t\t{612cb747-c0e8-4f92-9221-fdd5f15b550d}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-22T22:35:41.6866812Z", "eventRecordID": "111655696", "processID": "556", "threadID": "12772", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x24DFA7A2\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{bf967a86-0de6-11d0-a285-00aa003049e2}\n\tObject Name:\t\t%{832b1c45-2f6e-4c82-be40-d461e377f560}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tControl Access\n\t\t\t\t\n\tAccess Mask:\t\t0x100\n\tProperties:\t\tControl Access\n\t{bf967a86-0de6-11d0-a285-00aa003049e2}\n\t\t{91e647de-d96f-4b70-9557-d63ff4f3ccd8}\n\t\t\t{6617e4ac-a2f1-43ab-b60c-11fbd1facf05}\n\t\t\t{b3f93023-9239-4f7c-b99c-6745d87adbc2}\n\t\t\t{b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7}\n\t\t\t{b7ff5a38-0818-42b0-8110-d3d154c97f24}\n\t\t{771727b1-31b8-4cdf-ae62-4fe39fadf89e}\n\t\t\t{aa4e1a6d-550d-4e05-8c35-4afcb917a9fe}\n\t\t\t{612cb747-c0e8-4f92-9221-fdd5f15b550d}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x24dfa7a2", "objectServer": "DS", "objectType": "%{bf967a86-0de6-11d0-a285-00aa003049e2}", "objectName": "%{832b1c45-2f6e-4c82-be40-d461e377f560}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%7688", "accessMask": "0x100", "properties": "%%7688\n\t{bf967a86-0de6-11d0-a285-00aa003049e2}\n\t\t{91e647de-d96f-4b70-9557-d63ff4f3ccd8}\n\t\t\t{6617e4ac-a2f1-43ab-b60c-11fbd1facf05}\n\t\t\t{b3f93023-9239-4f7c-b99c-6745d87adbc2}\n\t\t\t{b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7}\n\t\t\t{b7ff5a38-0818-42b0-8110-d3d154c97f24}\n\t\t{771727b1-31b8-4cdf-ae62-4fe39fadf89e}\n\t\t\t{aa4e1a6d-550d-4e05-8c35-4afcb917a9fe}\n\t\t\t{612cb747-c0e8-4f92-9221-fdd5f15b550d}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-22T22:35:41.7015476Z", "eventRecordID": "111655700", "processID": "556", "threadID": "4060", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x24DFA91E\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{bf967a86-0de6-11d0-a285-00aa003049e2}\n\tObject Name:\t\t%{832b1c45-2f6e-4c82-be40-d461e377f560}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tControl Access\n\t\t\t\t\n\tAccess Mask:\t\t0x100\n\tProperties:\t\tControl Access\n\t{bf967a86-0de6-11d0-a285-00aa003049e2}\n\t\t{91e647de-d96f-4b70-9557-d63ff4f3ccd8}\n\t\t\t{6617e4ac-a2f1-43ab-b60c-11fbd1facf05}\n\t\t\t{b3f93023-9239-4f7c-b99c-6745d87adbc2}\n\t\t\t{b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7}\n\t\t\t{b7ff5a38-0818-42b0-8110-d3d154c97f24}\n\t\t{771727b1-31b8-4cdf-ae62-4fe39fadf89e}\n\t\t\t{aa4e1a6d-550d-4e05-8c35-4afcb917a9fe}\n\t\t\t{612cb747-c0e8-4f92-9221-fdd5f15b550d}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x24dfa91e", "objectServer": "DS", "objectType": "%{bf967a86-0de6-11d0-a285-00aa003049e2}", "objectName": "%{832b1c45-2f6e-4c82-be40-d461e377f560}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%7688", "accessMask": "0x100", "properties": "%%7688\n\t{bf967a86-0de6-11d0-a285-00aa003049e2}\n\t\t{91e647de-d96f-4b70-9557-d63ff4f3ccd8}\n\t\t\t{6617e4ac-a2f1-43ab-b60c-11fbd1facf05}\n\t\t\t{b3f93023-9239-4f7c-b99c-6745d87adbc2}\n\t\t\t{b8dfa744-31dc-4ef1-ac7c-84baf7ef9da7}\n\t\t\t{b7ff5a38-0818-42b0-8110-d3d154c97f24}\n\t\t{771727b1-31b8-4cdf-ae62-4fe39fadf89e}\n\t\t\t{aa4e1a6d-550d-4e05-8c35-4afcb917a9fe}\n\t\t\t{612cb747-c0e8-4f92-9221-fdd5f15b550d}"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id5136_computer_account_set_for_rbcd_delegation(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4742", "version": "0", "level": "0", "task": "13825", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-11-29T21:04:17.7647291Z", "eventRecordID": "42361", "processID": "676", "threadID": "1848", "channel": "Security", "computer": "AD01.kdmo.lan", "severityValue": "AUDIT_SUCCESS", "message": "A computer account was changed.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-1089590679-3038349081-645448463-500\n\tAccount Name:\t\tAdministrator\n\tAccount Domain:\t\tKDMO\n\tLogon ID:\t\t0x445EA\n\nComputer Account That Was Changed:\n\tSecurity ID:\t\tS-1-5-21-1089590679-3038349081-645448463-1112\n\tAccount Name:\t\tTARGET01$\n\tAccount Domain:\t\tKDMO\n\nChanged Attributes:\n\tSAM Account Name:\t-\n\tDisplay Name:\t\t-\n\tUser Principal Name:\t-\n\tHome Directory:\t\t-\n\tHome Drive:\t\t-\n\tScript Path:\t\t-\n\tProfile Path:\t\t-\n\tUser Workstations:\t-\n\tPassword Last Set:\t-\n\tAccount Expires:\t\t-\n\tPrimary Group ID:\t-\n\tAllowedToDelegateTo:\t-\n\tOld UAC Value:\t\t-\n\tNew UAC Value:\t\t-\n\tUser Account Control:\t-\n\tUser Parameters:\t-\n\tSID History:\t\t-\n\tLogon Hours:\t\t-\n\tDNS Host Name:\t\t-\n\tService Principal Names:\t-\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"targetUserName": "TARGET01$", "targetDomainName": "KDMO", "targetSid": "S-1-5-21-1089590679-3038349081-645448463-1112", "subjectUserSid": "S-1-5-21-1089590679-3038349081-645448463-500", "subjectUserName": "Administrator", "subjectDomainName": "KDMO", "subjectLogonId": "0x445ea"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-11-29T21:04:24.8098051Z", "eventRecordID": "42362", "processID": "676", "threadID": "780", "channel": "Security", "computer": "AD01.kdmo.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-1089590679-3038349081-645448463-500\n\tAccount Name:\t\tAdministrator\n\tAccount Domain:\t\tKDMO\n\tLogon ID:\t\t0x445EA\n\nDirectory Service:\n\tName:\tkdmo.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tCN=TARGET01,CN=Computers,DC=kdmo,DC=lan\n\tGUID:\t{3cdb7225-cb8a-493e-914e-11e16e563acb}\n\tClass:\tcomputer\n\t\nAttribute:\n\tLDAP Display Name:\tmsDS-AllowedToActOnBehalfOfOtherIdentity\n\tSyntax (OID):\t2.5.5.15\n\tValue:\tMalformed Security Descriptor\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{975f80f3-f60a-4a74-9df8-f132cdd9658c}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{975f80f3-f60a-4a74-9df8-f132cdd9658c}", "subjectUserSid": "S-1-5-21-1089590679-3038349081-645448463-500", "subjectUserName": "Administrator", "subjectDomainName": "KDMO", "subjectLogonId": "0x445ea", "dSName": "kdmo.lan", "dSType": "%%14676", "objectDN": "CN=TARGET01,CN=Computers,DC=kdmo,DC=lan", "objectGUID": "{3cdb7225-cb8a-493e-914e-11e16e563acb}", "objectClass": "computer", "attributeLDAPDisplayName": "msDS-AllowedToActOnBehalfOfOtherIdentity", "attributeSyntaxOID": "2.5.5.15", "attributeValue": "Malformed Security Descriptor", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-11-29T21:04:54.8253055Z", "eventRecordID": "42371", "processID": "676", "threadID": "780", "channel": "Security", "computer": "AD01.kdmo.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-1089590679-3038349081-645448463-500\n\tAccount Name:\t\tAdministrator\n\tAccount Domain:\t\tKDMO\n\tLogon ID:\t\t0x445EA\n\nDirectory Service:\n\tName:\tkdmo.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tou=SERVERS,OU=ASSETS,DC=kdmo,DC=lan\n\tGUID:\t{ce449fac-47d0-4f69-8f90-2110ae131ff8}\n\tClass:\torganizationalUnit\n\t\nAttribute:\n\tLDAP Display Name:\tobjectClass\n\tSyntax (OID):\t2.5.5.2\n\tValue:\t2.5.6.5\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{5a74a773-eb7d-4167-85d9-a41faa53a396}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{5a74a773-eb7d-4167-85d9-a41faa53a396}", "subjectUserSid": "S-1-5-21-1089590679-3038349081-645448463-500", "subjectUserName": "Administrator", "subjectDomainName": "KDMO", "subjectLogonId": "0x445ea", "dSName": "kdmo.lan", "dSType": "%%14676", "objectDN": "ou=SERVERS,OU=ASSETS,DC=kdmo,DC=lan", "objectGUID": "{ce449fac-47d0-4f69-8f90-2110ae131ff8}", "objectClass": "organizationalUnit", "attributeLDAPDisplayName": "objectClass", "attributeSyntaxOID": "2.5.5.2", "attributeValue": "2.5.6.5", "operationType": "%%14674"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-11-29T21:04:54.8256180Z", "eventRecordID": "42372", "processID": "676", "threadID": "780", "channel": "Security", "computer": "AD01.kdmo.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-1089590679-3038349081-645448463-500\n\tAccount Name:\t\tAdministrator\n\tAccount Domain:\t\tKDMO\n\tLogon ID:\t\t0x445EA\n\nDirectory Service:\n\tName:\tkdmo.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tou=SERVERS,OU=ASSETS,DC=kdmo,DC=lan\n\tGUID:\t{ce449fac-47d0-4f69-8f90-2110ae131ff8}\n\tClass:\torganizationalUnit\n\t\nAttribute:\n\tLDAP Display Name:\tnTSecurityDescriptor\n\tSyntax (OID):\t2.5.5.15\n\tValue:\tO:DAG:DAD:AI(OA;;CCDC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;AO)(OA;;CCDC;bf967a86-0de6-11d0-a285-00aa003049e2;;AO)(OA;;CCDC;bf967a9c-0de6-11d0-a285-00aa003049e2;;AO)(OA;;CCDC;bf967aa8-0de6-11d0-a285-00aa003049e2;;PO)(OA;;CCDC;bf967aba-0de6-11d0-a285-00aa003049e2;;AO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;DA)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-1089590679-3038349081-645448463-526)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-1089590679-3038349081-645448463-527)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIOID;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;WD)(OA;CIID;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIID;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-1089590679-3038349081-645448463-519)(A;CIID;LC;;;RU)(A;CIID;CCLCSWRPWPLOCRSDRCWDWO;;;BA)S:AI(OU;CIIOIDSA;CRWDWO;;bf967a9c-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIOIDSA;CRWDWO;;bf967aba-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIDSA;CCDC;bf967aa5-0de6-11d0-a285-00aa003049e2;;WD)(OU;CIIOIDSA;WPCRWDWO;;bf967a86-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIDSA;WPCRSDWDWO;;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;CIIDSA;CRWD;;;WD)\n\t\nOperation:\n\tType:\tValue Deleted\n\tCorrelation ID:\t{d145679a-a75e-4162-9719-3167d986899d}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{d145679a-a75e-4162-9719-3167d986899d}", "subjectUserSid": "S-1-5-21-1089590679-3038349081-645448463-500", "subjectUserName": "Administrator", "subjectDomainName": "KDMO", "subjectLogonId": "0x445ea", "dSName": "kdmo.lan", "dSType": "%%14676", "objectDN": "ou=SERVERS,OU=ASSETS,DC=kdmo,DC=lan", "objectGUID": "{ce449fac-47d0-4f69-8f90-2110ae131ff8}", "objectClass": "organizationalUnit", "attributeLDAPDisplayName": "nTSecurityDescriptor", "attributeSyntaxOID": "2.5.5.15", "attributeValue": "O:DAG:DAD:AI(OA;;CCDC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;AO)(OA;;CCDC;bf967a86-0de6-11d0-a285-00aa003049e2;;AO)(OA;;CCDC;bf967a9c-0de6-11d0-a285-00aa003049e2;;AO)(OA;;CCDC;bf967aa8-0de6-11d0-a285-00aa003049e2;;PO)(OA;;CCDC;bf967aba-0de6-11d0-a285-00aa003049e2;;AO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;DA)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-1089590679-3038349081-645448463-526)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-1089590679-3038349081-645448463-527)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIOID;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;WD)(OA;CIID;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIID;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-1089590679-3038349081-645448463-519)(A;CIID;LC;;;RU)(A;CIID;CCLCSWRPWPLOCRSDRCWDWO;;;BA)S:AI(OU;CIIOIDSA;CRWDWO;;bf967a9c-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIOIDSA;CRWDWO;;bf967aba-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIDSA;CCDC;bf967aa5-0de6-11d0-a285-00aa003049e2;;WD)(OU;CIIOIDSA;WPCRWDWO;;bf967a86-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIDSA;WPCRSDWDWO;;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;CIIDSA;CRWD;;;WD)", "operationType": "%%14675"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5136", "version": "0", "level": "0", "task": "14081", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-11-29T21:04:54.8259104Z", "eventRecordID": "42373", "processID": "676", "threadID": "780", "channel": "Security", "computer": "AD01.kdmo.lan", "severityValue": "AUDIT_SUCCESS", "message": "A directory service object was modified.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-1089590679-3038349081-645448463-500\n\tAccount Name:\t\tAdministrator\n\tAccount Domain:\t\tKDMO\n\tLogon ID:\t\t0x445EA\n\nDirectory Service:\n\tName:\tkdmo.lan\n\tType:\tActive Directory Domain Services\n\t\nObject:\n\tDN:\tou=SERVERS,OU=ASSETS,DC=kdmo,DC=lan\n\tGUID:\t{ce449fac-47d0-4f69-8f90-2110ae131ff8}\n\tClass:\torganizationalUnit\n\t\nAttribute:\n\tLDAP Display Name:\tnTSecurityDescriptor\n\tSyntax (OID):\t2.5.5.15\n\tValue:\tO:DAG:DAD:AI(D;;DTSD;;;WD)(OA;;CCDC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;AO)(OA;;CCDC;bf967a86-0de6-11d0-a285-00aa003049e2;;AO)(OA;;CCDC;bf967a9c-0de6-11d0-a285-00aa003049e2;;AO)(OA;;CCDC;bf967aa8-0de6-11d0-a285-00aa003049e2;;PO)(OA;;CCDC;bf967aba-0de6-11d0-a285-00aa003049e2;;AO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;DA)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-1089590679-3038349081-645448463-526)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-1089590679-3038349081-645448463-527)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIOID;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;WD)(OA;CIID;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIID;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-1089590679-3038349081-645448463-519)(A;CIID;LC;;;RU)(A;CIID;CCLCSWRPWPLOCRSDRCWDWO;;;BA)S:AI(OU;CIIOIDSA;CRWDWO;;bf967a9c-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIOIDSA;CRWDWO;;bf967aba-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIDSA;CCDC;bf967aa5-0de6-11d0-a285-00aa003049e2;;WD)(OU;CIIOIDSA;WPCRWDWO;;bf967a86-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIDSA;WPCRSDWDWO;;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;CIIDSA;CRWD;;;WD)\n\t\nOperation:\n\tType:\tValue Added\n\tCorrelation ID:\t{d145679a-a75e-4162-9719-3167d986899d}\n\tApplication Correlation ID:\t-"}, "eventdata": {"opCorrelationID": "{d145679a-a75e-4162-9719-3167d986899d}", "subjectUserSid": "S-1-5-21-1089590679-3038349081-645448463-500", "subjectUserName": "Administrator", "subjectDomainName": "KDMO", "subjectLogonId": "0x445ea", "dSName": "kdmo.lan", "dSType": "%%14676", "objectDN": "ou=SERVERS,OU=ASSETS,DC=kdmo,DC=lan", "objectGUID": "{ce449fac-47d0-4f69-8f90-2110ae131ff8}", "objectClass": "organizationalUnit", "attributeLDAPDisplayName": "nTSecurityDescriptor", "attributeSyntaxOID": "2.5.5.15", "attributeValue": "O:DAG:DAD:AI(D;;DTSD;;;WD)(OA;;CCDC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;AO)(OA;;CCDC;bf967a86-0de6-11d0-a285-00aa003049e2;;AO)(OA;;CCDC;bf967a9c-0de6-11d0-a285-00aa003049e2;;AO)(OA;;CCDC;bf967aa8-0de6-11d0-a285-00aa003049e2;;PO)(OA;;CCDC;bf967aba-0de6-11d0-a285-00aa003049e2;;AO)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;DA)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-1089590679-3038349081-645448463-526)(OA;CIID;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-1089590679-3038349081-645448463-527)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIOID;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIOID;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIOID;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIOID;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIOID;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;CIID;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;WD)(OA;CIID;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIID;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;CIID;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-1089590679-3038349081-645448463-519)(A;CIID;LC;;;RU)(A;CIID;CCLCSWRPWPLOCRSDRCWDWO;;;BA)S:AI(OU;CIIOIDSA;CRWDWO;;bf967a9c-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIOIDSA;CRWDWO;;bf967aba-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIDSA;CCDC;bf967aa5-0de6-11d0-a285-00aa003049e2;;WD)(OU;CIIOIDSA;WPCRWDWO;;bf967a86-0de6-11d0-a285-00aa003049e2;WD)(OU;CIIDSA;WPCRSDWDWO;;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;CIIDSA;CRWD;;;WD)", "operationType": "%%14674"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")
