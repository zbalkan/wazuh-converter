import unittest

from internal.logtest import LogtestStatus, send_multiple_logs  # type: ignore


class TestTa0005DefenseEvasionT1562001ImpairDefensesDisableOrModifyTool(unittest.TestCase):

    def test_id1_sysmon_driver_unload_filtermanager(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-FilterManager", "providerGuid": "{f3c5e28e-63f6-49c7-a204-e48a1bc4b09d}", "eventID": "1", "version": "0", "level": "4", "task": "0", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2024-05-30T13:07:25.2607503Z", "eventRecordID": "2216", "processID": "4", "threadID": "8952", "channel": "System", "computer": "WIN", "severityValue": "INFORMATION", "message": "File System Filter 'SysmonDrv' (Version 0.0, \u200e2023\u200e-\u200e01\u200e-\u200e20T18:59:19.000000000Z) unloaded successfully."}, "eventdata": {"finalStatus": "0x0", "deviceVersionMajor": "0", "deviceVersionMinor": "0", "deviceNameLength": "9", "deviceName": "SysmonDrv", "deviceTime": "2023-01-20T18:59:19.0000000Z"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id13_defender_service_configuration_disabled(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-02-02T22:54:57.0334771Z", "eventRecordID": "1601463", "processID": "3044", "threadID": "3740", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: -\nEventType: SetValue\nUtcTime: 2022-02-02 22:54:57.032\nProcessGuid: {9828da72-b353-61fa-0b00-00000000f000}\nProcessId: 648\nImage: C:\\Windows\\system32\\services.exe\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\WdNisDrv\\Start\nDetails: DWORD (0x00000003)\nUser: %9"}, "eventdata": {"eventType": "SetValue", "utcTime": "2022-02-02 22:54:57.032", "processGuid": "{9828da72-b353-61fa-0b00-00000000f000}", "processId": "648", "image": "C:\\Windows\\system32\\services.exe", "targetObject": "HKLM\\System\\CurrentControlSet\\Services\\WdNisDrv\\Start", "details": "DWORD (0x00000003)"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-02-02T22:54:57.3475261Z", "eventRecordID": "1601464", "processID": "3044", "threadID": "3740", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: -\nEventType: SetValue\nUtcTime: 2022-02-02 22:54:57.342\nProcessGuid: {9828da72-b353-61fa-0b00-00000000f000}\nProcessId: 648\nImage: C:\\Windows\\system32\\services.exe\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\WdNisDrv\\Start\nDetails: DWORD (0x00000003)\nUser: %9"}, "eventdata": {"eventType": "SetValue", "utcTime": "2022-02-02 22:54:57.342", "processGuid": "{9828da72-b353-61fa-0b00-00000000f000}", "processId": "648", "image": "C:\\Windows\\system32\\services.exe", "targetObject": "HKLM\\System\\CurrentControlSet\\Services\\WdNisDrv\\Start", "details": "DWORD (0x00000003)"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4688_defender_critical_features_disabled_command(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-06T09:46:09.5338427Z", "eventRecordID": "2872057", "processID": "4", "threadID": "11120", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x5F72FEE\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x242c\n\tNew Process Name:\tC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x2924\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tpowershell.exe  -command \"Set-MpPreference -EnableControlledFolderAccess Disabled\"\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x5f72fee", "newProcessId": "0x242c", "newProcessName": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "tokenElevationType": "%%1936", "processId": "0x2924", "commandLine": "powershell.exe  -command \"Set-MpPreference -EnableControlledFolderAccess Disabled\"", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-06T09:46:12.4860286Z", "eventRecordID": "2872075", "processID": "4", "threadID": "3788", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tWIN10-02$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-5-19\n\tAccount Name:\t\tLOCAL SERVICE\n\tAccount Domain:\t\tNT AUTHORITY\n\tLogon ID:\t\t0x3E5\n\nProcess Information:\n\tNew Process ID:\t\t0x1bd4\n\tNew Process Name:\tC:\\Windows\\System32\\wbem\\WmiPrvSE.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x318\n\tCreator Process Name:\tC:\\Windows\\System32\\svchost.exe\n\tProcess Command Line:\tC:\\Windows\\system32\\wbem\\wmiprvse.exe -secured -Embedding\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "WIN10-02$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x1bd4", "newProcessName": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe", "tokenElevationType": "%%1936", "processId": "0x318", "commandLine": "C:\\Windows\\system32\\wbem\\wmiprvse.exe -secured -Embedding", "targetUserSid": "S-1-5-19", "targetUserName": "LOCAL SERVICE", "targetDomainName": "NT AUTHORITY", "targetLogonId": "0x3e5", "parentProcessName": "C:\\Windows\\System32\\svchost.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-06T09:46:13.1686321Z", "eventRecordID": "2872082", "processID": "4", "threadID": "5012", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x5F72FEE\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x21f4\n\tNew Process Name:\tC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x2924\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tpowershell.exe  -command \"Set-MpPreference -PUAProtection disable\"\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x5f72fee", "newProcessId": "0x21f4", "newProcessName": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "tokenElevationType": "%%1936", "processId": "0x2924", "commandLine": "powershell.exe  -command \"Set-MpPreference -PUAProtection disable\"", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-06T09:46:18.3492759Z", "eventRecordID": "2872117", "processID": "4", "threadID": "7656", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tWIN10-02$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x23e4\n\tNew Process Name:\tC:\\Windows\\System32\\wevtutil.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x870\n\tCreator Process Name:\tC:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.2108.7-0\\MsMpEng.exe\n\tProcess Command Line:\tC:\\Windows\\system32\\wevtutil.exe uninstall-manifest C:\\Windows\\TEMP\\2FB5D5D3-E6BD-E814-5320-EA7E57984413.man\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "WIN10-02$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x23e4", "newProcessName": "C:\\Windows\\System32\\wevtutil.exe", "tokenElevationType": "%%1936", "processId": "0x870", "commandLine": "C:\\Windows\\system32\\wevtutil.exe uninstall-manifest C:\\Windows\\TEMP\\2FB5D5D3-E6BD-E814-5320-EA7E57984413.man", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.2108.7-0\\MsMpEng.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-06T09:46:18.4907636Z", "eventRecordID": "2872118", "processID": "4", "threadID": "7656", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tWIN10-02$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x286c\n\tNew Process Name:\tC:\\Windows\\System32\\conhost.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x23e4\n\tCreator Process Name:\tC:\\Windows\\System32\\wevtutil.exe\n\tProcess Command Line:\t\\??\\C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "WIN10-02$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x286c", "newProcessName": "C:\\Windows\\System32\\conhost.exe", "tokenElevationType": "%%1936", "processId": "0x23e4", "commandLine": "\\??\\C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\wevtutil.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-06T09:46:18.9404867Z", "eventRecordID": "2872119", "processID": "4", "threadID": "7656", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tWIN10-02$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x1618\n\tNew Process Name:\tC:\\Windows\\System32\\wevtutil.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x870\n\tCreator Process Name:\tC:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.2108.7-0\\MsMpEng.exe\n\tProcess Command Line:\tC:\\Windows\\system32\\wevtutil.exe install-manifest C:\\Windows\\TEMP\\2FB5D5D3-E6BD-E814-5320-EA7E57984413.man \"/resourceFilePath:C:\\ProgramData\\Microsoft\\Windows Defender\\Definition Updates\\StableEngineEtwLocation\\mpengine_etw.dll\" \"/messageFilePath:C:\\ProgramData\\Microsoft\\Windows Defender\\Definition Updates\\StableEngineEtwLocation\\mpengine_etw.dll\" \"/parameterFilePath:C:\\ProgramData\\Microsoft\\Windows Defender\\Definition Updates\\StableEngineEtwLocation\\mpengine_etw.dll\"\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "WIN10-02$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x1618", "newProcessName": "C:\\Windows\\System32\\wevtutil.exe", "tokenElevationType": "%%1936", "processId": "0x870", "commandLine": "C:\\Windows\\system32\\wevtutil.exe install-manifest C:\\Windows\\TEMP\\2FB5D5D3-E6BD-E814-5320-EA7E57984413.man \"/resourceFilePath:C:\\ProgramData\\Microsoft\\Windows Defender\\Definition Updates\\StableEngineEtwLocation\\mpengine_etw.dll\" \"/messageFilePath:C:\\ProgramData\\Microsoft\\Windows Defender\\Definition Updates\\StableEngineEtwLocation\\mpengine_etw.dll\" \"/parameterFilePath:C:\\ProgramData\\Microsoft\\Windows Defender\\Definition Updates\\StableEngineEtwLocation\\mpengine_etw.dll\"", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.2108.7-0\\MsMpEng.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-06T09:46:18.9554696Z", "eventRecordID": "2872120", "processID": "4", "threadID": "3788", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tWIN10-02$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x94c\n\tNew Process Name:\tC:\\Windows\\System32\\conhost.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x1618\n\tCreator Process Name:\tC:\\Windows\\System32\\wevtutil.exe\n\tProcess Command Line:\t\\??\\C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "WIN10-02$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x94c", "newProcessName": "C:\\Windows\\System32\\conhost.exe", "tokenElevationType": "%%1936", "processId": "0x1618", "commandLine": "\\??\\C:\\Windows\\system32\\conhost.exe 0xffffffff -ForceV1", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\wevtutil.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-06T09:46:21.0104349Z", "eventRecordID": "2872121", "processID": "4", "threadID": "11120", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tWIN10-02$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x5F72FEE\n\nProcess Information:\n\tNew Process ID:\t\t0x28ec\n\tNew Process Name:\tC:\\Users\\admmig\\AppData\\Local\\Microsoft\\OneDrive\\21.180.0905.0007\\FileCoAuth.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x318\n\tCreator Process Name:\tC:\\Windows\\System32\\svchost.exe\n\tProcess Command Line:\t\"C:\\Users\\admmig\\AppData\\Local\\Microsoft\\OneDrive\\21.180.0905.0007\\FileCoAuth.exe\" -Embedding\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "WIN10-02$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x28ec", "newProcessName": "C:\\Users\\admmig\\AppData\\Local\\Microsoft\\OneDrive\\21.180.0905.0007\\FileCoAuth.exe", "tokenElevationType": "%%1936", "processId": "0x318", "commandLine": "\"C:\\Users\\admmig\\AppData\\Local\\Microsoft\\OneDrive\\21.180.0905.0007\\FileCoAuth.exe\" -Embedding", "targetUserSid": "S-1-0-0", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0x5f72fee", "parentProcessName": "C:\\Windows\\System32\\svchost.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-06T09:46:28.6836181Z", "eventRecordID": "2872122", "processID": "4", "threadID": "1084", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tWIN10-02$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x5F72FEE\n\nProcess Information:\n\tNew Process ID:\t\t0x1bcc\n\tNew Process Name:\tC:\\Windows\\System32\\dllhost.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x318\n\tCreator Process Name:\tC:\\Windows\\System32\\svchost.exe\n\tProcess Command Line:\tC:\\Windows\\system32\\DllHost.exe /Processid:{AB8902B4-09CA-4BB6-B78D-A8F59079A8D5}\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "WIN10-02$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x1bcc", "newProcessName": "C:\\Windows\\System32\\dllhost.exe", "tokenElevationType": "%%1936", "processId": "0x318", "commandLine": "C:\\Windows\\system32\\DllHost.exe /Processid:{AB8902B4-09CA-4BB6-B78D-A8F59079A8D5}", "targetUserSid": "S-1-0-0", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0x5f72fee", "parentProcessName": "C:\\Windows\\System32\\svchost.exe", "mandatoryLabel": "S-1-16-12288"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4688_defender_service_deactivation_attempt(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-25T07:57:04.3616967Z", "eventRecordID": "3294254", "processID": "4", "threadID": "4524", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x1844FA6\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0xe58\n\tNew Process Name:\tC:\\Windows\\System32\\sc.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x32f8\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tsc  config sense start= disabled\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x1844fa6", "newProcessId": "0xe58", "newProcessName": "C:\\Windows\\System32\\sc.exe", "tokenElevationType": "%%1936", "processId": "0x32f8", "commandLine": "sc  config sense start= disabled", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-25T07:57:05.9776098Z", "eventRecordID": "3294255", "processID": "4", "threadID": "4524", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x1844FA6\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x2ebc\n\tNew Process Name:\tC:\\Windows\\System32\\sc.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x32f8\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tsc  config mpssvc start= disabled\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x1844fa6", "newProcessId": "0x2ebc", "newProcessName": "C:\\Windows\\System32\\sc.exe", "tokenElevationType": "%%1936", "processId": "0x32f8", "commandLine": "sc  config mpssvc start= disabled", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-25T07:57:08.4638989Z", "eventRecordID": "3294257", "processID": "4", "threadID": "4524", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x1844FA6\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x2e40\n\tNew Process Name:\tC:\\Windows\\System32\\sc.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x32f8\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tsc  config WinDefend start= disabled\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x1844fa6", "newProcessId": "0x2e40", "newProcessName": "C:\\Windows\\System32\\sc.exe", "tokenElevationType": "%%1936", "processId": "0x32f8", "commandLine": "sc  config WinDefend start= disabled", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-25T07:57:18.4548891Z", "eventRecordID": "3294260", "processID": "4", "threadID": "10272", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tWIN10-02$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x1844FA6\n\nProcess Information:\n\tNew Process ID:\t\t0x1934\n\tNew Process Name:\tC:\\Windows\\System32\\backgroundTaskHost.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-4096\n\tCreator Process ID:\t0x31c\n\tCreator Process Name:\tC:\\Windows\\System32\\svchost.exe\n\tProcess Command Line:\t\"C:\\Windows\\system32\\BackgroundTaskHost.exe\" -ServerName:BackgroundTaskHost.WebAccountProvider\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "WIN10-02$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x1934", "newProcessName": "C:\\Windows\\System32\\backgroundTaskHost.exe", "tokenElevationType": "%%1936", "processId": "0x31c", "commandLine": "\"C:\\Windows\\system32\\BackgroundTaskHost.exe\" -ServerName:BackgroundTaskHost.WebAccountProvider", "targetUserSid": "S-1-0-0", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0x1844fa6", "parentProcessName": "C:\\Windows\\System32\\svchost.exe", "mandatoryLabel": "S-1-16-4096"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-25T07:57:19.0425506Z", "eventRecordID": "3294261", "processID": "4", "threadID": "5164", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tWIN10-02$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x1844FA6\n\nProcess Information:\n\tNew Process ID:\t\t0x2cd8\n\tNew Process Name:\tC:\\Windows\\System32\\RuntimeBroker.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x31c\n\tCreator Process Name:\tC:\\Windows\\System32\\svchost.exe\n\tProcess Command Line:\tC:\\Windows\\System32\\RuntimeBroker.exe -Embedding\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "WIN10-02$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x2cd8", "newProcessName": "C:\\Windows\\System32\\RuntimeBroker.exe", "tokenElevationType": "%%1936", "processId": "0x31c", "commandLine": "C:\\Windows\\System32\\RuntimeBroker.exe -Embedding", "targetUserSid": "S-1-0-0", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0x1844fa6", "parentProcessName": "C:\\Windows\\System32\\svchost.exe", "mandatoryLabel": "S-1-16-12288"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id5007_defender_threat_exclusion_native(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Windows Defender", "providerGuid": "{11cd958a-c507-4ef3-b3f2-5fd9dfbd2c78}", "eventID": "5007", "version": "0", "level": "4", "task": "0", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2020-12-16T08:44:06.4738503Z", "eventRecordID": "454", "processID": "2988", "threadID": "3524", "channel": "Microsoft-Windows-Windows Defender/Operational", "computer": "WIN10-client01.offsec.lan", "severityValue": "INFORMATION", "message": "Microsoft Defender Antivirus Configuration has changed. If this is an unexpected event you should review the settings as this may be the result of malware.\n \tOld value: HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths\\C:\\TOOLS\\mimikatz.exe = 0x0\n \tNew value:"}, "eventdata": {"product Name": "Microsoft Defender Antivirus", "product Version": "4.18.2011.6", "old Value": "HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths\\C:\\TOOLS\\mimikatz.exe = 0x0"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Windows Defender", "providerGuid": "{11cd958a-c507-4ef3-b3f2-5fd9dfbd2c78}", "eventID": "5007", "version": "0", "level": "4", "task": "0", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2020-12-16T08:44:27.2228245Z", "eventRecordID": "455", "processID": "2988", "threadID": "4724", "channel": "Microsoft-Windows-Windows Defender/Operational", "computer": "WIN10-client01.offsec.lan", "severityValue": "INFORMATION", "message": "Microsoft Defender Antivirus Configuration has changed. If this is an unexpected event you should review the settings as this may be the result of malware.\n \tOld value: \n \tNew value: HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths\\C:\\TOOLS\\mimikatz = 0x0"}, "eventdata": {"product Name": "Microsoft Defender Antivirus", "product Version": "4.18.2011.6", "new Value": "HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths\\C:\\TOOLS\\mimikatz = 0x0"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Windows Defender", "providerGuid": "{11cd958a-c507-4ef3-b3f2-5fd9dfbd2c78}", "eventID": "5007", "version": "0", "level": "4", "task": "0", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2020-12-16T08:44:51.3319979Z", "eventRecordID": "456", "processID": "2988", "threadID": "10652", "channel": "Microsoft-Windows-Windows Defender/Operational", "computer": "WIN10-client01.offsec.lan", "severityValue": "INFORMATION", "message": "Microsoft Defender Antivirus Configuration has changed. If this is an unexpected event you should review the settings as this may be the result of malware.\n \tOld value: \n \tNew value: HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Processes\\virus.exe = 0x0"}, "eventdata": {"product Name": "Microsoft Defender Antivirus", "product Version": "4.18.2011.6", "new Value": "HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Processes\\virus.exe = 0x0"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Windows Defender", "providerGuid": "{11cd958a-c507-4ef3-b3f2-5fd9dfbd2c78}", "eventID": "5007", "version": "0", "level": "4", "task": "0", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2020-12-16T08:45:04.1446272Z", "eventRecordID": "457", "processID": "2988", "threadID": "3524", "channel": "Microsoft-Windows-Windows Defender/Operational", "computer": "WIN10-client01.offsec.lan", "severityValue": "INFORMATION", "message": "Microsoft Defender Antivirus Configuration has changed. If this is an unexpected event you should review the settings as this may be the result of malware.\n \tOld value: \n \tNew value: HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Extensions\\.mimi = 0x0"}, "eventdata": {"product Name": "Microsoft Defender Antivirus", "product Version": "4.18.2011.6", "new Value": "HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Extensions\\.mimi = 0x0"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id8_module_virtualization_disabled_credential_guard(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "8", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-04T09:34:23.1029271Z", "eventRecordID": "21", "processID": "14668", "threadID": "19008", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn off update Windows-Defender-Default-Definitions of package Windows-Defender-Client. Client id: DISM Package Manager Provider."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "10", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-04T09:34:28.5584324Z", "eventRecordID": "22", "processID": "14668", "threadID": "19008", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update Windows-Defender-Default-Definitions of package Windows-Defender-Client was successfully turned off."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "8", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:16:31.7217541Z", "eventRecordID": "23", "processID": "12148", "threadID": "16708", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn off update Printing-PrintToPDFServices-Features of package Microsoft-Windows-Printing-PrintToPDFServices. Client id: Windows Optional Component Manager."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "8", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:16:31.7217818Z", "eventRecordID": "24", "processID": "12148", "threadID": "16708", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn off update Printing-XPSServices-Features of package Microsoft-Windows-Printing-XPSServices. Client id: Windows Optional Component Manager."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "8", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:16:31.7262421Z", "eventRecordID": "25", "processID": "12148", "threadID": "16708", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn off update MediaPlayback of package Microsoft-Windows-MediaPlayback-OC. Client id: Windows Optional Component Manager."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "8", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:16:31.7262443Z", "eventRecordID": "26", "processID": "12148", "threadID": "16708", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn off update WindowsMediaPlayer of package Windows Media Player. Client id: Windows Optional Component Manager."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "8", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:16:31.7263444Z", "eventRecordID": "27", "processID": "12148", "threadID": "16708", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn off update MSRDC-Infrastructure of package Microsoft-Windows-RDC. Client id: Windows Optional Component Manager."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "8", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:16:31.7264444Z", "eventRecordID": "28", "processID": "12148", "threadID": "16708", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn off update WorkFolders-Client of package Microsoft-Windows-EnterpriseClientSync-Host. Client id: Windows Optional Component Manager."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "8", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:16:31.7264648Z", "eventRecordID": "29", "processID": "12148", "threadID": "16708", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn off update Printing-Foundation-Features of package Microsoft-Windows-Printing-Foundation. Client id: Windows Optional Component Manager."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "8", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:16:31.7264855Z", "eventRecordID": "30", "processID": "12148", "threadID": "16708", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn off update Printing-Foundation-InternetPrinting-Client of package Microsoft-Windows-Printing-Foundation. Client id: Windows Optional Component Manager."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "8", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:16:31.7273017Z", "eventRecordID": "31", "processID": "12148", "threadID": "16708", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn off update Internet-Explorer-Optional-amd64 of package Internet-Explorer-Optional-Package. Client id: Windows Optional Component Manager."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "10", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:27:37.4010631Z", "eventRecordID": "49", "processID": "3348", "threadID": "3476", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update Printing-PrintToPDFServices-Features of package Microsoft-Windows-Printing-PrintToPDFServices was successfully turned off."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "10", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:27:37.4010851Z", "eventRecordID": "50", "processID": "3348", "threadID": "3476", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update Printing-XPSServices-Features of package Microsoft-Windows-Printing-XPSServices was successfully turned off."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "10", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:27:37.4015363Z", "eventRecordID": "51", "processID": "3348", "threadID": "3476", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update MediaPlayback of package Microsoft-Windows-MediaPlayback-OC was successfully turned off."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "10", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:27:37.4015550Z", "eventRecordID": "52", "processID": "3348", "threadID": "3476", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update WindowsMediaPlayer of package Windows Media Player was successfully turned off."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "10", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:27:37.4016547Z", "eventRecordID": "53", "processID": "3348", "threadID": "3476", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update MSRDC-Infrastructure of package Microsoft-Windows-RDC was successfully turned off."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "10", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:27:37.4017405Z", "eventRecordID": "54", "processID": "3348", "threadID": "3476", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update WorkFolders-Client of package Microsoft-Windows-EnterpriseClientSync-Host was successfully turned off."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "10", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:27:37.4017599Z", "eventRecordID": "55", "processID": "3348", "threadID": "3476", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update Printing-Foundation-Features of package Microsoft-Windows-Printing-Foundation was successfully turned off."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "10", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:27:37.4017616Z", "eventRecordID": "56", "processID": "3348", "threadID": "3476", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update Printing-Foundation-InternetPrinting-Client of package Microsoft-Windows-Printing-Foundation was successfully turned off."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "10", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-04-12T07:27:37.4020972Z", "eventRecordID": "57", "processID": "3348", "threadID": "3476", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update Internet-Explorer-Optional-amd64 of package Internet-Explorer-Optional-Package was successfully turned off."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "7", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-11-07T12:09:32.9775189Z", "eventRecordID": "171", "processID": "19712", "threadID": "13896", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn on update Microsoft-Windows-Subsystem-Linux of package Microsoft-Windows-Lxss-Optional. Client id: DISM Package Manager Provider."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "7", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-11-07T12:12:12.8866516Z", "eventRecordID": "173", "processID": "19712", "threadID": "2448", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn on update VirtualMachinePlatform of package Microsoft-Windows-HyperV-OptionalFeature-VirtualMachinePlatform-Disabled. Client id: DISM Package Manager Provider."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "8", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-11-07T13:13:24.2993151Z", "eventRecordID": "175", "processID": "14096", "threadID": "18380", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn off update Microsoft-Windows-Subsystem-Linux of package Microsoft-Windows-Lxss-Optional. Client id: DISM Package Manager Provider."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "7", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-11-07T13:14:00.1081939Z", "eventRecordID": "177", "processID": "14096", "threadID": "18380", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Initiating changes to turn on update Microsoft-Windows-Subsystem-Linux of package Microsoft-Windows-Lxss-Optional. Client id: DISM Package Manager Provider."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "9", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-11-07T21:37:18.5730565Z", "eventRecordID": "179", "processID": "3192", "threadID": "3316", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update Microsoft-Windows-Subsystem-Linux of package Microsoft-Windows-Lxss-Optional was successfully turned on."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "9", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-11-07T21:37:18.7295889Z", "eventRecordID": "180", "processID": "3192", "threadID": "3316", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update VirtualMachinePlatform of package Microsoft-Windows-HyperV-OptionalFeature-VirtualMachinePlatform-Disabled was successfully turned on."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "10", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-11-07T21:37:18.8425286Z", "eventRecordID": "181", "processID": "3192", "threadID": "3316", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update Microsoft-Windows-Subsystem-Linux of package Microsoft-Windows-Lxss-Optional was successfully turned off."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "9", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-11-07T21:37:18.8940136Z", "eventRecordID": "182", "processID": "3192", "threadID": "3316", "channel": "Setup", "computer": "N900B7FFD.kapsch.co.at", "severityValue": "UNKNOWN", "message": "Selectable update Microsoft-Windows-Subsystem-Linux of package Microsoft-Windows-Lxss-Optional was successfully turned on."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "7", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-11-24T09:19:31.5372314Z", "eventRecordID": "188", "processID": "10840", "threadID": "12320", "channel": "Setup", "computer": "N900B7FFD.kbceu.kbcnet.tech", "severityValue": "UNKNOWN", "message": "Initiating changes to turn on update MSRDC-Infrastructure of package Microsoft-Windows-RDC. Client id: DISM Package Manager Provider."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "9", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-11-24T09:19:35.3030104Z", "eventRecordID": "189", "processID": "10840", "threadID": "12320", "channel": "Setup", "computer": "N900B7FFD.kbceu.kbcnet.tech", "severityValue": "UNKNOWN", "message": "Selectable update MSRDC-Infrastructure of package Microsoft-Windows-RDC was successfully turned on."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "7", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2023-02-11T14:39:03.1197165Z", "eventRecordID": "205", "processID": "18216", "threadID": "2932", "channel": "Setup", "computer": "N900B7FFD.kbceu.kbcnet.tech", "severityValue": "UNKNOWN", "message": "Initiating changes to turn on update HypervisorPlatform of package Microsoft-Windows-HyperV-OptionalFeature-HypervisorPlatform-Disabled. Client id: DISM Package Manager Provider."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Servicing", "providerGuid": "{bd12f3b8-fc40-4a61-a307-b7a013a069c1}", "eventID": "9", "version": "0", "level": "0", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2023-02-11T14:39:04.8847024Z", "eventRecordID": "206", "processID": "18216", "threadID": "2932", "channel": "Setup", "computer": "N900B7FFD.kbceu.kbcnet.tech", "severityValue": "UNKNOWN", "message": "Selectable update HypervisorPlatform of package Microsoft-Windows-HyperV-OptionalFeature-HypervisorPlatform-Disabled was successfully turned on."}, "eventdata": {}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id800_4103_4104_defender_critical_features_disabled_powershell(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:50.4833062Z", "eventRecordID": "1161742", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=247\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=18\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.4873233Z", "eventRecordID": "1328809", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 18\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 248\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 18\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 248\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.5132719Z", "eventRecordID": "1328810", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-MpPreference -DisableRealtimeMonitoring $true\n\nScriptBlock ID: f455ad08-4885-470d-8365-0469205fe153\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-MpPreference -DisableRealtimeMonitoring $true", "scriptBlockId": "f455ad08-4885-470d-8365-0469205fe153"}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:50.7801835Z", "eventRecordID": "1161743", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: Set-MpPreference -DisableRealtimeMonitoring $true. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=255\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=19\n\tScriptName=\n\tCommandLine=Set-MpPreference -DisableRealtimeMonitoring $true \n\nDetails: \nCommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:50.7801835Z", "eventRecordID": "1161744", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=259\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=19\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(Out-Default): \"Out-Default\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.7875944Z", "eventRecordID": "1328811", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 19\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 256\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 19\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 256\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.7884332Z", "eventRecordID": "1328812", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Out-Default): \"Out-Default\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 19\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 260\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 19\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 260\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Out-Default): \"Out-Default\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.7949486Z", "eventRecordID": "1328813", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nprompt\n\nScriptBlock ID: 700669ca-cfcd-4306-a228-c206e460acb5\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "prompt", "scriptBlockId": "700669ca-cfcd-4306-a228-c206e460acb5"}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:50.7958101Z", "eventRecordID": "1161745", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line:     Microsoft.PowerShell.Core\\Set-StrictMode -Off\n. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=274\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=21\n\tScriptName=C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n\tCommandLine=    Microsoft.PowerShell.Core\\Set-StrictMode -Off\n \n\nDetails: \nCommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:50.7958101Z", "eventRecordID": "1161746", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=277\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=21\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.7977347Z", "eventRecordID": "1328814", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 21\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 275\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 21\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 275\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.8051637Z", "eventRecordID": "1328815", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 21\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 278\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 21\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 278\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.8812229Z", "eventRecordID": "1328816", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-MpPreference -DisableIOAVProtection $true\n\nScriptBlock ID: df8e876c-abd8-42f1-b7c6-e26e8f74c221\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-MpPreference -DisableIOAVProtection $true", "scriptBlockId": "df8e876c-abd8-42f1-b7c6-e26e8f74c221"}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:50.9520458Z", "eventRecordID": "1161747", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: Set-MpPreference -DisableIOAVProtection $true. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=285\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=22\n\tScriptName=\n\tCommandLine=Set-MpPreference -DisableIOAVProtection $true \n\nDetails: \nCommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:50.9520458Z", "eventRecordID": "1161748", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=289\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=22\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(Out-Default): \"Out-Default\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.9623652Z", "eventRecordID": "1328817", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 22\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 286\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 22\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 286\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.9627706Z", "eventRecordID": "1328818", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Out-Default): \"Out-Default\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 22\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 290\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 22\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 290\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Out-Default): \"Out-Default\""}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:50.9833013Z", "eventRecordID": "1161749", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line:     Microsoft.PowerShell.Core\\Set-StrictMode -Off\n. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=304\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=24\n\tScriptName=C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n\tCommandLine=    Microsoft.PowerShell.Core\\Set-StrictMode -Off\n \n\nDetails: \nCommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:50.9833013Z", "eventRecordID": "1161750", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=307\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=24\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.9867240Z", "eventRecordID": "1328819", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nprompt\n\nScriptBlock ID: db4ba932-ba26-46eb-8246-09ca1ec25ad1\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "prompt", "scriptBlockId": "db4ba932-ba26-46eb-8246-09ca1ec25ad1"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.9896485Z", "eventRecordID": "1328820", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 24\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 305\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 24\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 305\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:50.9994231Z", "eventRecordID": "1328821", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 24\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 308\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 24\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 308\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T09:34:51.0107716Z", "eventRecordID": "1328822", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-MpPreference -DisableBehaviorMonitoring $true\n\nScriptBlock ID: 1738dc77-dbb9-457a-ad3a-f03b03d63a42\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-MpPreference -DisableBehaviorMonitoring $true", "scriptBlockId": "1738dc77-dbb9-457a-ad3a-f03b03d63a42"}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:51.0614285Z", "eventRecordID": "1161751", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: Set-MpPreference -DisableBehaviorMonitoring $true. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=315\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=25\n\tScriptName=\n\tCommandLine=Set-MpPreference -DisableBehaviorMonitoring $true \n\nDetails: \nCommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:51.0614285Z", "eventRecordID": "1161752", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=319\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=25\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(Out-Default): \"Out-Default\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:51.0708444Z", "eventRecordID": "1328823", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 25\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 316\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 25\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 316\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:51.0712190Z", "eventRecordID": "1328824", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Out-Default): \"Out-Default\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 25\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 320\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 25\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 320\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Out-Default): \"Out-Default\""}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:51.0837527Z", "eventRecordID": "1161753", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line:     Microsoft.PowerShell.Core\\Set-StrictMode -Off\n. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=334\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=27\n\tScriptName=C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n\tCommandLine=    Microsoft.PowerShell.Core\\Set-StrictMode -Off\n \n\nDetails: \nCommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T09:34:51.0889693Z", "eventRecordID": "1328825", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nprompt\n\nScriptBlock ID: 5365a941-a82a-44f5-acd8-3d5ccd004688\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "prompt", "scriptBlockId": "5365a941-a82a-44f5-acd8-3d5ccd004688"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:51.0915124Z", "eventRecordID": "1328826", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 27\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 335\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 27\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 335\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:51.0927753Z", "eventRecordID": "1161754", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=337\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=27\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:51.1063062Z", "eventRecordID": "1328827", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 27\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 338\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 27\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 338\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:51.1084294Z", "eventRecordID": "1161755", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: Set-MpPreference -DisableIntrusionPreventionSystem $true. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=345\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=28\n\tScriptName=\n\tCommandLine=Set-MpPreference -DisableIntrusionPreventionSystem $true \n\nDetails: \nCommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:51.1084294Z", "eventRecordID": "1161756", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=349\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=28\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(Out-Default): \"Out-Default\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T09:34:51.1183497Z", "eventRecordID": "1328828", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-MpPreference -DisableIntrusionPreventionSystem $true\n\nScriptBlock ID: 8e52c5f3-5b28-4e67-966c-e0a02af1f69c\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-MpPreference -DisableIntrusionPreventionSystem $true", "scriptBlockId": "8e52c5f3-5b28-4e67-966c-e0a02af1f69c"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:51.1347446Z", "eventRecordID": "1328829", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 28\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 346\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 28\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 346\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:51.1347446Z", "eventRecordID": "1328830", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Out-Default): \"Out-Default\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 28\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 350\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 28\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 350\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Out-Default): \"Out-Default\""}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:51.1394368Z", "eventRecordID": "1161757", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line:     Microsoft.PowerShell.Core\\Set-StrictMode -Off\n. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=364\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=30\n\tScriptName=C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n\tCommandLine=    Microsoft.PowerShell.Core\\Set-StrictMode -Off\n \n\nDetails: \nCommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T09:34:51.1519041Z", "eventRecordID": "1328831", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nprompt\n\nScriptBlock ID: 46111745-5dfb-4c37-b8ae-bffa2dbad4a2\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "prompt", "scriptBlockId": "46111745-5dfb-4c37-b8ae-bffa2dbad4a2"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:51.1550157Z", "eventRecordID": "1328832", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 30\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 365\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 30\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 365\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:52.3271154Z", "eventRecordID": "1161758", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=367\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=30\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:52.3395242Z", "eventRecordID": "1328833", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 30\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 368\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 30\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 368\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T09:34:52.3555304Z", "eventRecordID": "1328834", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-MpPreference -DisableInboundConnectionFiltering $true\n\nScriptBlock ID: 8e60a591-10b7-4636-96f1-1fe818cc1081\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-MpPreference -DisableInboundConnectionFiltering $true", "scriptBlockId": "8e60a591-10b7-4636-96f1-1fe818cc1081"}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:52.4208480Z", "eventRecordID": "1161759", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: Set-MpPreference -DisableInboundConnectionFiltering $true. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=375\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=31\n\tScriptName=\n\tCommandLine=Set-MpPreference -DisableInboundConnectionFiltering $true \n\nDetails: \nCommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:52.4208480Z", "eventRecordID": "1161760", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=379\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=31\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(Out-Default): \"Out-Default\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T09:34:52.4208480Z", "eventRecordID": "1161761", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line:     Microsoft.PowerShell.Core\\Set-StrictMode -Off\n. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=394\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=33\n\tScriptName=C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n\tCommandLine=    Microsoft.PowerShell.Core\\Set-StrictMode -Off\n \n\nDetails: \nCommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:52.4232334Z", "eventRecordID": "1328835", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 31\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 376\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 31\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 376\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:52.4236008Z", "eventRecordID": "1328836", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Out-Default): \"Out-Default\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 31\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 380\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 31\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 380\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Out-Default): \"Out-Default\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T09:34:52.4300334Z", "eventRecordID": "1328837", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nprompt\n\nScriptBlock ID: 03931fa6-8ff8-4a61-9e3d-7c1721ef2b53\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "prompt", "scriptBlockId": "03931fa6-8ff8-4a61-9e3d-7c1721ef2b53"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T09:34:52.4322544Z", "eventRecordID": "1328838", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 33\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 395\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 33\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 395\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id800_4103_4104_defender_default_action_allow_any_powershell(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T10:08:33.3107611Z", "eventRecordID": "1161890", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=756\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=83\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T10:08:33.3141861Z", "eventRecordID": "1329022", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 83\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 757\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 83\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 757\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T10:08:33.3626457Z", "eventRecordID": "1329023", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-MpPreference -HighThreatDefaultAction 6 -Force\n\nScriptBlock ID: 90bf7c71-3dc9-43be-b213-6e653aafbd16\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-MpPreference -HighThreatDefaultAction 6 -Force", "scriptBlockId": "90bf7c71-3dc9-43be-b213-6e653aafbd16"}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T10:08:33.6602335Z", "eventRecordID": "1161891", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: Set-MpPreference -HighThreatDefaultAction 6 -Force. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=764\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=84\n\tScriptName=\n\tCommandLine=Set-MpPreference -HighThreatDefaultAction 6 -Force \n\nDetails: \nCommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"HighThreatDefaultAction\"; value=\"Allow\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T10:08:33.6602335Z", "eventRecordID": "1161892", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=768\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=84\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(Out-Default): \"Out-Default\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T10:08:33.6718995Z", "eventRecordID": "1329024", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"HighThreatDefaultAction\"; value=\"Allow\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 84\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 765\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 84\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 765\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"HighThreatDefaultAction\"; value=\"Allow\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"True\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T10:08:33.6722597Z", "eventRecordID": "1329025", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Out-Default): \"Out-Default\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 84\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 769\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 84\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 769\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Out-Default): \"Out-Default\""}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T10:08:33.6758856Z", "eventRecordID": "1161893", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line:     Microsoft.PowerShell.Core\\Set-StrictMode -Off\n. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=783\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=86\n\tScriptName=C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n\tCommandLine=    Microsoft.PowerShell.Core\\Set-StrictMode -Off\n \n\nDetails: \nCommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T10:08:33.6805873Z", "eventRecordID": "1329026", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nprompt\n\nScriptBlock ID: 52b20e82-8fe7-4c5f-9f0a-0a11a98037cc\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "prompt", "scriptBlockId": "52b20e82-8fe7-4c5f-9f0a-0a11a98037cc"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T10:08:33.6836551Z", "eventRecordID": "1329027", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 86\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 784\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 86\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 784\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id800_4103_4104_defender_exclusion_added_powershell(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T11:14:56.2653664Z", "eventRecordID": "1162128", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=2184\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=156\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T11:14:56.2750874Z", "eventRecordID": "1329308", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 156\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 2185\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 156\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 2185\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T11:14:56.3001594Z", "eventRecordID": "1329309", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-MpPreference -ExclusionPath c:\\document\\virus\\\n\nScriptBlock ID: f5f4c079-094d-4248-acbb-bd8bb5746c99\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-MpPreference -ExclusionPath c:\\document\\virus\\", "scriptBlockId": "f5f4c079-094d-4248-acbb-bd8bb5746c99"}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T11:14:56.4179905Z", "eventRecordID": "1162129", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: Set-MpPreference -ExclusionPath c:\\document\\virus\\. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=2192\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=157\n\tScriptName=\n\tCommandLine=Set-MpPreference -ExclusionPath c:\\document\\virus\\ \n\nDetails: \nCommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"ExclusionPath\"; value=\"c:\\document\\virus\\\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T11:14:56.4179905Z", "eventRecordID": "1162130", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=2196\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=157\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(Out-Default): \"Out-Default\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T11:14:56.4249067Z", "eventRecordID": "1329310", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"ExclusionPath\"; value=\"c:\\document\\virus\\\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 157\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 2193\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 157\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 2193\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"ExclusionPath\"; value=\"c:\\document\\virus\\\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T11:14:56.4253845Z", "eventRecordID": "1329311", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Out-Default): \"Out-Default\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 157\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 2197\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 157\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 2197\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Out-Default): \"Out-Default\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T11:14:56.4324635Z", "eventRecordID": "1329312", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nprompt\n\nScriptBlock ID: 5faf2285-531a-4bf9-b878-91c4ddaf7dd0\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "prompt", "scriptBlockId": "5faf2285-531a-4bf9-b878-91c4ddaf7dd0"}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T11:14:56.4336200Z", "eventRecordID": "1162131", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line:     Microsoft.PowerShell.Core\\Set-StrictMode -Off\n. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=2211\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=159\n\tScriptName=C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n\tCommandLine=    Microsoft.PowerShell.Core\\Set-StrictMode -Off\n \n\nDetails: \nCommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T11:14:56.4355155Z", "eventRecordID": "1329313", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 159\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 2212\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 159\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 2212\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T11:15:06.6367545Z", "eventRecordID": "1162132", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=2214\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=159\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T11:15:06.6511001Z", "eventRecordID": "1329314", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 159\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 2215\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 159\n        Command Name = PSConsoleHostReadLine\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 2215\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(PSConsoleHostReadLine): \"PSConsoleHostReadLine\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T11:15:06.6676906Z", "eventRecordID": "1329315", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-MpPreference -ExclusionExtension '.exe'\n\nScriptBlock ID: a89a7f18-a97c-4272-b7d2-681769defe7c\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-MpPreference -ExclusionExtension '.exe'", "scriptBlockId": "a89a7f18-a97c-4272-b7d2-681769defe7c"}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T11:15:06.7461299Z", "eventRecordID": "1162133", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: Set-MpPreference -ExclusionExtension '.exe'. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=2222\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=160\n\tScriptName=\n\tCommandLine=Set-MpPreference -ExclusionExtension '.exe' \n\nDetails: \nCommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"ExclusionExtension\"; value=\".exe\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T11:15:06.7461299Z", "eventRecordID": "1162134", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: . \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=2226\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=160\n\tScriptName=\n\tCommandLine= \n\nDetails: \nCommandInvocation(Out-Default): \"Out-Default\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T11:15:06.7544675Z", "eventRecordID": "1329316", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"ExclusionExtension\"; value=\".exe\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 160\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 2223\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 160\n        Command Name = Set-MpPreference\n        Command Type = Function\n        Script Name = \n        Command Path = \n        Sequence Number = 2223\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-MpPreference): \"Set-MpPreference\"\nParameterBinding(Set-MpPreference): name=\"ExclusionExtension\"; value=\".exe\"\nParameterBinding(Set-MpPreference): name=\"QuarantinePurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingAdditionalActionTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingCriticalFailureTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ReportingNonCriticalTimeOut\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanAvgCPULoadFactor\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"CheckForSignaturesBeforeRunningScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ScanPurgeItemsAfterDelay\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ScanOnlyIfIdleEnabled\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ThrottleForScheduledScanOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFirstAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureAuGracePeriod\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureDefinitionUpdateFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureDisableUpdateOnStartupWithoutEngine\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SignatureFallbackOrder\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SharedSignaturesPath\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateCatchupInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobUpdateInterval\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"SignatureBlobFileSharesSources\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"MeteredConnectionUpdates\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDatagramProcessing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCpuThrottleOnIdleScans\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableAutoExclusions\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisablePrivacyMode\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"RandomizeScheduleTaskTimes\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"SchedulerRandomizationTime\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"DisableBehaviorMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIntrusionPreventionSystem\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableIOAVProtection\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRealtimeMonitoring\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScriptScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableArchiveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableCatchupQuickScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableEmailScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRemovableDriveScanning\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRestorePoint\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningMappedNetworkDrivesForFullScan\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableScanningNetworkFiles\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"UILockdown\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"Force\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableBlockAtFirstSeen\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"CloudExtendedTimeout\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"EnableLowCpuPriority\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFileHashComputation\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableFullScanOnBatteryPower\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"ProxyPacUrl\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ProxyServer\"; value=\"\"\nParameterBinding(Set-MpPreference): name=\"ForceUseProxyOnly\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableTlsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableHttpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableDnsOverTcpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableSshParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableGradualRelease\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowNetworkProtectionDownLevel\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"AllowDatagramProcessingOnWinServer\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"EnableDnsSinkhole\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableInboundConnectionFiltering\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableRdpParsing\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"DisableNetworkProtectionPerfTelemetry\"; value=\"False\"\nParameterBinding(Set-MpPreference): name=\"TrustLabelProtectionStatus\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"ThrottleLimit\"; value=\"0\"\nParameterBinding(Set-MpPreference): name=\"AsJob\"; value=\"False\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T11:15:06.7550194Z", "eventRecordID": "1329317", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Out-Default): \"Out-Default\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 160\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 2227\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 160\n        Command Name = \n        Command Type = Script\n        Script Name = \n        Command Path = \n        Sequence Number = 2227\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Out-Default): \"Out-Default\""}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "version": "0", "level": "4", "task": "8", "opcode": "0", "keywords": "0x80000000000000", "systemTime": "2021-10-06T11:15:06.7617585Z", "eventRecordID": "1162135", "processID": "0", "threadID": "0", "channel": "Windows PowerShell", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line:     Microsoft.PowerShell.Core\\Set-StrictMode -Off\n. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=2241\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=5.1.19041.1237\n\tHostId=cd8cafb9-7c03-4e5e-9d54-914780550df1\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tEngineVersion=5.1.19041.1237\n\tRunspaceId=d94c9947-fce3-4f7e-9a49-18ff6724f22b\n\tPipelineId=162\n\tScriptName=C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n\tCommandLine=    Microsoft.PowerShell.Core\\Set-StrictMode -Off\n \n\nDetails: \nCommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "2", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-06T11:15:06.7628225Z", "eventRecordID": "1329318", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nprompt\n\nScriptBlock ID: 259a06c7-b72b-47bf-b23b-22741236d2b1\nPath:"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "prompt", "scriptBlockId": "259a06c7-b72b-47bf-b23b-22741236d2b1"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-06T11:15:06.7662145Z", "eventRecordID": "1329319", "processID": "1636", "threadID": "9868", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "win10-02.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 162\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 2242\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 5.1.19041.1237\n        Host ID = cd8cafb9-7c03-4e5e-9d54-914780550df1\n        Host Application = C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n        Engine Version = 5.1.19041.1237\n        Runspace ID = d94c9947-fce3-4f7e-9a49-18ff6724f22b\n        Pipeline ID = 162\n        Command Name = Set-StrictMode\n        Command Type = Cmdlet\n        Script Name = C:\\Program Files\\WindowsPowerShell\\Modules\\PSReadline\\2.0.0\\PSReadLine.psm1\n        Command Path = \n        Sequence Number = 2242\n        User = OFFSEC\\admmig\n        Connected User = \n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Set-StrictMode): \"Set-StrictMode\"\nParameterBinding(Set-StrictMode): name=\"Off\"; value=\"True\""}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")
