import unittest

from internal.logtest import LogtestStatus, send_multiple_logs  # type: ignore


class TestTa0008LateralMovementT1021006WindowsRemoteManagement(unittest.TestCase):

    def test_id4656_ws_management_listener_enumeration(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:25.3232236Z", "eventRecordID": "7068010", "processID": "4", "threadID": "4344", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x1D42387\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x668\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x1d42387", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x668", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:02.863605900Z", "eventRecordID": "1955556", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x15861AC5\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x15861ac5", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:03.030542600Z", "eventRecordID": "1955567", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x15862803\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x15862803", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:25.419006100Z", "eventRecordID": "256171081", "processID": "4", "threadID": "5832", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBBDE9412\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbbde9412", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:04.345650700Z", "eventRecordID": "1955573", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x15863B32\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x15863b32", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:04.345650700Z", "eventRecordID": "1955577", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x15863B3F\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x15863b3f", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:04.345650700Z", "eventRecordID": "1955581", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x15863B4E\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x15863b4e", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:04.439402100Z", "eventRecordID": "1955586", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x158648E5\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x158648e5", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:04.798806300Z", "eventRecordID": "1955594", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x15866309\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x15866309", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:04.814429600Z", "eventRecordID": "1955598", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x15866327\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x15866327", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:04.814429600Z", "eventRecordID": "1955602", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x15866337\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x15866337", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:04.814429600Z", "eventRecordID": "1955606", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x15866344\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x15866344", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:04.861278300Z", "eventRecordID": "1955614", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x158664F8\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x158664f8", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:04.861278300Z", "eventRecordID": "1955618", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x15866505\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x15866505", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:05.909273800Z", "eventRecordID": "1955622", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x158665D5\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x370\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x158665d5", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x370", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:29.2669202Z", "eventRecordID": "7068135", "processID": "4", "threadID": "6164", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tWIN10-02$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tFile\n\tObject Name:\t\tC:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Cache\\{25FC59D8-3DE9-41EA-A4D6-AE68D5131ECC}_1914620234177861815\n\tHandle ID:\t\t0x1ed8\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0xb9c\n\tProcess Name:\t\tC:\\Program Files\\Windows Defender Advanced Threat Protection\\MsSense.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tWriteData (or AddFile)\n\t\t\t\tAppendData (or AddSubdirectory or CreatePipeInstance)\n\t\t\t\tReadEA\n\t\t\t\tWriteEA\n\t\t\t\tReadAttributes\n\t\t\t\tWriteAttributes\n\t\t\t\t\n\tAccess Reasons:\t\tDELETE:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tREAD_CONTROL:\tGranted by Ownership\n\t\t\t\tSYNCHRONIZE:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tReadData (or ListDirectory):\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tWriteData (or AddFile):\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tAppendData (or AddSubdirectory or CreatePipeInstance):\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tReadEA:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tWriteEA:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tReadAttributes:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tWriteAttributes:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\t\n\tAccess Mask:\t\t0x13019F\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "WIN10-02$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "objectType": "File", "objectName": "C:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Cache\\{25FC59D8-3DE9-41EA-A4D6-AE68D5131ECC}_1914620234177861815", "handleId": "0x1ed8", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4417\n\t\t\t\t%%4418\n\t\t\t\t%%4419\n\t\t\t\t%%4420\n\t\t\t\t%%4423\n\t\t\t\t%%4424", "accessReason": "%%1537:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%1538:\t%%1804\n\t\t\t\t%%1541:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4416:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4417:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4418:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4419:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4420:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4423:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4424:\t%%1801\tD:(A;ID;FA;;;SY)", "accessMask": "0x13019f", "restrictedSidCount": "0", "processId": "0xb9c", "processName": "C:\\Program Files\\Windows Defender Advanced Threat Protection\\MsSense.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12800", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:29.2674614Z", "eventRecordID": "7068138", "processID": "4", "threadID": "6164", "channel": "Security", "computer": "win10-02.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tWIN10-02$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tFile\n\tObject Name:\t\tC:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Cache\\{25FC59D8-3DE9-41EA-A4D6-AE68D5131ECC}_1914620234177861815\n\tHandle ID:\t\t0x1ed8\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0xb9c\n\tProcess Name:\t\tC:\\Program Files\\Windows Defender Advanced Threat Protection\\MsSense.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tWriteData (or AddFile)\n\t\t\t\tAppendData (or AddSubdirectory or CreatePipeInstance)\n\t\t\t\tReadEA\n\t\t\t\tWriteEA\n\t\t\t\tReadAttributes\n\t\t\t\tWriteAttributes\n\t\t\t\t\n\tAccess Reasons:\t\tDELETE:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tREAD_CONTROL:\tGranted by Ownership\n\t\t\t\tSYNCHRONIZE:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tReadData (or ListDirectory):\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tWriteData (or AddFile):\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tAppendData (or AddSubdirectory or CreatePipeInstance):\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tReadEA:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tWriteEA:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tReadAttributes:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\tWriteAttributes:\tGranted by\tD:(A;ID;FA;;;SY)\n\t\t\t\t\n\tAccess Mask:\t\t0x13019F\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "WIN10-02$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "objectType": "File", "objectName": "C:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Cache\\{25FC59D8-3DE9-41EA-A4D6-AE68D5131ECC}_1914620234177861815", "handleId": "0x1ed8", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4417\n\t\t\t\t%%4418\n\t\t\t\t%%4419\n\t\t\t\t%%4420\n\t\t\t\t%%4423\n\t\t\t\t%%4424", "accessReason": "%%1537:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%1538:\t%%1804\n\t\t\t\t%%1541:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4416:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4417:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4418:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4419:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4420:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4423:\t%%1801\tD:(A;ID;FA;;;SY)\n\t\t\t\t%%4424:\t%%1801\tD:(A;ID;FA;;;SY)", "accessMask": "0x13019f", "restrictedSidCount": "0", "processId": "0xb9c", "processName": "C:\\Program Files\\Windows Defender Advanced Threat Protection\\MsSense.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:32.571709900Z", "eventRecordID": "256171130", "processID": "4", "threadID": "3056", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBBE7FDA3\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbbe7fda3", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:38.159477600Z", "eventRecordID": "256171147", "processID": "4", "threadID": "5560", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBBEFDF9F\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbbefdf9f", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:38.160362100Z", "eventRecordID": "256171152", "processID": "4", "threadID": "5560", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBBEFDFB8\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbbefdfb8", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:38.358800200Z", "eventRecordID": "256171157", "processID": "4", "threadID": "5560", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBBF02B30\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbbf02b30", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:39.201436800Z", "eventRecordID": "256171164", "processID": "4", "threadID": "3056", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBBF1276A\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbbf1276a", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:52.488313700Z", "eventRecordID": "256171180", "processID": "4", "threadID": "3056", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBC0576B2\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbc0576b2", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:52.698137600Z", "eventRecordID": "256171185", "processID": "4", "threadID": "3056", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBC05C9D6\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbc05c9d6", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:52.721828000Z", "eventRecordID": "256171190", "processID": "4", "threadID": "3056", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBC05CEA1\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbc05cea1", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:52.901132200Z", "eventRecordID": "256171199", "processID": "4", "threadID": "3056", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBC0615DC\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbc0615dc", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:52.901218900Z", "eventRecordID": "256171200", "processID": "4", "threadID": "3056", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBC0615E3\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbc0615e3", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:54.303394900Z", "eventRecordID": "256171209", "processID": "4", "threadID": "5628", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBC08421D\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbc08421d", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-A5BA-3E3B0328C30D}", "eventID": "4656", "version": "1", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-01-26T09:16:58.713336100Z", "eventRecordID": "256171217", "processID": "4", "threadID": "3056", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xDBC0EC1F9\n\nObject:\n\tObject Server:\t\tWS-Management Listener\n\tObject Type:\t\tUnknown\n\tObject Name:\t\tUnknown\n\tHandle ID:\t\t0x0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x420\n\tProcess Name:\t\tC:\\Windows\\System32\\svchost.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tUnknown specific access (bit 0)\n\t\t\t\tUnknown specific access (bit 1)\n\t\t\t\tUnknown specific access (bit 2)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x7\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xdbc0ec1f9", "objectServer": "WS-Management Listener", "objectType": "Unknown", "objectName": "Unknown", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1552\n\t\t\t\t%%1553\n\t\t\t\t%%1554", "accessMask": "0x7", "restrictedSidCount": "0", "processId": "0x420", "processName": "C:\\Windows\\System32\\svchost.exe"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")
