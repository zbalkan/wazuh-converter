import unittest

from internal.logtest import LogtestStatus, send_multiple_logs  # type: ignore


class TestTa0006CredentialAccessT1003CredentialDumping(unittest.TestCase):

    def test_id1_12_13_wdigest_authentication_activation(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "1", "version": "5", "level": "4", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-01-26T09:20:49.1010819Z", "eventRecordID": "57278", "processID": "1048", "threadID": "1684", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "Process Create:\nRuleName: technique_id=T1112,technique_name=Modify Registry\nUtcTime: 2022-01-26 09:20:49.101\nProcessGuid: {a57649d1-1271-61f1-315a-8e1500000000}\nProcessId: 1524\nImage: C:\\Windows\\System32\\reg.exe\nFileVersion: 6.3.9600.17415 (winblue_r4.141028-1500)\nDescription: Registry Console Tool\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: reg.exe\nCommandLine: reg  add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1\nCurrentDirectory: C:\\Windows\\system32\\\nUser: OFFSEC\\admmig\nLogonGuid: {a57649d1-1238-61f1-b2d8-861500000000}\nLogonId: 0x1586D8B2\nTerminalSessionId: 2\nIntegrityLevel: High\nHashes: SHA1=0873F40DE395DE017495ED5C7E693AFB55E9F867,MD5=A3F446F1E2B8C6ECE56F608FB32B8DC6,SHA256=849F54DC526EA18D59ABAF4904CB11BC15B982D2952B971F2E1B6FBF8C974B39,IMPHASH=A069A88BBB8016324D7EC0A0EEC459EB\nParentProcessGuid: {a57649d1-124e-61f1-503d-8e1500000000}\nParentProcessId: 4924\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\" \nParentUser: %23"}, "eventdata": {"ruleName": "technique_id=T1112,technique_name=Modify Registry", "utcTime": "2022-01-26 09:20:49.101", "processGuid": "{a57649d1-1271-61f1-315a-8e1500000000}", "processId": "1524", "image": "C:\\Windows\\System32\\reg.exe", "fileVersion": "6.3.9600.17415 (winblue_r4.141028-1500)", "description": "Registry Console Tool", "product": "Microsoft\u00ae Windows\u00ae Operating System", "company": "Microsoft Corporation", "originalFileName": "reg.exe", "commandLine": "reg  add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1", "currentDirectory": "C:\\Windows\\system32\\", "user": "OFFSEC\\admmig", "logonGuid": "{a57649d1-1238-61f1-b2d8-861500000000}", "logonId": "0x1586d8b2", "terminalSessionId": "2", "integrityLevel": "High", "hashes": "SHA1=0873F40DE395DE017495ED5C7E693AFB55E9F867,MD5=A3F446F1E2B8C6ECE56F608FB32B8DC6,SHA256=849F54DC526EA18D59ABAF4904CB11BC15B982D2952B971F2E1B6FBF8C974B39,IMPHASH=A069A88BBB8016324D7EC0A0EEC459EB", "parentProcessGuid": "{a57649d1-124e-61f1-503d-8e1500000000}", "parentProcessId": "4924", "parentImage": "C:\\Windows\\System32\\cmd.exe", "parentCommandLine": "\"C:\\Windows\\system32\\cmd.exe\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "12", "version": "2", "level": "4", "task": "12", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-01-26T09:20:49.1010819Z", "eventRecordID": "57279", "processID": "1048", "threadID": "1684", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "Registry object added or deleted:\nRuleName: technique_id=T1003,technique_name=Credential Dumping\nEventType: CreateKey\nUtcTime: 2022-01-26 09:20:49.101\nProcessGuid: {a57649d1-1271-61f1-315a-8e1500000000}\nProcessId: 1524\nImage: C:\\Windows\\system32\\reg.exe\nTargetObject: HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\WDigest\nUser: %8"}, "eventdata": {"ruleName": "technique_id=T1003,technique_name=Credential Dumping", "eventType": "CreateKey", "utcTime": "2022-01-26 09:20:49.101", "processGuid": "{a57649d1-1271-61f1-315a-8e1500000000}", "processId": "1524", "image": "C:\\Windows\\system32\\reg.exe", "targetObject": "HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\WDigest"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "13", "version": "2", "level": "4", "task": "13", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2022-01-26T09:20:52.8113839Z", "eventRecordID": "57280", "processID": "1048", "threadID": "1684", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "Registry value set:\nRuleName: technique_id=T1003,technique_name=Credential Dumping\nEventType: SetValue\nUtcTime: 2022-01-26 09:20:52.811\nProcessGuid: {a57649d1-1271-61f1-315a-8e1500000000}\nProcessId: 1524\nImage: C:\\Windows\\system32\\reg.exe\nTargetObject: HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\WDigest\\UseLogonCredential\nDetails: DWORD (0x00000001)\nUser: %9"}, "eventdata": {"ruleName": "technique_id=T1003,technique_name=Credential Dumping", "eventType": "SetValue", "utcTime": "2022-01-26 09:20:52.811", "processGuid": "{a57649d1-1271-61f1-315a-8e1500000000}", "processId": "1524", "image": "C:\\Windows\\system32\\reg.exe", "targetObject": "HKLM\\System\\CurrentControlSet\\Control\\SecurityProviders\\WDigest\\UseLogonCredential", "details": "DWORD (0x00000001)"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id1_lsass_dump_with_lsassy_sysmon(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "18", "version": "1", "level": "4", "task": "18", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:18:43.3263800Z", "eventRecordID": "71666", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Pipe Connected:\nRuleName: technique_id=T1049,technique_name=System Network Connections Discovery\nEventType: ConnectPipe\nUtcTime: 2021-10-20 14:18:43.326\nProcessGuid: {7cf65fc7-665f-6165-2000-000000001200}\nProcessId: 1640\nPipeName: \\srvsvc\nImage: C:\\Windows\\system32\\wbem\\wmiprvse.exe\nUser: %8"}, "eventdata": {"ruleName": "technique_id=T1049,technique_name=System Network Connections Discovery", "eventType": "ConnectPipe", "utcTime": "2021-10-20 14:18:43.326", "processGuid": "{7cf65fc7-665f-6165-2000-000000001200}", "processId": "1640", "pipeName": "\\srvsvc", "image": "C:\\Windows\\system32\\wbem\\wmiprvse.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "18", "version": "1", "level": "4", "task": "18", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:18:43.3263800Z", "eventRecordID": "71667", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Pipe Connected:\nRuleName: technique_id=T1049,technique_name=System Network Connections Discovery\nEventType: ConnectPipe\nUtcTime: 2021-10-20 14:18:43.326\nProcessGuid: {7cf65fc7-665f-6165-2000-000000001200}\nProcessId: 1640\nPipeName: \\srvsvc\nImage: C:\\Windows\\system32\\wbem\\wmiprvse.exe\nUser: %8"}, "eventdata": {"ruleName": "technique_id=T1049,technique_name=System Network Connections Discovery", "eventType": "ConnectPipe", "utcTime": "2021-10-20 14:18:43.326", "processGuid": "{7cf65fc7-665f-6165-2000-000000001200}", "processId": "1640", "pipeName": "\\srvsvc", "image": "C:\\Windows\\system32\\wbem\\wmiprvse.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "1", "version": "5", "level": "4", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:18:55.8085877Z", "eventRecordID": "71668", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Process Create:\nRuleName: technique_id=T1086,technique_name=PowerShell\nUtcTime: 2021-10-20 14:18:55.808\nProcessGuid: {7cf65fc7-254f-6170-9402-000000001200}\nProcessId: 2508\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nFileVersion: 6.3.9600.17415 (winblue_r4.141028-1500)\nDescription: Windows PowerShell\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: PowerShell.EXE\nCommandLine: powershell.exe -NoP -C \"C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\76nivOxA.dmp full;Wait-Process -Id (Get-Process rundll32).id\"\nCurrentDirectory: C:\\\nUser: OFFSEC\\admmig\nLogonGuid: {7cf65fc7-254f-6170-c8ee-690200000000}\nLogonId: 0x269EEC8\nTerminalSessionId: 0\nIntegrityLevel: High\nHashes: SHA1=9F1E24917EF96BBB339F4E2A226ACAFD1009F47B,MD5=C031E215B8B08C752BF362F6D4C5D3AD,SHA256=840E1F9DC5A29BEBF01626822D7390251E9CF05BB3560BA7B68BDB8A41CF08E3,IMPHASH=099B747A4A31983374E54912D4BB7C44\nParentProcessGuid: {7cf65fc7-665f-6165-2000-000000001200}\nParentProcessId: 1640\nParentImage: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\nParentCommandLine: C:\\Windows\\system32\\wbem\\wmiprvse.exe -secured -Embedding\nParentUser: %23"}, "eventdata": {"ruleName": "technique_id=T1086,technique_name=PowerShell", "utcTime": "2021-10-20 14:18:55.808", "processGuid": "{7cf65fc7-254f-6170-9402-000000001200}", "processId": "2508", "image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "fileVersion": "6.3.9600.17415 (winblue_r4.141028-1500)", "description": "Windows PowerShell", "product": "Microsoft\u00ae Windows\u00ae Operating System", "company": "Microsoft Corporation", "originalFileName": "PowerShell.EXE", "commandLine": "powershell.exe -NoP -C \"C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\76nivOxA.dmp full;Wait-Process -Id (Get-Process rundll32).id\"", "currentDirectory": "C:\\", "user": "OFFSEC\\admmig", "logonGuid": "{7cf65fc7-254f-6170-c8ee-690200000000}", "logonId": "0x269eec8", "terminalSessionId": "0", "integrityLevel": "High", "hashes": "SHA1=9F1E24917EF96BBB339F4E2A226ACAFD1009F47B,MD5=C031E215B8B08C752BF362F6D4C5D3AD,SHA256=840E1F9DC5A29BEBF01626822D7390251E9CF05BB3560BA7B68BDB8A41CF08E3,IMPHASH=099B747A4A31983374E54912D4BB7C44", "parentProcessGuid": "{7cf65fc7-665f-6165-2000-000000001200}", "parentProcessId": "1640", "parentImage": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe", "parentCommandLine": "C:\\Windows\\system32\\wbem\\wmiprvse.exe -secured -Embedding"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "18", "version": "1", "level": "4", "task": "18", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:18:55.8554570Z", "eventRecordID": "71669", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Pipe Connected:\nRuleName: technique_id=T1049,technique_name=System Network Connections Discovery\nEventType: ConnectPipe\nUtcTime: 2021-10-20 14:18:55.855\nProcessGuid: {7cf65fc7-254f-6170-9402-000000001200}\nProcessId: 2508\nPipeName: \\srvsvc\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nUser: %8"}, "eventdata": {"ruleName": "technique_id=T1049,technique_name=System Network Connections Discovery", "eventType": "ConnectPipe", "utcTime": "2021-10-20 14:18:55.855", "processGuid": "{7cf65fc7-254f-6170-9402-000000001200}", "processId": "2508", "pipeName": "\\srvsvc", "image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "7", "version": "3", "level": "4", "task": "7", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:18:55.8710796Z", "eventRecordID": "71670", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Image loaded:\nRuleName: technique_id=T1086,technique_name=PowerShell\nUtcTime: 2021-10-20 14:18:55.871\nProcessGuid: {7cf65fc7-254f-6170-9402-000000001200}\nProcessId: 2508\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nImageLoaded: C:\\Windows\\assembly\\NativeImages_v4.0.30319_64\\System.Manaa57fc8cc#\\3e50931f5376ebab490b124f3f46dd45\\System.Management.Automation.ni.dll\nFileVersion: 6.3.9600.19170\nDescription: System.Management.Automation\nProduct: Microsoft (R) Windows (R) Operating System\nCompany: Microsoft Corporation\nOriginalFileName: System.Management.Automation.dll\nHashes: SHA1=BFDFC46117000B652897F1DE8084FBB9EAA66384,MD5=6EF679145F15A8E54FBF9B23A25A6F21,SHA256=240674945FF5175A14E5DF6DEB2AECD04231911DE9103CA34F6D327C4FF86732,IMPHASH=00000000000000000000000000000000\nSigned: false\nSignature: -\nSignatureStatus: Unavailable\nUser: %16"}, "eventdata": {"ruleName": "technique_id=T1086,technique_name=PowerShell", "utcTime": "2021-10-20 14:18:55.871", "processGuid": "{7cf65fc7-254f-6170-9402-000000001200}", "processId": "2508", "image": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "imageLoaded": "C:\\Windows\\assembly\\NativeImages_v4.0.30319_64\\System.Manaa57fc8cc#\\3e50931f5376ebab490b124f3f46dd45\\System.Management.Automation.ni.dll", "fileVersion": "6.3.9600.19170", "description": "System.Management.Automation", "product": "Microsoft (R) Windows (R) Operating System", "company": "Microsoft Corporation", "originalFileName": "System.Management.Automation.dll", "hashes": "SHA1=BFDFC46117000B652897F1DE8084FBB9EAA66384,MD5=6EF679145F15A8E54FBF9B23A25A6F21,SHA256=240674945FF5175A14E5DF6DEB2AECD04231911DE9103CA34F6D327C4FF86732,IMPHASH=00000000000000000000000000000000", "signed": "false", "signatureStatus": "Unavailable"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "1", "version": "5", "level": "4", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:18:56.0898390Z", "eventRecordID": "71671", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Process Create:\nRuleName: technique_id=T1086,technique_name=PowerShell\nUtcTime: 2021-10-20 14:18:56.089\nProcessGuid: {7cf65fc7-2550-6170-9602-000000001200}\nProcessId: 2860\nImage: C:\\Windows\\System32\\rundll32.exe\nFileVersion: 6.3.9600.17415 (winblue_r4.141028-1500)\nDescription: Windows host process (Rundll32)\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: RUNDLL32.EXE\nCommandLine: \"C:\\Windows\\System32\\rundll32.exe\"  C:\\Windows\\System32\\comsvcs.dll MiniDump 512 \\Windows\\Temp\\76nivOxA.dmp full\nCurrentDirectory: C:\\\nUser: OFFSEC\\admmig\nLogonGuid: {7cf65fc7-254f-6170-c8ee-690200000000}\nLogonId: 0x269EEC8\nTerminalSessionId: 0\nIntegrityLevel: High\nHashes: SHA1=D4AC232D507769FFD004439C15302916A40D9831,MD5=6C308D32AFA41D26CE2A0EA8F7B79565,SHA256=5CC2C563D89257964C4B446F54AFE1E57BBEE49315A9FC001FF5A6BCB6650393,IMPHASH=156B2AC675B1B9202AF35C643105610C\nParentProcessGuid: {7cf65fc7-254f-6170-9402-000000001200}\nParentProcessId: 2508\nParentImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nParentCommandLine: powershell.exe -NoP -C \"C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\76nivOxA.dmp full;Wait-Process -Id (Get-Process rundll32).id\"\nParentUser: %23"}, "eventdata": {"ruleName": "technique_id=T1086,technique_name=PowerShell", "utcTime": "2021-10-20 14:18:56.089", "processGuid": "{7cf65fc7-2550-6170-9602-000000001200}", "processId": "2860", "image": "C:\\Windows\\System32\\rundll32.exe", "fileVersion": "6.3.9600.17415 (winblue_r4.141028-1500)", "description": "Windows host process (Rundll32)", "product": "Microsoft\u00ae Windows\u00ae Operating System", "company": "Microsoft Corporation", "originalFileName": "RUNDLL32.EXE", "commandLine": "\"C:\\Windows\\System32\\rundll32.exe\"  C:\\Windows\\System32\\comsvcs.dll MiniDump 512 \\Windows\\Temp\\76nivOxA.dmp full", "currentDirectory": "C:\\", "user": "OFFSEC\\admmig", "logonGuid": "{7cf65fc7-254f-6170-c8ee-690200000000}", "logonId": "0x269eec8", "terminalSessionId": "0", "integrityLevel": "High", "hashes": "SHA1=D4AC232D507769FFD004439C15302916A40D9831,MD5=6C308D32AFA41D26CE2A0EA8F7B79565,SHA256=5CC2C563D89257964C4B446F54AFE1E57BBEE49315A9FC001FF5A6BCB6650393,IMPHASH=156B2AC675B1B9202AF35C643105610C", "parentProcessGuid": "{7cf65fc7-254f-6170-9402-000000001200}", "parentProcessId": "2508", "parentImage": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "parentCommandLine": "powershell.exe -NoP -C \"C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\76nivOxA.dmp full;Wait-Process -Id (Get-Process rundll32).id\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "11", "version": "2", "level": "4", "task": "11", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:18:56.1054570Z", "eventRecordID": "71672", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "File created:\nRuleName: -\nUtcTime: 2021-10-20 14:18:56.105\nProcessGuid: {7cf65fc7-2550-6170-9602-000000001200}\nProcessId: 2860\nImage: C:\\Windows\\System32\\rundll32.exe\nTargetFilename: C:\\Windows\\Temp\\76nivOxA.dmp\nCreationUtcTime: 2021-10-20 14:18:56.105\nUser: %8"}, "eventdata": {"utcTime": "2021-10-20 14:18:56.105", "processGuid": "{7cf65fc7-2550-6170-9602-000000001200}", "processId": "2860", "image": "C:\\Windows\\System32\\rundll32.exe", "targetFilename": "C:\\Windows\\Temp\\76nivOxA.dmp", "creationUtcTime": "2021-10-20 14:18:56.105"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "10", "version": "3", "level": "4", "task": "10", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:18:56.1054570Z", "eventRecordID": "71673", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Process accessed:\nRuleName: -\nUtcTime: 2021-10-20 14:18:56.105\nSourceProcessGUID: {7cf65fc7-2550-6170-9602-000000001200}\nSourceProcessId: 2860\nSourceThreadId: 544\nSourceImage: C:\\Windows\\System32\\rundll32.exe\nTargetProcessGUID: {7cf65fc7-6649-6165-0b00-000000001200}\nTargetProcessId: 512\nTargetImage: C:\\Windows\\system32\\lsass.exe\nGrantedAccess: 0x1FFFFF\nCallTrace: C:\\Windows\\SYSTEM32\\ntdll.dll+909ba|C:\\Windows\\SYSTEM32\\ntdll.dll+80498|C:\\Windows\\system32\\KERNEL32.DLL+1c804|C:\\Windows\\system32\\KERNEL32.DLL+1c247|C:\\Windows\\SYSTEM32\\dbghelp.dll+1244d8|C:\\Windows\\SYSTEM32\\dbghelp.dll+11ebd5|C:\\Windows\\SYSTEM32\\dbghelp.dll+118402|C:\\Windows\\SYSTEM32\\dbghelp.dll+1137e2|C:\\Windows\\SYSTEM32\\dbghelp.dll+113c84|C:\\Windows\\System32\\comsvcs.dll+3363a|C:\\Windows\\System32\\rundll32.exe+2709|C:\\Windows\\System32\\rundll32.exe+44c4|C:\\Windows\\system32\\KERNEL32.DLL+13d2|C:\\Windows\\SYSTEM32\\ntdll.dll+154f4\nSourceUser: %12\nTargetUser: %13"}, "eventdata": {"utcTime": "2021-10-20 14:18:56.105", "sourceProcessGUID": "{7cf65fc7-2550-6170-9602-000000001200}", "sourceProcessId": "2860", "sourceThreadId": "544", "sourceImage": "C:\\Windows\\System32\\rundll32.exe", "targetProcessGUID": "{7cf65fc7-6649-6165-0b00-000000001200}", "targetProcessId": "512", "targetImage": "C:\\Windows\\system32\\lsass.exe", "grantedAccess": "0x1fffff", "callTrace": "C:\\Windows\\SYSTEM32\\ntdll.dll+909ba|C:\\Windows\\SYSTEM32\\ntdll.dll+80498|C:\\Windows\\system32\\KERNEL32.DLL+1c804|C:\\Windows\\system32\\KERNEL32.DLL+1c247|C:\\Windows\\SYSTEM32\\dbghelp.dll+1244d8|C:\\Windows\\SYSTEM32\\dbghelp.dll+11ebd5|C:\\Windows\\SYSTEM32\\dbghelp.dll+118402|C:\\Windows\\SYSTEM32\\dbghelp.dll+1137e2|C:\\Windows\\SYSTEM32\\dbghelp.dll+113c84|C:\\Windows\\System32\\comsvcs.dll+3363a|C:\\Windows\\System32\\rundll32.exe+2709|C:\\Windows\\System32\\rundll32.exe+44c4|C:\\Windows\\system32\\KERNEL32.DLL+13d2|C:\\Windows\\SYSTEM32\\ntdll.dll+154f4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "18", "version": "1", "level": "4", "task": "18", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:19:03.3342391Z", "eventRecordID": "71674", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Pipe Connected:\nRuleName: technique_id=T1049,technique_name=System Network Connections Discovery\nEventType: ConnectPipe\nUtcTime: 2021-10-20 14:19:03.334\nProcessGuid: {7cf65fc7-665f-6165-2000-000000001200}\nProcessId: 1640\nPipeName: \\srvsvc\nImage: C:\\Windows\\system32\\wbem\\wmiprvse.exe\nUser: %8"}, "eventdata": {"ruleName": "technique_id=T1049,technique_name=System Network Connections Discovery", "eventType": "ConnectPipe", "utcTime": "2021-10-20 14:19:03.334", "processGuid": "{7cf65fc7-665f-6165-2000-000000001200}", "processId": "1640", "pipeName": "\\srvsvc", "image": "C:\\Windows\\system32\\wbem\\wmiprvse.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "18", "version": "1", "level": "4", "task": "18", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:19:03.3342391Z", "eventRecordID": "71675", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Pipe Connected:\nRuleName: technique_id=T1049,technique_name=System Network Connections Discovery\nEventType: ConnectPipe\nUtcTime: 2021-10-20 14:19:03.334\nProcessGuid: {7cf65fc7-665f-6165-2000-000000001200}\nProcessId: 1640\nPipeName: \\srvsvc\nImage: C:\\Windows\\system32\\wbem\\wmiprvse.exe\nUser: %8"}, "eventdata": {"ruleName": "technique_id=T1049,technique_name=System Network Connections Discovery", "eventType": "ConnectPipe", "utcTime": "2021-10-20 14:19:03.334", "processGuid": "{7cf65fc7-665f-6165-2000-000000001200}", "processId": "1640", "pipeName": "\\srvsvc", "image": "C:\\Windows\\system32\\wbem\\wmiprvse.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "18", "version": "1", "level": "4", "task": "18", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:19:23.3455601Z", "eventRecordID": "71676", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Pipe Connected:\nRuleName: technique_id=T1049,technique_name=System Network Connections Discovery\nEventType: ConnectPipe\nUtcTime: 2021-10-20 14:19:23.345\nProcessGuid: {7cf65fc7-665f-6165-2000-000000001200}\nProcessId: 1640\nPipeName: \\srvsvc\nImage: C:\\Windows\\system32\\wbem\\wmiprvse.exe\nUser: %8"}, "eventdata": {"ruleName": "technique_id=T1049,technique_name=System Network Connections Discovery", "eventType": "ConnectPipe", "utcTime": "2021-10-20 14:19:23.345", "processGuid": "{7cf65fc7-665f-6165-2000-000000001200}", "processId": "1640", "pipeName": "\\srvsvc", "image": "C:\\Windows\\system32\\wbem\\wmiprvse.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "18", "version": "1", "level": "4", "task": "18", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:19:23.3455601Z", "eventRecordID": "71677", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Pipe Connected:\nRuleName: technique_id=T1049,technique_name=System Network Connections Discovery\nEventType: ConnectPipe\nUtcTime: 2021-10-20 14:19:23.345\nProcessGuid: {7cf65fc7-665f-6165-2000-000000001200}\nProcessId: 1640\nPipeName: \\srvsvc\nImage: C:\\Windows\\system32\\wbem\\wmiprvse.exe\nUser: %8"}, "eventdata": {"ruleName": "technique_id=T1049,technique_name=System Network Connections Discovery", "eventType": "ConnectPipe", "utcTime": "2021-10-20 14:19:23.345", "processGuid": "{7cf65fc7-665f-6165-2000-000000001200}", "processId": "1640", "pipeName": "\\srvsvc", "image": "C:\\Windows\\system32\\wbem\\wmiprvse.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "18", "version": "1", "level": "4", "task": "18", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:19:43.3475448Z", "eventRecordID": "71678", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Pipe Connected:\nRuleName: technique_id=T1049,technique_name=System Network Connections Discovery\nEventType: ConnectPipe\nUtcTime: 2021-10-20 14:19:43.347\nProcessGuid: {7cf65fc7-665f-6165-2000-000000001200}\nProcessId: 1640\nPipeName: \\srvsvc\nImage: C:\\Windows\\system32\\wbem\\wmiprvse.exe\nUser: %8"}, "eventdata": {"ruleName": "technique_id=T1049,technique_name=System Network Connections Discovery", "eventType": "ConnectPipe", "utcTime": "2021-10-20 14:19:43.347", "processGuid": "{7cf65fc7-665f-6165-2000-000000001200}", "processId": "1640", "pipeName": "\\srvsvc", "image": "C:\\Windows\\system32\\wbem\\wmiprvse.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "18", "version": "1", "level": "4", "task": "18", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T14:19:43.3475448Z", "eventRecordID": "71679", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Pipe Connected:\nRuleName: technique_id=T1049,technique_name=System Network Connections Discovery\nEventType: ConnectPipe\nUtcTime: 2021-10-20 14:19:43.347\nProcessGuid: {7cf65fc7-665f-6165-2000-000000001200}\nProcessId: 1640\nPipeName: \\srvsvc\nImage: C:\\Windows\\system32\\wbem\\wmiprvse.exe\nUser: %8"}, "eventdata": {"ruleName": "technique_id=T1049,technique_name=System Network Connections Discovery", "eventType": "ConnectPipe", "utcTime": "2021-10-20 14:19:43.347", "processGuid": "{7cf65fc7-665f-6165-2000-000000001200}", "processId": "1640", "pipeName": "\\srvsvc", "image": "C:\\Windows\\system32\\wbem\\wmiprvse.exe"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id10_mimikatz_lsass_process_dump(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "1", "version": "5", "level": "4", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-21T20:40:12.8678222Z", "eventRecordID": "82849", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Process Create:\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\nUtcTime: 2021-10-21 20:40:12.867\nProcessGuid: {7cf65fc7-d02c-6171-1203-000000001200}\nProcessId: 2032\nImage: C:\\TOOLS\\Mimikatzx64\\mimikatz.exe\nFileVersion: 2.2.0.0\nDescription: mimikatz for Windows\nProduct: mimikatz\nCompany: gentilkiwi (Benjamin DELPY)\nOriginalFileName: mimikatz.exe\nCommandLine: mimikatz.exe\nCurrentDirectory: C:\\TOOLS\\Mimikatzx64\\\nUser: OFFSEC\\admmig\nLogonGuid: {7cf65fc7-7abf-616e-5fc6-f40100000000}\nLogonId: 0x1F4C65F\nTerminalSessionId: 2\nIntegrityLevel: High\nHashes: SHA1=D241DF7B9D2EC0B8194751CD5CE153E27CC40FA4,MD5=A3CB3B02A683275F7E0A0F8A9A5C9E07,SHA256=31EB1DE7E840A342FD468E558E5AB627BCB4C542A8FE01AEC4D5BA01D539A0FC,IMPHASH=DBDEA7B557F0E6B5D9E18ABE9CE5220A\nParentProcessGuid: {7cf65fc7-886c-616e-b201-000000001200}\nParentProcessId: 2908\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\" \nParentUser: %23"}, "eventdata": {"ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "utcTime": "2021-10-21 20:40:12.867", "processGuid": "{7cf65fc7-d02c-6171-1203-000000001200}", "processId": "2032", "image": "C:\\TOOLS\\Mimikatzx64\\mimikatz.exe", "fileVersion": "2.2.0.0", "description": "mimikatz for Windows", "product": "mimikatz", "company": "gentilkiwi (Benjamin DELPY)", "originalFileName": "mimikatz.exe", "commandLine": "mimikatz.exe", "currentDirectory": "C:\\TOOLS\\Mimikatzx64\\", "user": "OFFSEC\\admmig", "logonGuid": "{7cf65fc7-7abf-616e-5fc6-f40100000000}", "logonId": "0x1f4c65f", "terminalSessionId": "2", "integrityLevel": "High", "hashes": "SHA1=D241DF7B9D2EC0B8194751CD5CE153E27CC40FA4,MD5=A3CB3B02A683275F7E0A0F8A9A5C9E07,SHA256=31EB1DE7E840A342FD468E558E5AB627BCB4C542A8FE01AEC4D5BA01D539A0FC,IMPHASH=DBDEA7B557F0E6B5D9E18ABE9CE5220A", "parentProcessGuid": "{7cf65fc7-886c-616e-b201-000000001200}", "parentProcessId": "2908", "parentImage": "C:\\Windows\\System32\\cmd.exe", "parentCommandLine": "\"C:\\Windows\\system32\\cmd.exe\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "1", "version": "5", "level": "4", "task": "1", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-21T20:40:43.1204864Z", "eventRecordID": "82852", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Process Create:\nRuleName: technique_id=T1059,technique_name=Command-Line Interface\nUtcTime: 2021-10-21 20:40:43.120\nProcessGuid: {7cf65fc7-d04b-6171-1303-000000001200}\nProcessId: 5040\nImage: C:\\Windows\\System32\\cmd.exe\nFileVersion: 6.3.9600.17415 (winblue_r4.141028-1500)\nDescription: Windows Command Processor\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: Cmd.Exe\nCommandLine: cmd.exe\nCurrentDirectory: C:\\Windows\\system32\\\nUser: NT AUTHORITY\\SYSTEM\nLogonGuid: {7cf65fc7-d04b-6171-a4de-e60200000000}\nLogonId: 0x2E6DEA4\nTerminalSessionId: 2\nIntegrityLevel: System\nHashes: SHA1=7C3D7281E1151FE4127923F4B4C3CD36438E1A12,MD5=F5AE03DE0AD60F5B17B82F2CD68402FE,SHA256=6F88FB88FFB0F1D5465C2826E5B4F523598B1B8378377C8378FFEBC171BAD18B,IMPHASH=77AED1ADAF24B344F08C8AD1432908C3\nParentProcessGuid: {7cf65fc7-d02c-6171-1203-000000001200}\nParentProcessId: 2032\nParentImage: C:\\TOOLS\\Mimikatzx64\\mimikatz.exe\nParentCommandLine: mimikatz.exe\nParentUser: %23"}, "eventdata": {"ruleName": "technique_id=T1059,technique_name=Command-Line Interface", "utcTime": "2021-10-21 20:40:43.120", "processGuid": "{7cf65fc7-d04b-6171-1303-000000001200}", "processId": "5040", "image": "C:\\Windows\\System32\\cmd.exe", "fileVersion": "6.3.9600.17415 (winblue_r4.141028-1500)", "description": "Windows Command Processor", "product": "Microsoft\u00ae Windows\u00ae Operating System", "company": "Microsoft Corporation", "originalFileName": "Cmd.Exe", "commandLine": "cmd.exe", "currentDirectory": "C:\\Windows\\system32\\", "user": "NT AUTHORITY\\SYSTEM", "logonGuid": "{7cf65fc7-d04b-6171-a4de-e60200000000}", "logonId": "0x2e6dea4", "terminalSessionId": "2", "integrityLevel": "System", "hashes": "SHA1=7C3D7281E1151FE4127923F4B4C3CD36438E1A12,MD5=F5AE03DE0AD60F5B17B82F2CD68402FE,SHA256=6F88FB88FFB0F1D5465C2826E5B4F523598B1B8378377C8378FFEBC171BAD18B,IMPHASH=77AED1ADAF24B344F08C8AD1432908C3", "parentProcessGuid": "{7cf65fc7-d02c-6171-1203-000000001200}", "parentProcessId": "2032", "parentImage": "C:\\TOOLS\\Mimikatzx64\\mimikatz.exe", "parentCommandLine": "mimikatz.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "10", "version": "3", "level": "4", "task": "10", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-21T20:40:43.1361125Z", "eventRecordID": "82853", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Process accessed:\nRuleName: -\nUtcTime: 2021-10-21 20:40:43.136\nSourceProcessGUID: {7cf65fc7-d02c-6171-1203-000000001200}\nSourceProcessId: 2032\nSourceThreadId: 4056\nSourceImage: C:\\TOOLS\\Mimikatzx64\\mimikatz.exe\nTargetProcessGUID: {7cf65fc7-6649-6165-0b00-000000001200}\nTargetProcessId: 512\nTargetImage: C:\\Windows\\system32\\lsass.exe\nGrantedAccess: 0x1010\nCallTrace: C:\\Windows\\SYSTEM32\\ntdll.dll+909ba|C:\\Windows\\system32\\KERNELBASE.dll+2d8e|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+bcbda|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+be7bd|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+be650|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+84f28|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+84d60|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+84b2b|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+c39a9|C:\\Windows\\system32\\KERNEL32.DLL+13d2|C:\\Windows\\SYSTEM32\\ntdll.dll+154f4\nSourceUser: %12\nTargetUser: %13"}, "eventdata": {"utcTime": "2021-10-21 20:40:43.136", "sourceProcessGUID": "{7cf65fc7-d02c-6171-1203-000000001200}", "sourceProcessId": "2032", "sourceThreadId": "4056", "sourceImage": "C:\\TOOLS\\Mimikatzx64\\mimikatz.exe", "targetProcessGUID": "{7cf65fc7-6649-6165-0b00-000000001200}", "targetProcessId": "512", "targetImage": "C:\\Windows\\system32\\lsass.exe", "grantedAccess": "0x1010", "callTrace": "C:\\Windows\\SYSTEM32\\ntdll.dll+909ba|C:\\Windows\\system32\\KERNELBASE.dll+2d8e|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+bcbda|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+be7bd|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+be650|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+84f28|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+84d60|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+84b2b|C:\\TOOLS\\Mimikatzx64\\mimikatz.exe+c39a9|C:\\Windows\\system32\\KERNEL32.DLL+13d2|C:\\Windows\\SYSTEM32\\ntdll.dll+154f4"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id11_lsass_credentials_dump_via_task_manager(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "11", "version": "2", "level": "4", "task": "11", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-12-04T21:10:40.7235999Z", "eventRecordID": "48564", "processID": "1048", "threadID": "1684", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "File created:\nRuleName: -\nUtcTime: 2021-12-04 21:10:40.723\nProcessGuid: {a57649d1-d6b1-61ab-a5e4-d70100000000}\nProcessId: 3504\nImage: C:\\Windows\\System32\\Taskmgr.exe\nTargetFilename: C:\\Users\\admmig\\AppData\\Local\\Temp\\lsass (4).DMP\nCreationUtcTime: 2021-12-04 21:10:40.723\nUser: %8"}, "eventdata": {"utcTime": "2021-12-04 21:10:40.723", "processGuid": "{a57649d1-d6b1-61ab-a5e4-d70100000000}", "processId": "3504", "image": "C:\\Windows\\System32\\Taskmgr.exe", "targetFilename": "C:\\Users\\admmig\\AppData\\Local\\Temp\\lsass (4).DMP", "creationUtcTime": "2021-12-04 21:10:40.723"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id11_mimikatz_lsa_ssp_clear_text_password_exfiltration(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Sysmon", "providerGuid": "{5770385f-c22a-43e0-bf4c-06f5698ffbd9}", "eventID": "11", "version": "2", "level": "4", "task": "11", "opcode": "0", "keywords": "0x8000000000000000", "systemTime": "2021-10-20T09:18:07.1010207Z", "eventRecordID": "69810", "processID": "1152", "threadID": "1764", "channel": "Microsoft-Windows-Sysmon/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "File created:\nRuleName: T1003\nUtcTime: 2021-10-20 09:18:07.101\nProcessGuid: {7cf65fc7-6649-6165-0b00-000000001200}\nProcessId: 512\nImage: C:\\Windows\\system32\\lsass.exe\nTargetFilename: C:\\Windows\\System32\\mimilsa.log\nCreationUtcTime: 2021-10-20 09:18:07.101\nUser: %8"}, "eventdata": {"ruleName": "T1003", "utcTime": "2021-10-20 09:18:07.101", "processGuid": "{7cf65fc7-6649-6165-0b00-000000001200}", "processId": "512", "image": "C:\\Windows\\system32\\lsass.exe", "targetFilename": "C:\\Windows\\System32\\mimilsa.log", "creationUtcTime": "2021-10-20 09:18:07.101"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id325_327_ifm_created_esent(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "ESENT", "providerGuid": {"@Name": "ESENT"}, "eventID": "216", "level": "4", "task": "3", "keywords": "0x80000000000000", "systemTime": "2021-06-05T19:36:36.5371439Z", "eventRecordID": "442136", "channel": "Application", "computer": "rootdc1.offsec.lan", "severityValue": "INFORMATION", "message": "lsass (548) A database location change was detected from 'C:\\Windows\\NTDS\\ntds.dit' to '\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy5\\Windows\\NTDS\\ntds.dit'."}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "ESENT", "providerGuid": {"@Name": "ESENT"}, "eventID": "325", "level": "4", "task": "1", "keywords": "0x80000000000000", "systemTime": "2021-06-05T19:36:55.7069608Z", "eventRecordID": "442150", "channel": "Application", "computer": "rootdc1.offsec.lan", "severityValue": "INFORMATION", "message": "NTDS (7148) The database engine created a new database (2, c:\\hacker\\Active Directory\\ntds.dit). (Time=0 seconds) \n \nAdditional Data: %9 \n \nInternal Timing Sequence: %7"}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "ESENT", "providerGuid": {"@Name": "ESENT"}, "eventID": "327", "level": "4", "task": "1", "keywords": "0x80000000000000", "systemTime": "2021-06-05T19:36:58.9110380Z", "eventRecordID": "442151", "channel": "Application", "computer": "rootdc1.offsec.lan", "severityValue": "INFORMATION", "message": "NTDS (7148) The database engine detached a database (2, c:\\hacker\\Active Directory\\ntds.dit). (Time=0 seconds) \n \nRevived Cache: 0 0 \nAdditional Data: %9 \n \nInternal Timing Sequence: %7"}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "ESENT", "providerGuid": {"@Name": "ESENT"}, "eventID": "327", "level": "4", "task": "1", "keywords": "0x80000000000000", "systemTime": "2021-06-05T19:36:58.9266512Z", "eventRecordID": "442152", "channel": "Application", "computer": "rootdc1.offsec.lan", "severityValue": "INFORMATION", "message": "NTDS (7148) The database engine detached a database (1, C:\\$SNAP_202106051936_VOLUMEC$\\Windows\\NTDS\\ntds.dit). (Time=0 seconds) \n \nRevived Cache: 0 0 \nAdditional Data: %9 \n \nInternal Timing Sequence: %7"}, "eventdata": {}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4656_5145_4674_impacket_secret_dump_via_smb(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Eventlog", "providerGuid": "{fc65ddd8-d6ef-4962-83d5-6e5cfe9ce148}", "eventID": "1102", "version": "0", "level": "4", "task": "104", "opcode": "0", "keywords": "0x4020000000000000", "systemTime": "2021-04-22T09:00:09.9595536Z", "eventRecordID": "435270", "processID": "704", "threadID": "2740", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "INFORMATION", "message": "The audit log was cleared.\nSubject:\n\tSecurity ID:\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\tadmmig\n\tDomain Name:\tOFFSEC\n\tLogon ID:\t0x7B747"}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4964", "version": "0", "level": "0", "task": "12548", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:10.0265356Z", "eventRecordID": "435271", "processID": "480", "threadID": "2208", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Special groups have been assigned to a new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-19\n\tAccount Name:\t\tLOCAL SERVICE\n\tAccount Domain:\t\tNT AUTHORITY\n\tLogon ID:\t\t0x3E5\n\tLogon GUID:\t{00000000-0000-0000-0000-000000000000}\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB3084\n\tLogon GUID:\t{00000000-0000-0000-0000-000000000000}\n\tSpecial Groups Assigned:\t\n\t\t%{S-1-5-21-4230534742-2542757381-3142984815-1613}"}, "eventdata": {"subjectUserSid": "S-1-5-19", "subjectUserName": "LOCAL SERVICE", "subjectDomainName": "NT AUTHORITY", "subjectLogonId": "0x3e5", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0xb3084", "targetLogonGuid": "{00000000-0000-0000-0000-000000000000}", "sidList": "%{S-1-5-21-4230534742-2542757381-3142984815-1613}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4672", "version": "0", "level": "0", "task": "12548", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:10.0265356Z", "eventRecordID": "435272", "processID": "480", "threadID": "2208", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Special privileges assigned to new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB3084\n\nPrivileges:\t\tSeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb3084", "privilegeList": "SeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "1", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:10.0265356Z", "eventRecordID": "435273", "processID": "480", "threadID": "2208", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Type:\t\t\t3\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB3084\n\tLogon GUID:\t\t{3ca372f9-20fd-3bdd-b523-1e8ecfd688ef}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t60285\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0xb3084", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{3ca372f9-20fd-3bdd-b523-1e8ecfd688ef}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "60285", "impersonationLevel": "%%1833"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4964", "version": "0", "level": "0", "task": "12548", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:11.1186883Z", "eventRecordID": "435274", "processID": "480", "threadID": "2208", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Special groups have been assigned to a new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-19\n\tAccount Name:\t\tLOCAL SERVICE\n\tAccount Domain:\t\tNT AUTHORITY\n\tLogon ID:\t\t0x3E5\n\tLogon GUID:\t{00000000-0000-0000-0000-000000000000}\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB314D\n\tLogon GUID:\t{00000000-0000-0000-0000-000000000000}\n\tSpecial Groups Assigned:\t\n\t\t%{S-1-5-21-4230534742-2542757381-3142984815-1613}"}, "eventdata": {"subjectUserSid": "S-1-5-19", "subjectUserName": "LOCAL SERVICE", "subjectDomainName": "NT AUTHORITY", "subjectLogonId": "0x3e5", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0xb314d", "targetLogonGuid": "{00000000-0000-0000-0000-000000000000}", "sidList": "%{S-1-5-21-4230534742-2542757381-3142984815-1613}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4672", "version": "0", "level": "0", "task": "12548", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:11.1186883Z", "eventRecordID": "435275", "processID": "480", "threadID": "2208", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Special privileges assigned to new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB314D\n\nPrivileges:\t\tSeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb314d", "privilegeList": "SeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "1", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:11.1186883Z", "eventRecordID": "435276", "processID": "480", "threadID": "2208", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Type:\t\t\t3\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB314D\n\tLogon GUID:\t\t{3ca372f9-20fd-3bdd-b523-1e8ecfd688ef}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t60232\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0xb314d", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{3ca372f9-20fd-3bdd-b523-1e8ecfd688ef}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "60232", "impersonationLevel": "%%1833"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4964", "version": "0", "level": "0", "task": "12548", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:13.2267279Z", "eventRecordID": "435277", "processID": "480", "threadID": "2208", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Special groups have been assigned to a new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS03VULN$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\tLogon GUID:\t{00000000-0000-0000-0000-000000000000}\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\tLogon GUID:\t{00000000-0000-0000-0000-000000000000}\n\tSpecial Groups Assigned:\t\n\t\t%{S-1-5-21-4230534742-2542757381-3142984815-1613}"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS03VULN$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0xb32cb", "targetLogonGuid": "{00000000-0000-0000-0000-000000000000}", "sidList": "%{S-1-5-21-4230534742-2542757381-3142984815-1613}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4672", "version": "0", "level": "0", "task": "12548", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:13.2267279Z", "eventRecordID": "435278", "processID": "480", "threadID": "2208", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Special privileges assigned to new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nPrivileges:\t\tSeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "privilegeList": "SeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "1", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:13.2267279Z", "eventRecordID": "435279", "processID": "480", "threadID": "2208", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Type:\t\t\t3\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t\n\tSource Network Address:\t10.23.123.11\n\tSource Port:\t\t50078\n\nDetailed Authentication Information:\n\tLogon Process:\t\tNtLmSsp \n\tAuthentication Package:\tNTLM\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\tNTLM V2\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0xb32cb", "logonType": "3", "logonProcessName": "NtLmSsp", "authenticationPackageName": "NTLM", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "lmPackageName": "NTLM V2", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.123.11", "ipPort": "50078", "impersonationLevel": "%%1833"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5140", "version": "1", "level": "0", "task": "12808", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:13.2267279Z", "eventRecordID": "435280", "processID": "4", "threadID": "32", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was accessed.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t50078\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\IPC$\n\tShare Path:\t\t\n\nAccess Request Information:\n\tAccess Mask:\t\t0x1\n\tAccesses:\t\tReadData (or ListDirectory)"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "50078", "shareName": "\\\\*\\IPC$", "accessMask": "0x1", "accessList": "%%4416"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:13.2423690Z", "eventRecordID": "435281", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t50078\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\IPC$\n\tShare Path:\t\t\n\tRelative Target Name:\tsvcctl\n\nAccess Request Information:\n\tAccess Mask:\t\t0x3\n\tAccesses:\t\tReadData (or ListDirectory)\n\t\t\t\tWriteData (or AddFile)\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "50078", "shareName": "\\\\*\\IPC$", "relativeTargetName": "svcctl", "accessMask": "0x3", "accessList": "%%4416\n\t\t\t\t%%4417"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4674", "version": "0", "level": "0", "task": "13056", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:13.2580018Z", "eventRecordID": "435282", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was attempted on a privileged object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nObject:\n\tObject Server:\tSC Manager\n\tObject Type:\tSERVICE OBJECT\n\tObject Name:\tRemoteRegistry\n\tObject Handle:\t0xffffd00103d679f8\n\nProcess Information:\n\tProcess ID:\t0x1d0\n\tProcess Name:\tC:\\Windows\\System32\\services.exe\n\nRequested Operation:\n\tDesired Access:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tQuery service configuration information\n\t\t\t\tSet service configuration information\n\t\t\t\tQuery status of service\n\t\t\t\tEnumerate dependencies of service\n\t\t\t\tStart the service\n\t\t\t\tStop the service\n\t\t\t\tPause or continue the service\n\t\t\t\tQuery information from service\n\t\t\t\tIssue service-specific control commands\n\t\t\t\t\n\tPrivileges:\t\tSeTakeOwnershipPrivilege"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "objectServer": "SC Manager", "objectType": "SERVICE OBJECT", "objectName": "RemoteRegistry", "handleId": "0xffffd00103d679f8", "accessMask": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%7184\n\t\t\t\t%%7185\n\t\t\t\t%%7186\n\t\t\t\t%%7187\n\t\t\t\t%%7188\n\t\t\t\t%%7189\n\t\t\t\t%%7190\n\t\t\t\t%%7191\n\t\t\t\t%%7192", "privilegeList": "SeTakeOwnershipPrivilege", "processId": "0x1d0", "processName": "C:\\Windows\\System32\\services.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:14.2894127Z", "eventRecordID": "435283", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t50078\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\IPC$\n\tShare Path:\t\t\n\tRelative Target Name:\twinreg\n\nAccess Request Information:\n\tAccess Mask:\t\t0x3\n\tAccesses:\t\tReadData (or ListDirectory)\n\t\t\t\tWriteData (or AddFile)\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "50078", "shareName": "\\\\*\\IPC$", "relativeTargetName": "winreg", "accessMask": "0x3", "accessList": "%%4416\n\t\t\t\t%%4417"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5140", "version": "1", "level": "0", "task": "12808", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:14.4215264Z", "eventRecordID": "435284", "processID": "4", "threadID": "1728", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was accessed.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t50078\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\ADMIN$\n\tShare Path:\t\t\\??\\C:\\Windows\n\nAccess Request Information:\n\tAccess Mask:\t\t0x1\n\tAccesses:\t\tReadData (or ListDirectory)"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "50078", "shareName": "\\\\*\\ADMIN$", "shareLocalPath": "\\??\\C:\\Windows", "accessMask": "0x1", "accessList": "%%4416"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:14.4371480Z", "eventRecordID": "435285", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t50078\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\ADMIN$\n\tShare Path:\t\t\\??\\C:\\Windows\n\tRelative Target Name:\tSYSTEM32\\BTeHLZkJ.tmp\n\nAccess Request Information:\n\tAccess Mask:\t\t0x1\n\tAccesses:\t\tReadData (or ListDirectory)\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "50078", "shareName": "\\\\*\\ADMIN$", "shareLocalPath": "\\??\\C:\\Windows", "relativeTargetName": "SYSTEM32\\BTeHLZkJ.tmp", "accessMask": "0x1", "accessList": "%%4416"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:14.7358189Z", "eventRecordID": "435286", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t50078\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\ADMIN$\n\tShare Path:\t\t\\??\\C:\\Windows\n\tRelative Target Name:\tSYSTEM32\\NMdzZfem.tmp\n\nAccess Request Information:\n\tAccess Mask:\t\t0x1\n\tAccesses:\t\tReadData (or ListDirectory)\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "50078", "shareName": "\\\\*\\ADMIN$", "shareLocalPath": "\\??\\C:\\Windows", "relativeTargetName": "SYSTEM32\\NMdzZfem.tmp", "accessMask": "0x1", "accessList": "%%4416"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:16.6917259Z", "eventRecordID": "435287", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t50078\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\IPC$\n\tShare Path:\t\t\n\tRelative Target Name:\tsamr\n\nAccess Request Information:\n\tAccess Mask:\t\t0x3\n\tAccesses:\t\tReadData (or ListDirectory)\n\t\t\t\tWriteData (or AddFile)\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "50078", "shareName": "\\\\*\\IPC$", "relativeTargetName": "samr", "accessMask": "0x3", "accessList": "%%4416\n\t\t\t\t%%4417"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:16.6917259Z", "eventRecordID": "435288", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tObject Type:\t\tSAM_SERVER\n\tObject Name:\t\tSAM\n\tHandle ID:\t\t0x95ac7fa060\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x1e0\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tConnectToServer\n\t\t\t\tShutdownServer\n\t\t\t\tInitializeServer\n\t\t\t\tCreateDomain\n\t\t\t\tEnumerateDomains\n\t\t\t\tLookupDomain\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0xF003F\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x95ac7fa060", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5376\n\t\t\t\t%%5377\n\t\t\t\t%%5378\n\t\t\t\t%%5379\n\t\t\t\t%%5380\n\t\t\t\t%%5381", "accessMask": "0xf003f", "restrictedSidCount": "0", "processId": "0x1e0", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:16.7073535Z", "eventRecordID": "435289", "processID": "4", "threadID": "136", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS03VULN$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x95ac7fa060\n\nProcess Information:\n\tProcess ID:\t\t0x1e0\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS03VULN$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "handleId": "0x95ac7fa060", "processId": "0x1e0", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:16.7246749Z", "eventRecordID": "435290", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t50078\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\ADMIN$\n\tShare Path:\t\t\\??\\C:\\Windows\n\tRelative Target Name:\tSYSTEM32\\BTeHLZkJ.tmp\n\nAccess Request Information:\n\tAccess Mask:\t\t0x10080\n\tAccesses:\t\tDELETE\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "50078", "shareName": "\\\\*\\ADMIN$", "shareLocalPath": "\\??\\C:\\Windows", "relativeTargetName": "SYSTEM32\\BTeHLZkJ.tmp", "accessMask": "0x10080", "accessList": "%%1537\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:16.7246749Z", "eventRecordID": "435291", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xB32CB\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t50078\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\ADMIN$\n\tShare Path:\t\t\\??\\C:\\Windows\n\tRelative Target Name:\tSYSTEM32\\NMdzZfem.tmp\n\nAccess Request Information:\n\tAccess Mask:\t\t0x10080\n\tAccesses:\t\tDELETE\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xb32cb", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "50078", "shareName": "\\\\*\\ADMIN$", "shareLocalPath": "\\??\\C:\\Windows", "relativeTargetName": "SYSTEM32\\NMdzZfem.tmp", "accessMask": "0x10080", "accessList": "%%1537\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:19.8756525Z", "eventRecordID": "435292", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C366\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60051\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\t\\\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100080\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c366", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60051", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "\\", "accessMask": "0x100080", "accessList": "%%1541\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5140", "version": "1", "level": "0", "task": "12808", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:19.8756525Z", "eventRecordID": "435293", "processID": "4", "threadID": "1160", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was accessed.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C366\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60053\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\IPC$\n\tShare Path:\t\t\n\nAccess Request Information:\n\tAccess Mask:\t\t0x1\n\tAccesses:\t\tReadData (or ListDirectory)"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c366", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60053", "shareName": "\\\\*\\IPC$", "accessMask": "0x1", "accessList": "%%4416"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:19.8756525Z", "eventRecordID": "435294", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C366\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60051\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\IPC$\n\tShare Path:\t\t\n\tRelative Target Name:\tsrvsvc\n\nAccess Request Information:\n\tAccess Mask:\t\t0x12019F\n\tAccesses:\t\tREAD_CONTROL\n\t\t\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tWriteData (or AddFile)\n\t\t\t\tAppendData (or AddSubdirectory or CreatePipeInstance)\n\t\t\t\tReadEA\n\t\t\t\tWriteEA\n\t\t\t\tReadAttributes\n\t\t\t\tWriteAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c366", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60051", "shareName": "\\\\*\\IPC$", "relativeTargetName": "srvsvc", "accessMask": "0x12019f", "accessList": "%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4417\n\t\t\t\t%%4418\n\t\t\t\t%%4419\n\t\t\t\t%%4420\n\t\t\t\t%%4423\n\t\t\t\t%%4424"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:19.8912722Z", "eventRecordID": "435295", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C366\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60052\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\IPC$\n\tShare Path:\t\t\n\tRelative Target Name:\tsrvsvc\n\nAccess Request Information:\n\tAccess Mask:\t\t0x12019F\n\tAccesses:\t\tREAD_CONTROL\n\t\t\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tWriteData (or AddFile)\n\t\t\t\tAppendData (or AddSubdirectory or CreatePipeInstance)\n\t\t\t\tReadEA\n\t\t\t\tWriteEA\n\t\t\t\tReadAttributes\n\t\t\t\tWriteAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c366", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60052", "shareName": "\\\\*\\IPC$", "relativeTargetName": "srvsvc", "accessMask": "0x12019f", "accessList": "%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4417\n\t\t\t\t%%4418\n\t\t\t\t%%4419\n\t\t\t\t%%4420\n\t\t\t\t%%4423\n\t\t\t\t%%4424"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:19.8912722Z", "eventRecordID": "435296", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C366\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60053\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\desktop.ini\n\nAccess Request Information:\n\tAccess Mask:\t\t0x120089\n\tAccesses:\t\tREAD_CONTROL\n\t\t\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadEA\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c366", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60053", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\desktop.ini", "accessMask": "0x120089", "accessList": "%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4419\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:19.8912722Z", "eventRecordID": "435297", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C366\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60053\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUSERS\\ADMMIG\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100081\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c366", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60053", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "USERS\\ADMMIG", "accessMask": "0x100081", "accessList": "%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:19.8912722Z", "eventRecordID": "435298", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C366\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60051\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\admmig\\Desktop\\desktop.ini\n\nAccess Request Information:\n\tAccess Mask:\t\t0x120089\n\tAccesses:\t\tREAD_CONTROL\n\t\t\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadEA\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c366", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60051", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\admmig\\Desktop\\desktop.ini", "accessMask": "0x120089", "accessList": "%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4419\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:20.0036858Z", "eventRecordID": "435299", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C366\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60053\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUSERS\\ADMMIG\\DESKTOP\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100081\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c366", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60053", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "USERS\\ADMMIG\\DESKTOP", "accessMask": "0x100081", "accessList": "%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:22.5443943Z", "eventRecordID": "435300", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C49D\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60052\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\admmig\\Desktop\\Impacket secret dump.evtx\n\nAccess Request Information:\n\tAccess Mask:\t\t0x80\n\tAccesses:\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c49d", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60052", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\admmig\\Desktop\\Impacket secret dump.evtx", "accessMask": "0x80", "accessList": "%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:22.5443943Z", "eventRecordID": "435301", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C49D\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60049\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\admmig\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100081\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c49d", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60049", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\admmig", "accessMask": "0x100081", "accessList": "%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:22.5600130Z", "eventRecordID": "435302", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C49D\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60052\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUSERS\\ADMMIG\\DESKTOP\\DESKTOP.INI\n\nAccess Request Information:\n\tAccess Mask:\t\t0x120089\n\tAccesses:\t\tREAD_CONTROL\n\t\t\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadEA\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c49d", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60052", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "USERS\\ADMMIG\\DESKTOP\\DESKTOP.INI", "accessMask": "0x120089", "accessList": "%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4419\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:22.5756556Z", "eventRecordID": "435303", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C49D\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60049\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\admmig\\Desktop\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100080\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c49d", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60049", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\admmig\\Desktop", "accessMask": "0x100080", "accessList": "%%1541\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:22.5912688Z", "eventRecordID": "435304", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C49D\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60053\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\admmig\\Desktop\\Impacket secret dump.evtx\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100080\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c49d", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60053", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\admmig\\Desktop\\Impacket secret dump.evtx", "accessMask": "0x100080", "accessList": "%%1541\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:22.5912688Z", "eventRecordID": "435305", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C49D\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60051\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\admmig\\Desktop\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100080\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c49d", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60051", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\admmig\\Desktop", "accessMask": "0x100080", "accessList": "%%1541\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:22.5912688Z", "eventRecordID": "435306", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C49D\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60049\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\admmig\\Desktop\\Impacket secret dump.evtx\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100080\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c49d", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60049", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\admmig\\Desktop\\Impacket secret dump.evtx", "accessMask": "0x100080", "accessList": "%%1541\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:22.6069104Z", "eventRecordID": "435307", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C49D\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60053\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\admmig\\Desktop\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100081\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c49d", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60053", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\admmig\\Desktop", "accessMask": "0x100081", "accessList": "%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:22.6069104Z", "eventRecordID": "435308", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C49D\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60052\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\admmig\\Desktop\\Impacket secret dump.evtx\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100080\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c49d", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60052", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\admmig\\Desktop\\Impacket secret dump.evtx", "accessMask": "0x100080", "accessList": "%%1541\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:22.6229440Z", "eventRecordID": "435309", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C49D\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60051\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\admmig\\Desktop\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100080\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c49d", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60051", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\admmig\\Desktop", "accessMask": "0x100080", "accessList": "%%1541\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-04-22T09:00:22.6966615Z", "eventRecordID": "435310", "processID": "480", "threadID": "488", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x6C366\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t60052\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tUsers\\admmig\\Desktop\\Impacket secret dump.evtx\n\nAccess Request Information:\n\tAccess Mask:\t\t0x10080\n\tAccesses:\t\tDELETE\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x6c366", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "60052", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Users\\admmig\\Desktop\\Impacket secret dump.evtx", "accessMask": "0x10080", "accessList": "%%1537\n\t\t\t\t%%4423"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4656_4663_4658_mimikatz_sekurlsa_password_dump(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Eventlog", "providerGuid": "{fc65ddd8-d6ef-4962-83d5-6e5cfe9ce148}", "eventID": "1102", "version": "0", "level": "4", "task": "104", "opcode": "0", "keywords": "0x4020000000000000", "systemTime": "2021-03-26T16:36:00.1069861Z", "eventRecordID": "9217073", "processID": "336", "threadID": "860", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "INFORMATION", "message": "The audit log was cleared.\nSubject:\n\tSecurity ID:\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\tadmmig\n\tDomain Name:\tOFFSEC\n\tLogon ID:\t0xE922E"}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4690", "version": "0", "level": "0", "task": "12807", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:36:00.8290185Z", "eventRecordID": "9217074", "processID": "4", "threadID": "456", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to duplicate a handle to an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xE922E\n\nSource Handle Information:\n\tSource Handle ID:\t0x274\n\tSource Process ID:\t0x1e20\n\nNew Handle Information:\n\tTarget Handle ID:\t0x11c0\n\tTarget Process ID:\t0x4"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xe922e", "sourceHandleId": "0x274", "sourceProcessId": "0x1e20", "targetHandleId": "0x11c0", "targetProcessId": "0x4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12802", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:36:00.8290227Z", "eventRecordID": "9217075", "processID": "4", "threadID": "456", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xE922E\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x11c0\n\nProcess Information:\n\tProcess ID:\t\t0x1e20\n\tProcess Name:\t\tC:\\TOOLS\\Security_tool\\Mimikatz-fev-2020\\mimikatz.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xe922e", "objectServer": "Security", "handleId": "0x11c0", "processId": "0x1e20", "processName": "C:\\TOOLS\\Security_tool\\Mimikatz-fev-2020\\mimikatz.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12802", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:36:00.8290334Z", "eventRecordID": "9217076", "processID": "4", "threadID": "456", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xE922E\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tProcess\n\tObject Name:\t\t\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe\n\tHandle ID:\t\t0x274\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x1e20\n\tProcess Name:\t\tC:\\TOOLS\\Security_tool\\Mimikatz-fev-2020\\mimikatz.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tRead from process memory\n\t\t\t\tUndefined Access (no effect) Bit 12\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x1010\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xe922e", "objectServer": "Security", "objectType": "Process", "objectName": "\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe", "handleId": "0x274", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%4484\n\t\t\t\t%%4492", "accessMask": "0x1010", "restrictedSidCount": "0", "processId": "0x1e20", "processName": "C:\\TOOLS\\Security_tool\\Mimikatz-fev-2020\\mimikatz.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4663", "version": "1", "level": "0", "task": "12802", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:36:00.8293731Z", "eventRecordID": "9217077", "processID": "4", "threadID": "456", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to access an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xE922E\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tProcess\n\tObject Name:\t\t\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe\n\tHandle ID:\t\t0x274\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x1e20\n\tProcess Name:\t\tC:\\TOOLS\\Security_tool\\Mimikatz-fev-2020\\mimikatz.exe\n\nAccess Request Information:\n\tAccesses:\t\tRead from process memory\n\t\t\t\t\n\tAccess Mask:\t\t0x10"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xe922e", "objectServer": "Security", "objectType": "Process", "objectName": "\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe", "handleId": "0x274", "accessList": "%%4484", "accessMask": "0x10", "processId": "0x1e20", "processName": "C:\\TOOLS\\Security_tool\\Mimikatz-fev-2020\\mimikatz.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4673", "version": "0", "level": "0", "task": "13056", "opcode": "0", "keywords": "0x8010000000000000", "systemTime": "2021-03-26T16:36:16.8333969Z", "eventRecordID": "9217078", "processID": "4", "threadID": "212", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_FAILURE", "message": "A privileged service was called.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xE922E\n\nService:\n\tServer:\tSecurity\n\tService Name:\t-\n\nProcess:\n\tProcess ID:\t0xc04\n\tProcess Name:\tC:\\Windows\\System32\\mmc.exe\n\nService Request Information:\n\tPrivileges:\t\tSeTcbPrivilege"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xe922e", "objectServer": "Security", "privilegeList": "SeTcbPrivilege", "processId": "0xc04", "processName": "C:\\Windows\\System32\\mmc.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:36:27.5887601Z", "eventRecordID": "9217079", "processID": "4", "threadID": "456", "channel": "Security", "computer": "jump01.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tJUMP01$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x1058\n\tNew Process Name:\tC:\\Windows\\System32\\wbem\\WMIADAP.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x48c\n\tCreator Process Name:\tC:\\Windows\\System32\\svchost.exe\n\tProcess Command Line:\twmiadap.exe /F /T\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "JUMP01$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x1058", "newProcessName": "C:\\Windows\\System32\\wbem\\WMIADAP.exe", "tokenElevationType": "%%1936", "processId": "0x48c", "commandLine": "wmiadap.exe /F /T", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\svchost.exe", "mandatoryLabel": "S-1-16-16384"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4661_4658_mimikatz_sekurlsa_password_dump_sam(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.8636870Z", "eventRecordID": "125522981", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tCN=Server,CN=System,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e251d80\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tConnectToServer\n\t\t\t\tShutdownServer\n\t\t\t\tInitializeServer\n\t\t\t\tCreateDomain\n\t\t\t\tEnumerateDomains\n\t\t\t\tLookupDomain\n\t\t\t\tUndefined Access (no effect) Bit 6\n\t\t\t\tUndefined Access (no effect) Bit 7\n\t\t\t\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "CN=Server,CN=System,DC=offsec,DC=lan", "handleId": "0x1d35e251d80", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5376\n\t\t\t\t%%5377\n\t\t\t\t%%5378\n\t\t\t\t%%5379\n\t\t\t\t%%5380\n\t\t\t\t%%5381\n\t\t\t\t%%5382\n\t\t\t\t%%5383\n\t\t\t\t%%5384", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.8638327Z", "eventRecordID": "125522982", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tDC=offsec,DC=lan\n\tHandle ID:\t0x1d35e250a40\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FD\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "DC=offsec,DC=lan", "handleId": "0x1d35e250a40", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01fd", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.8757896Z", "eventRecordID": "125522983", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.8803707Z", "eventRecordID": "125522984", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-500\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01BF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-500", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01bf", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.8831288Z", "eventRecordID": "125522985", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e253590", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.8860465Z", "eventRecordID": "125522986", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-501\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-501", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.8888037Z", "eventRecordID": "125522987", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.8889475Z", "eventRecordID": "125522988", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.8923150Z", "eventRecordID": "125522989", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-502\n\tHandle ID:\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01BF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-502", "handleId": "0x1d35e2530c0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01bf", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.8958137Z", "eventRecordID": "125522990", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2530c0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.8990463Z", "eventRecordID": "125522991", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-503\n\tHandle ID:\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-503", "handleId": "0x1d35e2530c0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9016166Z", "eventRecordID": "125522992", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2530c0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9017417Z", "eventRecordID": "125522993", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9050681Z", "eventRecordID": "125522994", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01BF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1111", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01bf", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9077057Z", "eventRecordID": "125522995", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9120403Z", "eventRecordID": "125522996", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1112\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01BF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1112", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01bf", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9139736Z", "eventRecordID": "125522997", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9139858Z", "eventRecordID": "125522998", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9165281Z", "eventRecordID": "125522999", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1119\n\tHandle ID:\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF00FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1119", "handleId": "0x1d35e2530c0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447", "accessMask": "0xf00ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9180281Z", "eventRecordID": "125523000", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2530c0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9205354Z", "eventRecordID": "125523001", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1129\n\tHandle ID:\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF00FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1129", "handleId": "0x1d35e2518b0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447", "accessMask": "0xf00ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9223599Z", "eventRecordID": "125523002", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2518b0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9223720Z", "eventRecordID": "125523003", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9248677Z", "eventRecordID": "125523004", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF00FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1147", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447", "accessMask": "0xf00ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9271513Z", "eventRecordID": "125523005", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e253590", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9296021Z", "eventRecordID": "125523006", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1154\n\tHandle ID:\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01BF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1154", "handleId": "0x1d35e250570", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01bf", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9316377Z", "eventRecordID": "125523007", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e250570", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9316499Z", "eventRecordID": "125523008", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9340301Z", "eventRecordID": "125523009", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1155\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01BF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1155", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01bf", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9354115Z", "eventRecordID": "125523010", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e253590", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9378216Z", "eventRecordID": "125523011", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1156\n\tHandle ID:\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF00FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1156", "handleId": "0x1d35e250570", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447", "accessMask": "0xf00ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9401487Z", "eventRecordID": "125523012", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e250570", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9401608Z", "eventRecordID": "125523013", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9439532Z", "eventRecordID": "125523014", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1161\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1161", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9453659Z", "eventRecordID": "125523015", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9477434Z", "eventRecordID": "125523016", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1170\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1170", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9497468Z", "eventRecordID": "125523017", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2513e0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9497594Z", "eventRecordID": "125523018", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:24.9522853Z", "eventRecordID": "125523019", "processID": "4", "threadID": "268", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1171\n\tHandle ID:\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF00FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1171", "handleId": "0x1d35e2518b0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447", "accessMask": "0xf00ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.0699671Z", "eventRecordID": "125523020", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2518b0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.0730082Z", "eventRecordID": "125523021", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1173\n\tHandle ID:\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1173", "handleId": "0x1d35e2518b0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.0756285Z", "eventRecordID": "125523022", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2518b0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.0758171Z", "eventRecordID": "125523023", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.0798248Z", "eventRecordID": "125523024", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1174\n\tHandle ID:\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1174", "handleId": "0x1d35e2530c0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.0837751Z", "eventRecordID": "125523025", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2530c0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.0876474Z", "eventRecordID": "125523026", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1178\n\tHandle ID:\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1178", "handleId": "0x1d35e2530c0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.0902505Z", "eventRecordID": "125523027", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2530c0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.0904303Z", "eventRecordID": "125523028", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.0941279Z", "eventRecordID": "125523029", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1180\n\tHandle ID:\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1180", "handleId": "0x1d35e2518b0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.0965268Z", "eventRecordID": "125523030", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2518b0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1111871Z", "eventRecordID": "125523031", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1181\n\tHandle ID:\t0x1d35e24fbd0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1181", "handleId": "0x1d35e24fbd0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1142964Z", "eventRecordID": "125523032", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e24fbd0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e24fbd0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1144473Z", "eventRecordID": "125523033", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1177344Z", "eventRecordID": "125523034", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1188\n\tHandle ID:\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1188", "handleId": "0x1d35e252bf0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1200918Z", "eventRecordID": "125523035", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252bf0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1230184Z", "eventRecordID": "125523036", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1189\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1189", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1253805Z", "eventRecordID": "125523037", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2513e0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1255145Z", "eventRecordID": "125523038", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1290553Z", "eventRecordID": "125523039", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1209\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1209", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1318829Z", "eventRecordID": "125523040", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2513e0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1344327Z", "eventRecordID": "125523041", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1210\n\tHandle ID:\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1210", "handleId": "0x1d35e252bf0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1361330Z", "eventRecordID": "125523042", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252bf0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1362736Z", "eventRecordID": "125523043", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1400399Z", "eventRecordID": "125523044", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1211\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1211", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1424407Z", "eventRecordID": "125523045", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e253590", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1465871Z", "eventRecordID": "125523046", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1212\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1212", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1488907Z", "eventRecordID": "125523047", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1490336Z", "eventRecordID": "125523048", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1526472Z", "eventRecordID": "125523049", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1213\n\tHandle ID:\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1213", "handleId": "0x1d35e252bf0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1549462Z", "eventRecordID": "125523050", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252bf0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1582666Z", "eventRecordID": "125523051", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1214\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1214", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1615421Z", "eventRecordID": "125523052", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2513e0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1616892Z", "eventRecordID": "125523053", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1653084Z", "eventRecordID": "125523054", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1215\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1215", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1678227Z", "eventRecordID": "125523055", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2513e0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1712219Z", "eventRecordID": "125523056", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1216\n\tHandle ID:\t0x1d35e2500a0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1216", "handleId": "0x1d35e2500a0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1796791Z", "eventRecordID": "125523057", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2500a0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2500a0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1798930Z", "eventRecordID": "125523058", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.1883750Z", "eventRecordID": "125523059", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1217\n\tHandle ID:\t0x1d35e24fbd0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1217", "handleId": "0x1d35e24fbd0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2225215Z", "eventRecordID": "125523060", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e24fbd0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e24fbd0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2266694Z", "eventRecordID": "125523061", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1218\n\tHandle ID:\t0x1d35e24fbd0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1218", "handleId": "0x1d35e24fbd0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2291099Z", "eventRecordID": "125523062", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e24fbd0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e24fbd0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2292617Z", "eventRecordID": "125523063", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2331340Z", "eventRecordID": "125523064", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1220\n\tHandle ID:\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1220", "handleId": "0x1d35e2530c0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2361629Z", "eventRecordID": "125523065", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2530c0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2427260Z", "eventRecordID": "125523066", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1221\n\tHandle ID:\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1221", "handleId": "0x1d35e252bf0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2459894Z", "eventRecordID": "125523067", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252bf0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2461897Z", "eventRecordID": "125523068", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2528565Z", "eventRecordID": "125523069", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1222\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1222", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2589754Z", "eventRecordID": "125523070", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2630120Z", "eventRecordID": "125523071", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1223\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1223", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2653600Z", "eventRecordID": "125523072", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2655374Z", "eventRecordID": "125523073", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2689618Z", "eventRecordID": "125523074", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1224\n\tHandle ID:\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1224", "handleId": "0x1d35e252bf0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2722181Z", "eventRecordID": "125523075", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252bf0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.2932189Z", "eventRecordID": "125523076", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1225\n\tHandle ID:\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1225", "handleId": "0x1d35e2530c0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3005276Z", "eventRecordID": "125523077", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2530c0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3007242Z", "eventRecordID": "125523078", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3086700Z", "eventRecordID": "125523079", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1226\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1226", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3130732Z", "eventRecordID": "125523080", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2513e0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3265951Z", "eventRecordID": "125523081", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1227\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1227", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3354557Z", "eventRecordID": "125523082", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3356724Z", "eventRecordID": "125523083", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3420430Z", "eventRecordID": "125523084", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1228\n\tHandle ID:\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1228", "handleId": "0x1d35e250570", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3446572Z", "eventRecordID": "125523085", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e250570", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3480769Z", "eventRecordID": "125523086", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1229\n\tHandle ID:\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1229", "handleId": "0x1d35e252bf0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3508834Z", "eventRecordID": "125523087", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252bf0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3510810Z", "eventRecordID": "125523088", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3540995Z", "eventRecordID": "125523089", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1230\n\tHandle ID:\t0x1d35e2500a0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1230", "handleId": "0x1d35e2500a0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3555659Z", "eventRecordID": "125523090", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2500a0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2500a0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3580698Z", "eventRecordID": "125523091", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1231\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1231", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3595693Z", "eventRecordID": "125523092", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2513e0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3597314Z", "eventRecordID": "125523093", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3632398Z", "eventRecordID": "125523094", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1232\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF00FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1232", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447", "accessMask": "0xf00ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3666539Z", "eventRecordID": "125523095", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e253590", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3696454Z", "eventRecordID": "125523096", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1234\n\tHandle ID:\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01BF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1234", "handleId": "0x1d35e250570", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01bf", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3722614Z", "eventRecordID": "125523097", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e250570", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3724230Z", "eventRecordID": "125523098", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3758638Z", "eventRecordID": "125523099", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1235\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01BF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1235", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01bf", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3784144Z", "eventRecordID": "125523100", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e253590", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3826141Z", "eventRecordID": "125523101", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1236\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1236", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3853399Z", "eventRecordID": "125523102", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e253590", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3855332Z", "eventRecordID": "125523103", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3898850Z", "eventRecordID": "125523104", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1607\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1607", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3929227Z", "eventRecordID": "125523105", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.3971825Z", "eventRecordID": "125523106", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1608\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1608", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4002277Z", "eventRecordID": "125523107", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4004225Z", "eventRecordID": "125523108", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4152244Z", "eventRecordID": "125523109", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1620\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF00FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1620", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447", "accessMask": "0xf00ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4167216Z", "eventRecordID": "125523110", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4209385Z", "eventRecordID": "125523111", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1625\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01BF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1625", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01bf", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4251637Z", "eventRecordID": "125523112", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2513e0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4251759Z", "eventRecordID": "125523113", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4302884Z", "eventRecordID": "125523114", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1626\n\tHandle ID:\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1626", "handleId": "0x1d35e252bf0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4341560Z", "eventRecordID": "125523115", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252bf0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4366506Z", "eventRecordID": "125523116", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1627\n\tHandle ID:\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1627", "handleId": "0x1d35e250570", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4384924Z", "eventRecordID": "125523117", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e250570", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4385041Z", "eventRecordID": "125523118", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4596935Z", "eventRecordID": "125523119", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1000\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1000", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4638179Z", "eventRecordID": "125523120", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e253590", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4663130Z", "eventRecordID": "125523121", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1103\n\tHandle ID:\t0x1d35e24fbd0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1103", "handleId": "0x1d35e24fbd0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4677943Z", "eventRecordID": "125523122", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e24fbd0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e24fbd0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4679941Z", "eventRecordID": "125523123", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.4884817Z", "eventRecordID": "125523124", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1104\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1104", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5028727Z", "eventRecordID": "125523125", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5067048Z", "eventRecordID": "125523126", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1105\n\tHandle ID:\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1105", "handleId": "0x1d35e2518b0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5091158Z", "eventRecordID": "125523127", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2518b0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5092723Z", "eventRecordID": "125523128", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5348831Z", "eventRecordID": "125523129", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1106\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1106", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5389753Z", "eventRecordID": "125523130", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e253590", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5427420Z", "eventRecordID": "125523131", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1108\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1108", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5450853Z", "eventRecordID": "125523132", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2513e0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5452413Z", "eventRecordID": "125523133", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5497706Z", "eventRecordID": "125523134", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1113\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1113", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5540705Z", "eventRecordID": "125523135", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2513e0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5575654Z", "eventRecordID": "125523136", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1114\n\tHandle ID:\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1114", "handleId": "0x1d35e2530c0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5590985Z", "eventRecordID": "125523137", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2530c0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5593563Z", "eventRecordID": "125523138", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5635671Z", "eventRecordID": "125523139", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1115\n\tHandle ID:\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1115", "handleId": "0x1d35e2518b0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5663087Z", "eventRecordID": "125523140", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2518b0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5705513Z", "eventRecordID": "125523141", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1121\n\tHandle ID:\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1121", "handleId": "0x1d35e2530c0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5729666Z", "eventRecordID": "125523142", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2530c0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5731165Z", "eventRecordID": "125523143", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5770938Z", "eventRecordID": "125523144", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1122\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1122", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5796398Z", "eventRecordID": "125523145", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2513e0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5828536Z", "eventRecordID": "125523146", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1123\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1123", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5925930Z", "eventRecordID": "125523147", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e253590", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5926088Z", "eventRecordID": "125523148", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.5967940Z", "eventRecordID": "125523149", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1124\n\tHandle ID:\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1124", "handleId": "0x1d35e252bf0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6014143Z", "eventRecordID": "125523150", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252bf0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6039990Z", "eventRecordID": "125523151", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1125\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1125", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6060449Z", "eventRecordID": "125523152", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e252250", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6060575Z", "eventRecordID": "125523153", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6096832Z", "eventRecordID": "125523154", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1126\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1126", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6284522Z", "eventRecordID": "125523155", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e253590", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6359739Z", "eventRecordID": "125523156", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1601\n\tHandle ID:\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1601", "handleId": "0x1d35e2530c0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6387954Z", "eventRecordID": "125523157", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2530c0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6389500Z", "eventRecordID": "125523158", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tSAM\n\tHandle ID:\t0x0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0x100\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\nUndefined Access (no effect) Bit 8\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "SAM", "handleId": "0x0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%5384", "accessMask": "0x100", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n%%5384\n\t\t{91d67418-0135-4acc-8d79-c08e857cfbec}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6428581Z", "eventRecordID": "125523159", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_USER\n\tObject Name:\tS-1-5-21-4230534742-2542757381-3142984815-1623\n\tHandle ID:\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadGeneralInformation\n\t\t\t\tReadPreferences\n\t\t\t\tWritePreferences\n\t\t\t\tReadLogon\n\t\t\t\tReadAccount\n\t\t\t\tWriteAccount\n\t\t\t\tChangePassword (with knowledge of old password)\n\t\t\t\tSetPassword (without knowledge of old password)\n\t\t\t\tListGroups\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadGeneralInformation\nReadPreferences\nWritePreferences\nReadLogon\nReadAccount\nWriteAccount\nChangePassword (with knowledge of old password)\nSetPassword (without knowledge of old password)\nListGroups\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "objectType": "SAM_USER", "objectName": "S-1-5-21-4230534742-2542757381-3142984815-1623", "handleId": "0x1d35e2518b0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5440\n\t\t\t\t%%5441\n\t\t\t\t%%5442\n\t\t\t\t%%5443\n\t\t\t\t%%5444\n\t\t\t\t%%5445\n\t\t\t\t%%5446\n\t\t\t\t%%5447\n\t\t\t\t%%5448", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aba-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5440\n%%5441\n%%5442\n%%5443\n%%5444\n%%5445\n%%5446\n%%5447\n%%5448\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\t\t\t{bf967938-0de6-11d0-a285-00aa003049e2}\n\t\t\t{5fd42471-1262-11d0-a060-00aa006c33ed}\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a00-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t\t{bf967a6a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967953-0de6-11d0-a285-00aa003049e2}\n\t\t{4c164200-20c0-11d0-a768-00aa006e0529}\n\t\t\t{bf967915-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0a-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a68-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a6d-0de6-11d0-a285-00aa003049e2}\n\t\t{5f202010-79a5-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf96792e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967985-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967986-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967996-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967997-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679aa-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ab-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ac-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a05-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a8-0de6-11d0-a285-00aa003049e2}\n\t\t{e48d0154-bcf8-11d1-8702-00c04fb96050}\n\t\t\t{bf967950-0de6-11d0-a285-00aa003049e2}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf967991-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a53-1e2f-11d0-9819-00aa0040529b}\n\t\t{00299570-246d-11d0-a768-00aa006e0529}\n\t\t{7ed84960-ad10-11d0-8a92-00aa006e0529}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6454592Z", "eventRecordID": "125523160", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e2518b0\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e2518b0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6455190Z", "eventRecordID": "125523161", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e250a40\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e250a40", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12804", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T16:59:25.6455512Z", "eventRecordID": "125523162", "processID": "4", "threadID": "344", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x493AC\n\nObject:\n\tObject Server:\t\tSecurity Account Manager\n\tHandle ID:\t\t0x1d35e251d80\n\nProcess Information:\n\tProcess ID:\t\t0x230\n\tProcess Name:\t\tC:\\Windows\\System32\\lsass.exe"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x493ac", "objectServer": "Security Account Manager", "handleId": "0x1d35e251d80", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12812", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T17:00:15.5597043Z", "eventRecordID": "125523230", "processID": "4", "threadID": "160", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0xfc8\n\nProcess Information:\n\tProcess ID:\t\t0x598\n\tProcess Name:\t\tC:\\Windows\\System32\\wbem\\WmiPrvSE.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0xfc8", "processId": "0x598", "processName": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12812", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T17:00:15.5598849Z", "eventRecordID": "125523233", "processID": "4", "threadID": "160", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0xfc8\n\nProcess Information:\n\tProcess ID:\t\t0x598\n\tProcess Name:\t\tC:\\Windows\\System32\\wbem\\WmiPrvSE.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0xfc8", "processId": "0x598", "processName": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12812", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T17:00:15.5599213Z", "eventRecordID": "125523235", "processID": "4", "threadID": "160", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x41c\n\nProcess Information:\n\tProcess ID:\t\t0x598\n\tProcess Name:\t\tC:\\Windows\\System32\\wbem\\WmiPrvSE.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x41c", "processId": "0x598", "processName": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4658", "version": "0", "level": "0", "task": "12812", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T17:00:15.5599418Z", "eventRecordID": "125523236", "processID": "4", "threadID": "160", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "The handle to an object was closed.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\t\tSecurity\n\tHandle ID:\t\t0x558\n\nProcess Information:\n\tProcess ID:\t\t0x598\n\tProcess Name:\t\tC:\\Windows\\System32\\wbem\\WmiPrvSE.exe"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security", "handleId": "0x558", "processId": "0x598", "processName": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4661_suspicious_sam_access_to_password_attributes_by_lsass_dcshadow(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:42:48.6144925Z", "eventRecordID": "125593002", "processID": "4", "threadID": "5380", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tCN=Server,CN=System,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e251d80\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tConnectToServer\n\t\t\t\tShutdownServer\n\t\t\t\tInitializeServer\n\t\t\t\tCreateDomain\n\t\t\t\tEnumerateDomains\n\t\t\t\tLookupDomain\n\t\t\t\tUndefined Access (no effect) Bit 6\n\t\t\t\tUndefined Access (no effect) Bit 7\n\t\t\t\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "CN=Server,CN=System,DC=offsec,DC=lan", "handleId": "0x1d35e251d80", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5376\n\t\t\t\t%%5377\n\t\t\t\t%%5378\n\t\t\t\t%%5379\n\t\t\t\t%%5380\n\t\t\t\t%%5381\n\t\t\t\t%%5382\n\t\t\t\t%%5383\n\t\t\t\t%%5384", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:42:48.6146356Z", "eventRecordID": "125593003", "processID": "4", "threadID": "5380", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tDC=offsec,DC=lan\n\tHandle ID:\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FD\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "DC=offsec,DC=lan", "handleId": "0x1d35e250570", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01fd", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:42:48.6147307Z", "eventRecordID": "125593004", "processID": "4", "threadID": "5380", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tCN=Builtin,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tWritePasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nWritePasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "CN=Builtin,DC=offsec,DC=lan", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5393\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01ff", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5393\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:42:48.6399742Z", "eventRecordID": "125593014", "processID": "4", "threadID": "5380", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tCN=Server,CN=System,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e252bf0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tConnectToServer\n\t\t\t\tShutdownServer\n\t\t\t\tInitializeServer\n\t\t\t\tCreateDomain\n\t\t\t\tEnumerateDomains\n\t\t\t\tLookupDomain\n\t\t\t\tUndefined Access (no effect) Bit 6\n\t\t\t\tUndefined Access (no effect) Bit 7\n\t\t\t\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "CN=Server,CN=System,DC=offsec,DC=lan", "handleId": "0x1d35e252bf0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5376\n\t\t\t\t%%5377\n\t\t\t\t%%5378\n\t\t\t\t%%5379\n\t\t\t\t%%5380\n\t\t\t\t%%5381\n\t\t\t\t%%5382\n\t\t\t\t%%5383\n\t\t\t\t%%5384", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:42:48.6401047Z", "eventRecordID": "125593015", "processID": "4", "threadID": "5380", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tDC=offsec,DC=lan\n\tHandle ID:\t0x1d35e2530c0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FD\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "DC=offsec,DC=lan", "handleId": "0x1d35e2530c0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01fd", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:42:48.6402393Z", "eventRecordID": "125593016", "processID": "4", "threadID": "5380", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tCN=Builtin,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e251d80\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tWritePasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nWritePasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "CN=Builtin,DC=offsec,DC=lan", "handleId": "0x1d35e251d80", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5393\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01ff", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5393\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:42:48.6405986Z", "eventRecordID": "125593017", "processID": "4", "threadID": "5380", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_ALIAS\n\tObject Name:\tS-1-5-32-544\n\tHandle ID:\t0x1d35e2500a0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tAddMember\n\t\t\t\tRemoveMember\n\t\t\t\tListMembers\n\t\t\t\tReadInformation\n\t\t\t\tWriteAccount\n\t\t\t\tUndefined Access (no effect) Bit 5\n\t\t\t\tUndefined Access (no effect) Bit 6\n\t\t\t\tUndefined Access (no effect) Bit 7\n\t\t\t\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967a9c-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nAddMember\nRemoveMember\nListMembers\nReadInformation\nWriteAccount\nUndefined Access (no effect) Bit 5\nUndefined Access (no effect) Bit 6\nUndefined Access (no effect) Bit 7\nUndefined Access (no effect) Bit 8\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf9679c0-0de6-11d0-a285-00aa003049e2}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_ALIAS", "objectName": "S-1-5-32-544", "handleId": "0x1d35e2500a0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5424\n\t\t\t\t%%5425\n\t\t\t\t%%5426\n\t\t\t\t%%5427\n\t\t\t\t%%5428\n\t\t\t\t%%5429\n\t\t\t\t%%5430\n\t\t\t\t%%5431\n\t\t\t\t%%5432", "accessMask": "0xf01ff", "properties": "---\n\t{bf967a9c-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5424\n%%5425\n%%5426\n%%5427\n%%5428\n%%5429\n%%5430\n%%5431\n%%5432\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf9679c0-0de6-11d0-a285-00aa003049e2}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:42:48.6452413Z", "eventRecordID": "125593022", "processID": "4", "threadID": "5380", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tCN=Server,CN=System,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e24fbd0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tConnectToServer\n\t\t\t\tShutdownServer\n\t\t\t\tInitializeServer\n\t\t\t\tCreateDomain\n\t\t\t\tEnumerateDomains\n\t\t\t\tLookupDomain\n\t\t\t\tUndefined Access (no effect) Bit 6\n\t\t\t\tUndefined Access (no effect) Bit 7\n\t\t\t\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "CN=Server,CN=System,DC=offsec,DC=lan", "handleId": "0x1d35e24fbd0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5376\n\t\t\t\t%%5377\n\t\t\t\t%%5378\n\t\t\t\t%%5379\n\t\t\t\t%%5380\n\t\t\t\t%%5381\n\t\t\t\t%%5382\n\t\t\t\t%%5383\n\t\t\t\t%%5384", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:42:48.6453750Z", "eventRecordID": "125593023", "processID": "4", "threadID": "5380", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tDC=offsec,DC=lan\n\tHandle ID:\t0x1d35e253590\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FD\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "DC=offsec,DC=lan", "handleId": "0x1d35e253590", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01fd", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:42:48.6454738Z", "eventRecordID": "125593024", "processID": "4", "threadID": "5380", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tCN=Builtin,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tWritePasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nWritePasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "CN=Builtin,DC=offsec,DC=lan", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5393\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01ff", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5393\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:47:49.3564464Z", "eventRecordID": "125594521", "processID": "4", "threadID": "1416", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tCN=Server,CN=System,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tConnectToServer\n\t\t\t\tShutdownServer\n\t\t\t\tInitializeServer\n\t\t\t\tCreateDomain\n\t\t\t\tEnumerateDomains\n\t\t\t\tLookupDomain\n\t\t\t\tUndefined Access (no effect) Bit 6\n\t\t\t\tUndefined Access (no effect) Bit 7\n\t\t\t\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "CN=Server,CN=System,DC=offsec,DC=lan", "handleId": "0x1d35e250570", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5376\n\t\t\t\t%%5377\n\t\t\t\t%%5378\n\t\t\t\t%%5379\n\t\t\t\t%%5380\n\t\t\t\t%%5381\n\t\t\t\t%%5382\n\t\t\t\t%%5383\n\t\t\t\t%%5384", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:47:49.3565853Z", "eventRecordID": "125594522", "processID": "4", "threadID": "1416", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tDC=offsec,DC=lan\n\tHandle ID:\t0x1d35e24fbd0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FD\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "DC=offsec,DC=lan", "handleId": "0x1d35e24fbd0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01fd", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:47:49.3566803Z", "eventRecordID": "125594523", "processID": "4", "threadID": "1416", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tCN=Builtin,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e2500a0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tWritePasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nWritePasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "CN=Builtin,DC=offsec,DC=lan", "handleId": "0x1d35e2500a0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5393\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01ff", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5393\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:47:49.3835259Z", "eventRecordID": "125594533", "processID": "4", "threadID": "1416", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tCN=Server,CN=System,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tConnectToServer\n\t\t\t\tShutdownServer\n\t\t\t\tInitializeServer\n\t\t\t\tCreateDomain\n\t\t\t\tEnumerateDomains\n\t\t\t\tLookupDomain\n\t\t\t\tUndefined Access (no effect) Bit 6\n\t\t\t\tUndefined Access (no effect) Bit 7\n\t\t\t\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "CN=Server,CN=System,DC=offsec,DC=lan", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5376\n\t\t\t\t%%5377\n\t\t\t\t%%5378\n\t\t\t\t%%5379\n\t\t\t\t%%5380\n\t\t\t\t%%5381\n\t\t\t\t%%5382\n\t\t\t\t%%5383\n\t\t\t\t%%5384", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:47:49.3836573Z", "eventRecordID": "125594534", "processID": "4", "threadID": "1416", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tDC=offsec,DC=lan\n\tHandle ID:\t0x1d35e250570\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FD\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "DC=offsec,DC=lan", "handleId": "0x1d35e250570", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01fd", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:47:49.3837519Z", "eventRecordID": "125594535", "processID": "4", "threadID": "1416", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tCN=Builtin,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e251d80\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tWritePasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nWritePasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "CN=Builtin,DC=offsec,DC=lan", "handleId": "0x1d35e251d80", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5393\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01ff", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5393\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:47:49.3840874Z", "eventRecordID": "125594536", "processID": "4", "threadID": "1416", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_ALIAS\n\tObject Name:\tS-1-5-32-544\n\tHandle ID:\t0x1d35e252250\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tAddMember\n\t\t\t\tRemoveMember\n\t\t\t\tListMembers\n\t\t\t\tReadInformation\n\t\t\t\tWriteAccount\n\t\t\t\tUndefined Access (no effect) Bit 5\n\t\t\t\tUndefined Access (no effect) Bit 6\n\t\t\t\tUndefined Access (no effect) Bit 7\n\t\t\t\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967a9c-0de6-11d0-a285-00aa003049e2}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nAddMember\nRemoveMember\nListMembers\nReadInformation\nWriteAccount\nUndefined Access (no effect) Bit 5\nUndefined Access (no effect) Bit 6\nUndefined Access (no effect) Bit 7\nUndefined Access (no effect) Bit 8\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf9679c0-0de6-11d0-a285-00aa003049e2}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_ALIAS", "objectName": "S-1-5-32-544", "handleId": "0x1d35e252250", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5424\n\t\t\t\t%%5425\n\t\t\t\t%%5426\n\t\t\t\t%%5427\n\t\t\t\t%%5428\n\t\t\t\t%%5429\n\t\t\t\t%%5430\n\t\t\t\t%%5431\n\t\t\t\t%%5432", "accessMask": "0xf01ff", "properties": "---\n\t{bf967a9c-0de6-11d0-a285-00aa003049e2}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5424\n%%5425\n%%5426\n%%5427\n%%5428\n%%5429\n%%5430\n%%5431\n%%5432\n\t\t\t{bf9679e8-0de6-11d0-a285-00aa003049e2}\n\t\t\t{3e0abfd0-126a-11d0-a060-00aa006c33ed}\n\t\t{bc0ac240-79a9-11d0-9020-00c04fc2d4cf}\n\t\t\t{bf9679c0-0de6-11d0-a285-00aa003049e2}\n\t\t{59ba2f42-79a2-11d0-9020-00c04fc2d3cf}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:47:49.3887208Z", "eventRecordID": "125594541", "processID": "4", "threadID": "1416", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_SERVER\n\tObject Name:\tCN=Server,CN=System,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e2513e0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tConnectToServer\n\t\t\t\tShutdownServer\n\t\t\t\tInitializeServer\n\t\t\t\tCreateDomain\n\t\t\t\tEnumerateDomains\n\t\t\t\tLookupDomain\n\t\t\t\tUndefined Access (no effect) Bit 6\n\t\t\t\tUndefined Access (no effect) Bit 7\n\t\t\t\tUndefined Access (no effect) Bit 8\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_SERVER", "objectName": "CN=Server,CN=System,DC=offsec,DC=lan", "handleId": "0x1d35e2513e0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5376\n\t\t\t\t%%5377\n\t\t\t\t%%5378\n\t\t\t\t%%5379\n\t\t\t\t%%5380\n\t\t\t\t%%5381\n\t\t\t\t%%5382\n\t\t\t\t%%5383\n\t\t\t\t%%5384", "accessMask": "0xf01ff", "properties": "---\n\t{bf967aad-0de6-11d0-a285-00aa003049e2}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:47:49.3888555Z", "eventRecordID": "125594542", "processID": "4", "threadID": "1416", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tDC=offsec,DC=lan\n\tHandle ID:\t0x1d35e24fbd0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FD\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "DC=offsec,DC=lan", "handleId": "0x1d35e24fbd0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01fd", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4661", "version": "1", "level": "0", "task": "12803", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-03-26T20:47:49.3889487Z", "eventRecordID": "125594543", "processID": "4", "threadID": "1416", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nObject:\n\tObject Server:\tSecurity Account Manager\n\tObject Type:\tSAM_DOMAIN\n\tObject Name:\tCN=Builtin,DC=offsec,DC=lan\n\tHandle ID:\t0x1d35e2500a0\n\nProcess Information:\n\tProcess ID:\t0x230\n\tProcess Name:\tC:\\Windows\\System32\\lsass.exe\n\nAccess Request Information:\n\tTransaction ID:\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tReadPasswordParameters\n\t\t\t\tWritePasswordParameters\n\t\t\t\tReadOtherParameters\n\t\t\t\tWriteOtherParameters\n\t\t\t\tCreateUser\n\t\t\t\tCreateGlobalGroup\n\t\t\t\tCreateLocalGroup\n\t\t\t\tGetLocalGroupMembership\n\t\t\t\tListAccounts\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t0xF01FF\n\tPrivileges Used for Access Check:\t-\n\tProperties:\t---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\nDELETE\nREAD_CONTROL\nWRITE_DAC\nWRITE_OWNER\nReadPasswordParameters\nWritePasswordParameters\nReadOtherParameters\nWriteOtherParameters\nCreateUser\nCreateGlobalGroup\nCreateLocalGroup\nGetLocalGroupMembership\nListAccounts\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}\n\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "objectServer": "Security Account Manager", "objectType": "SAM_DOMAIN", "objectName": "CN=Builtin,DC=offsec,DC=lan", "handleId": "0x1d35e2500a0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%5392\n\t\t\t\t%%5393\n\t\t\t\t%%5394\n\t\t\t\t%%5395\n\t\t\t\t%%5396\n\t\t\t\t%%5397\n\t\t\t\t%%5398\n\t\t\t\t%%5399\n\t\t\t\t%%5400", "accessMask": "0xf01ff", "properties": "---\n\t{19195a5a-6da0-11d0-afd3-00c04fd930c9}\n%%1537\n%%1538\n%%1539\n%%1540\n%%5392\n%%5393\n%%5394\n%%5395\n%%5396\n%%5397\n%%5398\n%%5399\n%%5400\n\t\t{c7407360-20bf-11d0-a768-00aa006e0529}\n\t\t\t{bf9679a4-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679a6-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679bb-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c2-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c3-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a09-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a0b-0de6-11d0-a285-00aa003049e2}\n\t\t{b8119fd0-04f6-4762-ab7a-4986c76b3f9a}\n\t\t\t{bf967a34-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a33-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679c5-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967a61-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf967977-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf96795e-0de6-11d0-a285-00aa003049e2}\n\t\t\t{bf9679ea-0de6-11d0-a285-00aa003049e2}\n\t\t{ab721a52-1e2f-11d0-9819-00aa0040529b}", "restrictedSidCount": "0", "processId": "0x230", "processName": "C:\\Windows\\System32\\lsass.exe"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4662_dcsync_attack_using_mimikatz(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:02:34.1038962Z", "eventRecordID": "24485731", "processID": "516", "threadID": "3340", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B8C41E\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{ae6286be-d372-7561-6340-b4315c2bc2aa}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t55731\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b8c41e", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{ae6286be-d372-7561-6340-b4315c2bc2aa}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "55731", "impersonationLevel": "%%1833", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:02:35.1177004Z", "eventRecordID": "24485737", "processID": "516", "threadID": "3340", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B8C703\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{ae6286be-d372-7561-6340-b4315c2bc2aa}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t55731\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b8c703", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{ae6286be-d372-7561-6340-b4315c2bc2aa}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "55731", "impersonationLevel": "%%1833", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:02:37.1660439Z", "eventRecordID": "24485743", "processID": "516", "threadID": "3340", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tIdentification\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B8C741\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{cc1e6b4a-47c3-0636-8428-5e31b8dae51c}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t55733\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b8c741", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{cc1e6b4a-47c3-0636-8428-5e31b8dae51c}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "55733", "impersonationLevel": "%%1832", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:02:37.2002748Z", "eventRecordID": "24485745", "processID": "516", "threadID": "556", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x11B8C741\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\tObject Name:\t\t%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tControl Access\n\t\t\t\t\n\tAccess Mask:\t\t0x100\n\tProperties:\t\tControl Access\n\t\t{1131f6aa-9c07-11d1-f79f-00c04fc2dcd2}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x11b8c741", "objectServer": "DS", "objectType": "%{19195a5b-6da0-11d0-afd3-00c04fd930c9}", "objectName": "%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%7688", "accessMask": "0x100", "properties": "%%7688\n\t\t{1131f6aa-9c07-11d1-f79f-00c04fc2dcd2}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:02:37.2126433Z", "eventRecordID": "24485746", "processID": "516", "threadID": "556", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x11B8C741\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\tObject Name:\t\t%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tControl Access\n\t\t\t\t\n\tAccess Mask:\t\t0x100\n\tProperties:\t\tControl Access\n\t\t{1131f6aa-9c07-11d1-f79f-00c04fc2dcd2}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x11b8c741", "objectServer": "DS", "objectType": "%{19195a5b-6da0-11d0-afd3-00c04fd930c9}", "objectName": "%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%7688", "accessMask": "0x100", "properties": "%%7688\n\t\t{1131f6aa-9c07-11d1-f79f-00c04fc2dcd2}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:02:37.2130174Z", "eventRecordID": "24485747", "processID": "516", "threadID": "556", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x11B8C741\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\tObject Name:\t\t%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tControl Access\n\t\t\t\t\n\tAccess Mask:\t\t0x100\n\tProperties:\t\tControl Access\n\t\t{1131f6ad-9c07-11d1-f79f-00c04fc2dcd2}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x11b8c741", "objectServer": "DS", "objectType": "%{19195a5b-6da0-11d0-afd3-00c04fd930c9}", "objectName": "%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%7688", "accessMask": "0x100", "properties": "%%7688\n\t\t{1131f6ad-9c07-11d1-f79f-00c04fc2dcd2}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:02:39.8037380Z", "eventRecordID": "24485751", "processID": "516", "threadID": "2620", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B8C7C1\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{1fc539b8-9319-af73-721c-66a4c7f95002}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t::1\n\tSource Port:\t\t58733\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-18", "targetUserName": "ROOTDC1$", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b8c7c1", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{1fc539b8-9319-af73-721c-66a4c7f95002}", "keyLength": "0", "processId": "0x0", "ipAddress": "::1", "ipPort": "58733", "impersonationLevel": "%%1833", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:03:03.5605612Z", "eventRecordID": "24485777", "processID": "516", "threadID": "3936", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B8CD00\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{31dc087f-d16a-6592-7cf9-38d2181a5d4a}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\tfe80::1cae:5aa4:9d8d:106a\n\tSource Port:\t\t58736\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-18", "targetUserName": "ROOTDC1$", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b8cd00", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{31dc087f-d16a-6592-7cf9-38d2181a5d4a}", "keyLength": "0", "processId": "0x0", "ipAddress": "fe80::1cae:5aa4:9d8d:106a", "ipPort": "58736", "impersonationLevel": "%%1833", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:03:08.7156923Z", "eventRecordID": "24485785", "processID": "516", "threadID": "3936", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tDelegation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1105\n\tAccount Name:\t\tFS02$\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B8D014\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{2482d0c2-9875-9827-047f-6149630bd1be}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.42.18\n\tSource Port:\t\t62274\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1105", "targetUserName": "FS02$", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b8d014", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{2482d0c2-9875-9827-047f-6149630bd1be}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.42.18", "ipPort": "62274", "impersonationLevel": "%%1840", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:03:12.9933126Z", "eventRecordID": "24485794", "processID": "516", "threadID": "556", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B8D057\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{ae6286be-d372-7561-6340-b4315c2bc2aa}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t55738\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b8d057", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{ae6286be-d372-7561-6340-b4315c2bc2aa}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "55738", "impersonationLevel": "%%1833", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:03:32.9027188Z", "eventRecordID": "24485816", "processID": "516", "threadID": "3936", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1120\n\tAccount Name:\t\tROOTDC2$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x11B34F52\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\tObject Name:\t\t%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tControl Access\n\t\t\t\t\n\tAccess Mask:\t\t0x100\n\tProperties:\t\tControl Access\n\t\t{1131f6aa-9c07-11d1-f79f-00c04fc2dcd2}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1120", "subjectUserName": "ROOTDC2$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x11b34f52", "objectServer": "DS", "objectType": "%{19195a5b-6da0-11d0-afd3-00c04fd930c9}", "objectName": "%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%7688", "accessMask": "0x100", "properties": "%%7688\n\t\t{1131f6aa-9c07-11d1-f79f-00c04fc2dcd2}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:03:32.9027910Z", "eventRecordID": "24485817", "processID": "516", "threadID": "3936", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1120\n\tAccount Name:\t\tROOTDC2$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x11B34F52\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\tObject Name:\t\t%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tControl Access\n\t\t\t\t\n\tAccess Mask:\t\t0x100\n\tProperties:\t\tControl Access\n\t\t{89e95b76-444d-4c62-991a-0facbeda640c}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1120", "subjectUserName": "ROOTDC2$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x11b34f52", "objectServer": "DS", "objectType": "%{19195a5b-6da0-11d0-afd3-00c04fd930c9}", "objectName": "%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%7688", "accessMask": "0x100", "properties": "%%7688\n\t\t{89e95b76-444d-4c62-991a-0facbeda640c}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4662", "version": "0", "level": "0", "task": "14080", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:03:32.9028502Z", "eventRecordID": "24485818", "processID": "516", "threadID": "3936", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An operation was performed on an object.\n\nSubject :\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1120\n\tAccount Name:\t\tROOTDC2$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x11B34F52\n\nObject:\n\tObject Server:\t\tDS\n\tObject Type:\t\t%{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\tObject Name:\t\t%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}\n\tHandle ID:\t\t0x0\n\nOperation:\n\tOperation Type:\t\tObject Access\n\tAccesses:\t\tControl Access\n\t\t\t\t\n\tAccess Mask:\t\t0x100\n\tProperties:\t\tControl Access\n\t\t{1131f6ad-9c07-11d1-f79f-00c04fc2dcd2}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}\n\n\nAdditional Information:\n\tParameter 1:\t\t-\n\tParameter 2:"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1120", "subjectUserName": "ROOTDC2$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x11b34f52", "objectServer": "DS", "objectType": "%{19195a5b-6da0-11d0-afd3-00c04fd930c9}", "objectName": "%{0b32719a-29a5-4ad5-b9dc-56200eba0ce0}", "operationType": "Object Access", "handleId": "0x0", "accessList": "%%7688", "accessMask": "0x100", "properties": "%%7688\n\t\t{1131f6ad-9c07-11d1-f79f-00c04fc2dcd2}\n\t{19195a5b-6da0-11d0-afd3-00c04fd930c9}"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:03:39.8198559Z", "eventRecordID": "24485826", "processID": "516", "threadID": "2620", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B8D831\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{1fc539b8-9319-af73-721c-66a4c7f95002}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t::1\n\tSource Port:\t\t58739\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-18", "targetUserName": "ROOTDC1$", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b8d831", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{1fc539b8-9319-af73-721c-66a4c7f95002}", "keyLength": "0", "processId": "0x0", "ipAddress": "::1", "ipPort": "58739", "impersonationLevel": "%%1833", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:04:02.8504022Z", "eventRecordID": "24485853", "processID": "516", "threadID": "3936", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B8DCC1\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{ae6286be-d372-7561-6340-b4315c2bc2aa}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t55748\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b8dcc1", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{ae6286be-d372-7561-6340-b4315c2bc2aa}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "55748", "impersonationLevel": "%%1833", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:04:09.6893245Z", "eventRecordID": "24485863", "processID": "516", "threadID": "3340", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tDelegation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B9E9A8\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{ae2266ee-6100-fe92-5cf5-2b56e6eb406e}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t54927\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b9e9a8", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{ae2266ee-6100-fe92-5cf5-2b56e6eb406e}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "54927", "impersonationLevel": "%%1840", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:04:09.6952258Z", "eventRecordID": "24485871", "processID": "516", "threadID": "3936", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tDelegation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B9E9C0\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{ae2266ee-6100-fe92-5cf5-2b56e6eb406e}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t54931\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b9e9c0", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{ae2266ee-6100-fe92-5cf5-2b56e6eb406e}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "54931", "impersonationLevel": "%%1840", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:04:09.6961177Z", "eventRecordID": "24485875", "processID": "516", "threadID": "3340", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tDelegation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B9E9D3\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{ae2266ee-6100-fe92-5cf5-2b56e6eb406e}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t54933\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b9e9d3", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{ae2266ee-6100-fe92-5cf5-2b56e6eb406e}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "54933", "impersonationLevel": "%%1840", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:04:09.6967198Z", "eventRecordID": "24485879", "processID": "516", "threadID": "3936", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tDelegation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B9E9E5\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{ae2266ee-6100-fe92-5cf5-2b56e6eb406e}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t54932\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b9e9e5", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{ae2266ee-6100-fe92-5cf5-2b56e6eb406e}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "54932", "impersonationLevel": "%%1840", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "2", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-08-02T12:04:09.8169770Z", "eventRecordID": "24485890", "processID": "516", "threadID": "3340", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Information:\n\tLogon Type:\t\t3\n\tRestricted Admin Mode:\t-\n\tVirtual Account:\t\tNo\n\tElevated Token:\t\tYes\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC.LAN\n\tLogon ID:\t\t0x11B9EA1F\n\tLinked Logon ID:\t\t0x0\n\tNetwork Account Name:\t-\n\tNetwork Account Domain:\t-\n\tLogon GUID:\t\t{2e27f4d2-9160-b54c-343c-401d95b8537e}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.23.9\n\tSource Port:\t\t55750\n\nDetailed Authentication Information:\n\tLogon Process:\t\tKerberos\n\tAuthentication Package:\tKerberos\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\t-\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC.LAN", "targetLogonId": "0x11b9ea1f", "logonType": "3", "logonProcessName": "Kerberos", "authenticationPackageName": "Kerberos", "logonGuid": "{2e27f4d2-9160-b54c-343c-401d95b8537e}", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.23.9", "ipPort": "55750", "impersonationLevel": "%%1833", "virtualAccount": "%%1843", "targetLinkedLogonId": "0x0", "elevatedToken": "%%1842"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4663_task_manager_used_to_dump_lsass_process(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4663", "version": "1", "level": "0", "task": "12802", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-11-04T10:47:07.3599296Z", "eventRecordID": "38745", "processID": "4", "threadID": "248", "channel": "Security", "computer": "AD01.kdmo.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to access an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-1089590679-3038349081-645448463-500\n\tAccount Name:\t\tAdministrator\n\tAccount Domain:\t\tKDMO\n\tLogon ID:\t\t0x6007A\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tProcess\n\tObject Name:\t\t\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe\n\tHandle ID:\t\t0x9ec\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x110c\n\tProcess Name:\t\tC:\\Windows\\System32\\Taskmgr.exe\n\nAccess Request Information:\n\tAccesses:\t\tRead from process memory\n\t\t\t\t\n\tAccess Mask:\t\t0x10"}, "eventdata": {"subjectUserSid": "S-1-5-21-1089590679-3038349081-645448463-500", "subjectUserName": "Administrator", "subjectDomainName": "KDMO", "subjectLogonId": "0x6007a", "objectServer": "Security", "objectType": "Process", "objectName": "\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe", "handleId": "0x9ec", "accessList": "%%4484", "accessMask": "0x10", "processId": "0x110c", "processName": "C:\\Windows\\System32\\Taskmgr.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4663", "version": "1", "level": "0", "task": "12802", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2022-11-04T10:47:07.3606636Z", "eventRecordID": "38746", "processID": "4", "threadID": "248", "channel": "Security", "computer": "AD01.kdmo.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to access an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-1089590679-3038349081-645448463-500\n\tAccount Name:\t\tAdministrator\n\tAccount Domain:\t\tKDMO\n\tLogon ID:\t\t0x6007A\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tProcess\n\tObject Name:\t\t\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe\n\tHandle ID:\t\t0x89c\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0x110c\n\tProcess Name:\t\tC:\\Windows\\System32\\Taskmgr.exe\n\nAccess Request Information:\n\tAccesses:\t\tRead from process memory\n\t\t\t\t\n\tAccess Mask:\t\t0x10"}, "eventdata": {"subjectUserSid": "S-1-5-21-1089590679-3038349081-645448463-500", "subjectUserName": "Administrator", "subjectDomainName": "KDMO", "subjectLogonId": "0x6007a", "objectServer": "Security", "objectType": "Process", "objectName": "\\Device\\HarddiskVolume4\\Windows\\System32\\lsass.exe", "handleId": "0x89c", "accessList": "%%4484", "accessMask": "0x10", "processId": "0x110c", "processName": "C:\\Windows\\System32\\Taskmgr.exe"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4688_4663_4656_lsass_dump_with_lsassy_process(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4672", "version": "0", "level": "0", "task": "12548", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:09.7581469Z", "eventRecordID": "67732", "processID": "512", "threadID": "1868", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Special privileges assigned to new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BDFAC\n\nPrivileges:\t\tSeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26bdfac", "privilegeList": "SeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "1", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:09.7581469Z", "eventRecordID": "67733", "processID": "512", "threadID": "1868", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Type:\t\t\t3\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BDFAC\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.123.11\n\tSource Port:\t\t49192\n\nDetailed Authentication Information:\n\tLogon Process:\t\tNtLmSsp \n\tAuthentication Package:\tNTLM\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\tNTLM V2\n\tKey Length:\t\t0\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0x26bdfac", "logonType": "3", "logonProcessName": "NtLmSsp", "authenticationPackageName": "NTLM", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "lmPackageName": "NTLM V2", "keyLength": "0", "processId": "0x0", "ipAddress": "10.23.123.11", "ipPort": "49192", "impersonationLevel": "%%1833"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4672", "version": "0", "level": "0", "task": "12548", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:09.7737714Z", "eventRecordID": "67736", "processID": "512", "threadID": "1868", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Special privileges assigned to new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BDFDE\n\nPrivileges:\t\tSeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26bdfde", "privilegeList": "SeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "1", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:09.7737714Z", "eventRecordID": "67737", "processID": "512", "threadID": "1868", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Type:\t\t\t3\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BDFDE\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.123.11\n\tSource Port:\t\t38940\n\nDetailed Authentication Information:\n\tLogon Process:\t\tNtLmSsp \n\tAuthentication Package:\tNTLM\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\tNTLM V2\n\tKey Length:\t\t128\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0x26bdfde", "logonType": "3", "logonProcessName": "NtLmSsp", "authenticationPackageName": "NTLM", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "lmPackageName": "NTLM V2", "keyLength": "128", "processId": "0x0", "ipAddress": "10.23.123.11", "ipPort": "38940", "impersonationLevel": "%%1833"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4672", "version": "0", "level": "0", "task": "12548", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:09.8362732Z", "eventRecordID": "67739", "processID": "512", "threadID": "1868", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Special privileges assigned to new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE000\n\nPrivileges:\t\tSeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26be000", "privilegeList": "SeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "1", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:09.8362732Z", "eventRecordID": "67740", "processID": "512", "threadID": "1868", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Type:\t\t\t3\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE000\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.123.11\n\tSource Port:\t\t54742\n\nDetailed Authentication Information:\n\tLogon Process:\t\tNtLmSsp \n\tAuthentication Package:\tNTLM\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\tNTLM V2\n\tKey Length:\t\t128\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0x26be000", "logonType": "3", "logonProcessName": "NtLmSsp", "authenticationPackageName": "NTLM", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "lmPackageName": "NTLM V2", "keyLength": "128", "processId": "0x0", "ipAddress": "10.23.123.11", "ipPort": "54742", "impersonationLevel": "%%1833"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4672", "version": "0", "level": "0", "task": "12548", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:09.8987796Z", "eventRecordID": "67742", "processID": "512", "threadID": "1868", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Special privileges assigned to new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE01F\n\nPrivileges:\t\tSeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26be01f", "privilegeList": "SeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "1", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:09.8987796Z", "eventRecordID": "67743", "processID": "512", "threadID": "1868", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Type:\t\t\t3\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE01F\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.123.11\n\tSource Port:\t\t54742\n\nDetailed Authentication Information:\n\tLogon Process:\t\tNtLmSsp \n\tAuthentication Package:\tNTLM\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\tNTLM V2\n\tKey Length:\t\t128\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0x26be01f", "logonType": "3", "logonProcessName": "NtLmSsp", "authenticationPackageName": "NTLM", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "lmPackageName": "NTLM V2", "keyLength": "128", "processId": "0x0", "ipAddress": "10.23.123.11", "ipPort": "54742", "impersonationLevel": "%%1833"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4672", "version": "0", "level": "0", "task": "12548", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:09.9612757Z", "eventRecordID": "67745", "processID": "512", "threadID": "1868", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "Special privileges assigned to new logon.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE03C\n\nPrivileges:\t\tSeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26be03c", "privilegeList": "SeSecurityPrivilege\n\t\t\tSeBackupPrivilege\n\t\t\tSeRestorePrivilege\n\t\t\tSeTakeOwnershipPrivilege\n\t\t\tSeDebugPrivilege\n\t\t\tSeSystemEnvironmentPrivilege\n\t\t\tSeLoadDriverPrivilege\n\t\t\tSeImpersonatePrivilege"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4624", "version": "1", "level": "0", "task": "12544", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:09.9612757Z", "eventRecordID": "67746", "processID": "512", "threadID": "1868", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An account was successfully logged on.\n\nSubject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nLogon Type:\t\t\t3\n\nImpersonation Level:\t\tImpersonation\n\nNew Logon:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE03C\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\n\nProcess Information:\n\tProcess ID:\t\t0x0\n\tProcess Name:\t\t-\n\nNetwork Information:\n\tWorkstation Name:\t-\n\tSource Network Address:\t10.23.123.11\n\tSource Port:\t\t54742\n\nDetailed Authentication Information:\n\tLogon Process:\t\tNtLmSsp \n\tAuthentication Package:\tNTLM\n\tTransited Services:\t-\n\tPackage Name (NTLM only):\tNTLM V2\n\tKey Length:\t\t128\n\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\n\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\n\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\n\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\n\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\n\nThe impersonation level field indicates the extent to which a process in the logon session can impersonate.\n\nThe authentication information fields provide detailed information about this specific logon request.\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\n\t- Transited services indicate which intermediate services have participated in this logon request.\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."}, "eventdata": {"subjectUserSid": "S-1-0-0", "subjectLogonId": "0x0", "targetUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0x26be03c", "logonType": "3", "logonProcessName": "NtLmSsp", "authenticationPackageName": "NTLM", "logonGuid": "{00000000-0000-0000-0000-000000000000}", "lmPackageName": "NTLM V2", "keyLength": "128", "processId": "0x0", "ipAddress": "10.23.123.11", "ipPort": "54742", "impersonationLevel": "%%1833"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:10.2143858Z", "eventRecordID": "67747", "processID": "4", "threadID": "2304", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-20\n\tAccount Name:\t\tFS03$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E4\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE03C\n\nProcess Information:\n\tNew Process ID:\t\t0x998\n\tNew Process Name:\tC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\t%15\n\tCreator Process ID:\t%8\n\tCreator Process Name:\t%14!S!\n\tProcess Command Line:\t%9!S!\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-20", "subjectUserName": "FS03$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e4", "newProcessId": "0x998", "newProcessName": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "tokenElevationType": "%%1936", "processId": "0x668", "commandLine": "powershell.exe -NoP -C \"C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\2V7Be7Gq.dmp full;Wait-Process -Id (Get-Process rundll32).id\"", "targetUserSid": "S-1-0-0", "targetUserName": "admmig", "targetDomainName": "OFFSEC", "targetLogonId": "0x26be03c"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:10.2143858Z", "eventRecordID": "67748", "processID": "4", "threadID": "2304", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE03C\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x234\n\tNew Process Name:\tC:\\Windows\\System32\\conhost.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\t%15\n\tCreator Process ID:\t%8\n\tCreator Process Name:\t%14!S!\n\tProcess Command Line:\t%9!S!\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26be03c", "newProcessId": "0x234", "newProcessName": "C:\\Windows\\System32\\conhost.exe", "tokenElevationType": "%%1936", "processId": "0x998", "commandLine": "\\??\\C:\\Windows\\system32\\conhost.exe 0xffffffff", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:10.2143858Z", "eventRecordID": "67750", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BDFAC\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t49192\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tWindows\\Temp\\2V7Be7Gq.dmp\n\nAccess Request Information:\n\tAccess Mask:\t\t0x1\n\tAccesses:\t\tReadData (or ListDirectory)\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26bdfac", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "49192", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Windows\\Temp\\2V7Be7Gq.dmp", "accessMask": "0x1", "accessList": "%%4416"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:10.5268992Z", "eventRecordID": "67790", "processID": "4", "threadID": "4040", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE03C\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0xff8\n\tNew Process Name:\tC:\\Windows\\System32\\rundll32.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\t%15\n\tCreator Process ID:\t%8\n\tCreator Process Name:\t%14!S!\n\tProcess Command Line:\t%9!S!\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26be03c", "newProcessId": "0xff8", "newProcessName": "C:\\Windows\\System32\\rundll32.exe", "tokenElevationType": "%%1936", "processId": "0x998", "commandLine": "\"C:\\Windows\\System32\\rundll32.exe\"  C:\\Windows\\System32\\comsvcs.dll MiniDump 512 \\Windows\\Temp\\2V7Be7Gq.dmp full", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12802", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:10.5425177Z", "eventRecordID": "67793", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE03C\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tProcess\n\tObject Name:\t\t\\Device\\HarddiskVolume2\\Windows\\System32\\lsass.exe\n\tHandle ID:\t\t0xdc\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0xff8\n\tProcess Name:\t\tC:\\Windows\\System32\\rundll32.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tRead from process memory\n\t\t\t\tQuery process information\n\t\t\t\tUndefined Access (no effect) Bit 12\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x1410\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26be03c", "objectServer": "Security", "objectType": "Process", "objectName": "\\Device\\HarddiskVolume2\\Windows\\System32\\lsass.exe", "handleId": "0xdc", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%4484\n\t\t\t\t%%4490\n\t\t\t\t%%4492", "accessMask": "0x1410", "restrictedSidCount": "0", "processId": "0xff8", "processName": "C:\\Windows\\System32\\rundll32.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4656", "version": "1", "level": "0", "task": "12802", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:10.5425177Z", "eventRecordID": "67796", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A handle to an object was requested.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE03C\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tProcess\n\tObject Name:\t\t\\Device\\HarddiskVolume2\\Windows\\System32\\lsass.exe\n\tHandle ID:\t\t0xf0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0xff8\n\tProcess Name:\t\tC:\\Windows\\System32\\rundll32.exe\n\nAccess Request Information:\n\tTransaction ID:\t\t{00000000-0000-0000-0000-000000000000}\n\tAccesses:\t\tDELETE\n\t\t\t\tREAD_CONTROL\n\t\t\t\tWRITE_DAC\n\t\t\t\tWRITE_OWNER\n\t\t\t\tSYNCHRONIZE\n\t\t\t\tForce process termination\n\t\t\t\tCreate new thread in process\n\t\t\t\tSet process session ID\n\t\t\t\tPerform virtual memory operation\n\t\t\t\tRead from process memory\n\t\t\t\tWrite to process memory\n\t\t\t\tDuplicate handle into or out of process\n\t\t\t\tCreate a subprocess of process\n\t\t\t\tSet process quotas\n\t\t\t\tSet process information\n\t\t\t\tQuery process information\n\t\t\t\tSet process termination port\n\t\t\t\tUndefined Access (no effect) Bit 12\n\t\t\t\tUndefined Access (no effect) Bit 13\n\t\t\t\tUndefined Access (no effect) Bit 14\n\t\t\t\tUndefined Access (no effect) Bit 15\n\t\t\t\t\n\tAccess Reasons:\t\t-\n\tAccess Mask:\t\t0x1FFFFF\n\tPrivileges Used for Access Check:\t-\n\tRestricted SID Count:\t0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26be03c", "objectServer": "Security", "objectType": "Process", "objectName": "\\Device\\HarddiskVolume2\\Windows\\System32\\lsass.exe", "handleId": "0xf0", "transactionId": "{00000000-0000-0000-0000-000000000000}", "accessList": "%%1537\n\t\t\t\t%%1538\n\t\t\t\t%%1539\n\t\t\t\t%%1540\n\t\t\t\t%%1541\n\t\t\t\t%%4480\n\t\t\t\t%%4481\n\t\t\t\t%%4482\n\t\t\t\t%%4483\n\t\t\t\t%%4484\n\t\t\t\t%%4485\n\t\t\t\t%%4486\n\t\t\t\t%%4487\n\t\t\t\t%%4488\n\t\t\t\t%%4489\n\t\t\t\t%%4490\n\t\t\t\t%%4491\n\t\t\t\t%%4492\n\t\t\t\t%%4493\n\t\t\t\t%%4494\n\t\t\t\t%%4495", "accessMask": "0x1fffff", "restrictedSidCount": "0", "processId": "0xff8", "processName": "C:\\Windows\\System32\\rundll32.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4663", "version": "1", "level": "0", "task": "12802", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:10.5425177Z", "eventRecordID": "67797", "processID": "4", "threadID": "4040", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to access an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE03C\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tProcess\n\tObject Name:\t\t\\Device\\HarddiskVolume2\\Windows\\System32\\lsass.exe\n\tHandle ID:\t\t0xf0\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0xff8\n\tProcess Name:\t\tC:\\Windows\\System32\\rundll32.exe\n\nAccess Request Information:\n\tAccesses:\t\tRead from process memory\n\t\t\t\t\n\tAccess Mask:\t\t0x10"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26be03c", "objectServer": "Security", "objectType": "Process", "objectName": "\\Device\\HarddiskVolume2\\Windows\\System32\\lsass.exe", "handleId": "0xf0", "accessList": "%%4484", "accessMask": "0x10", "processId": "0xff8", "processName": "C:\\Windows\\System32\\rundll32.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4663", "version": "1", "level": "0", "task": "12802", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:10.5425177Z", "eventRecordID": "67799", "processID": "4", "threadID": "4040", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to access an object.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BE03C\n\nObject:\n\tObject Server:\t\tSecurity\n\tObject Type:\t\tProcess\n\tObject Name:\t\t\\Device\\HarddiskVolume2\\Windows\\System32\\lsass.exe\n\tHandle ID:\t\t0xdc\n\tResource Attributes:\t-\n\nProcess Information:\n\tProcess ID:\t\t0xff8\n\tProcess Name:\t\tC:\\Windows\\System32\\rundll32.exe\n\nAccess Request Information:\n\tAccesses:\t\tRead from process memory\n\t\t\t\t\n\tAccess Mask:\t\t0x10"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26be03c", "objectServer": "Security", "objectType": "Process", "objectName": "\\Device\\HarddiskVolume2\\Windows\\System32\\lsass.exe", "handleId": "0xdc", "accessList": "%%4484", "accessMask": "0x10", "processId": "0xff8", "processName": "C:\\Windows\\System32\\rundll32.exe"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:11.2300346Z", "eventRecordID": "67801", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BDFAC\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t49192\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tWindows\\Temp\\2V7Be7Gq.dmp\n\nAccess Request Information:\n\tAccess Mask:\t\t0x1\n\tAccesses:\t\tReadData (or ListDirectory)\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26bdfac", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "49192", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Windows\\Temp\\2V7Be7Gq.dmp", "accessMask": "0x1", "accessList": "%%4416"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:11.4994071Z", "eventRecordID": "67802", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x262BB6B\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t61966\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\t\\\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100081\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x262bb6b", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "61966", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "\\", "accessMask": "0x100081", "accessList": "%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:12.5530642Z", "eventRecordID": "67803", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x26BDFAC\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.123.11\n\tSource Port:\t\t49192\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tWindows\\Temp\\2V7Be7Gq.dmp\n\nAccess Request Information:\n\tAccess Mask:\t\t0x10080\n\tAccesses:\t\tDELETE\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x26bdfac", "objectType": "File", "ipAddress": "10.23.123.11", "ipPort": "49192", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Windows\\Temp\\2V7Be7Gq.dmp", "accessMask": "0x10080", "accessList": "%%1537\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:13.7250055Z", "eventRecordID": "67804", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x262BB6B\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t61966\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\t\\\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100081\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x262bb6b", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "61966", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "\\", "accessMask": "0x100081", "accessList": "%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:13.7250055Z", "eventRecordID": "67805", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x262BB6B\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t61964\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tSysmon\\desktop.ini\n\nAccess Request Information:\n\tAccess Mask:\t\t0x120089\n\tAccesses:\t\tREAD_CONTROL\n\t\t\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadEA\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x262bb6b", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "61964", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Sysmon\\desktop.ini", "accessMask": "0x120089", "accessList": "%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4419\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:15.6157798Z", "eventRecordID": "67806", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x262BB6B\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t61962\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\t\\\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100081\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x262bb6b", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "61962", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "\\", "accessMask": "0x100081", "accessList": "%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:18.3188262Z", "eventRecordID": "67807", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x262BB6B\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t61962\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\t\\\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100081\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x262bb6b", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "61962", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "\\", "accessMask": "0x100081", "accessList": "%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:22.2917996Z", "eventRecordID": "67808", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x262BB6B\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t61962\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\t\\\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100081\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x262bb6b", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "61962", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "\\", "accessMask": "0x100081", "accessList": "%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:22.2917996Z", "eventRecordID": "67809", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x262BB6B\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t61965\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\tSysmon\\desktop.ini\n\nAccess Request Information:\n\tAccess Mask:\t\t0x120089\n\tAccesses:\t\tREAD_CONTROL\n\t\t\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadEA\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x262bb6b", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "61965", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "Sysmon\\desktop.ini", "accessMask": "0x120089", "accessList": "%%1538\n\t\t\t\t%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4419\n\t\t\t\t%%4423"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "5145", "version": "0", "level": "0", "task": "12811", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-10-20T14:29:25.6249889Z", "eventRecordID": "67810", "processID": "512", "threadID": "520", "channel": "Security", "computer": "FS03.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A network share object was checked to see whether client can be granted desired access.\n\t\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x262BB6B\n\nNetwork Information:\t\n\tObject Type:\t\tFile\n\tSource Address:\t\t10.23.23.9\n\tSource Port:\t\t61964\n\t\nShare Information:\n\tShare Name:\t\t\\\\*\\C$\n\tShare Path:\t\t\\??\\C:\\\n\tRelative Target Name:\t\\\n\nAccess Request Information:\n\tAccess Mask:\t\t0x100081\n\tAccesses:\t\tSYNCHRONIZE\n\t\t\t\tReadData (or ListDirectory)\n\t\t\t\tReadAttributes\n\t\t\t\t\nAccess Check Results:\n\t-"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x262bb6b", "objectType": "File", "ipAddress": "10.23.23.9", "ipPort": "61964", "shareName": "\\\\*\\C$", "shareLocalPath": "\\??\\C:\\", "relativeTargetName": "\\", "accessMask": "0x100081", "accessList": "%%1541\n\t\t\t\t%%4416\n\t\t\t\t%%4423"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4688_diskshadow_abuse(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-06-05T20:17:05.4339841Z", "eventRecordID": "155520909", "processID": "4", "threadID": "2736", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xA8A1627A\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0xda8\n\tNew Process Name:\tC:\\Windows\\System32\\diskshadow.exe\n\tToken Elevation Type:\t%%1937\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x11c0\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tdiskshadow.exe  /s shadow.txt\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xa8a1627a", "newProcessId": "0xda8", "newProcessName": "C:\\Windows\\System32\\diskshadow.exe", "tokenElevationType": "%%1937", "processId": "0x11c0", "commandLine": "diskshadow.exe  /s shadow.txt", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-06-05T20:17:05.4684549Z", "eventRecordID": "155520914", "processID": "4", "threadID": "2736", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x1acc\n\tNew Process Name:\tC:\\Windows\\System32\\VSSVC.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x21c\n\tCreator Process Name:\tC:\\Windows\\System32\\services.exe\n\tProcess Command Line:\tC:\\Windows\\system32\\vssvc.exe\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x1acc", "newProcessName": "C:\\Windows\\System32\\VSSVC.exe", "tokenElevationType": "%%1936", "processId": "0x21c", "commandLine": "C:\\Windows\\system32\\vssvc.exe", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\services.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-06-05T20:17:06.2094153Z", "eventRecordID": "155520974", "processID": "4", "threadID": "4700", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x3d0\n\tNew Process Name:\tC:\\Windows\\System32\\SearchProtocolHost.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0xa38\n\tCreator Process Name:\tC:\\Windows\\System32\\SearchIndexer.exe\n\tProcess Command Line:\t\"C:\\Windows\\system32\\SearchProtocolHost.exe\" Global\\UsGthrFltPipeMssGthrPipe63_ Global\\UsGthrCtrlFltPipeMssGthrPipe63 1 -2147483646 \"Software\\Microsoft\\Windows Search\" \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT; MS Search 4.0 Robot)\" \"C:\\ProgramData\\Microsoft\\Search\\Data\\Temp\\usgthrsvc\" \"DownLevelDaemon\" \n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x3d0", "newProcessName": "C:\\Windows\\System32\\SearchProtocolHost.exe", "tokenElevationType": "%%1936", "processId": "0xa38", "commandLine": "\"C:\\Windows\\system32\\SearchProtocolHost.exe\" Global\\UsGthrFltPipeMssGthrPipe63_ Global\\UsGthrCtrlFltPipeMssGthrPipe63 1 -2147483646 \"Software\\Microsoft\\Windows Search\" \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT; MS Search 4.0 Robot)\" \"C:\\ProgramData\\Microsoft\\Search\\Data\\Temp\\usgthrsvc\" \"DownLevelDaemon\"", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\SearchIndexer.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-06-05T20:17:06.2591581Z", "eventRecordID": "155520978", "processID": "4", "threadID": "3540", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x11cc\n\tNew Process Name:\tC:\\Windows\\System32\\SearchFilterHost.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-8192\n\tCreator Process ID:\t0xa38\n\tCreator Process Name:\tC:\\Windows\\System32\\SearchIndexer.exe\n\tProcess Command Line:\t\"C:\\Windows\\system32\\SearchFilterHost.exe\" 0 648 652 660 8192 656 \n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x11cc", "newProcessName": "C:\\Windows\\System32\\SearchFilterHost.exe", "tokenElevationType": "%%1936", "processId": "0xa38", "commandLine": "\"C:\\Windows\\system32\\SearchFilterHost.exe\" 0 648 652 660 8192 656", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\SearchIndexer.exe", "mandatoryLabel": "S-1-16-8192"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4688_ifm_created(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-06-05T19:35:16.7217815Z", "eventRecordID": "155496214", "processID": "4", "threadID": "4700", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xA8A1627A\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x724\n\tNew Process Name:\tC:\\Windows\\System32\\ntdsutil.exe\n\tToken Elevation Type:\t%%1937\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x11c0\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tntdsutil.exe  'ac i ntds' 'ifm' 'create full c:\\hacker' q q\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xa8a1627a", "newProcessId": "0x724", "newProcessName": "C:\\Windows\\System32\\ntdsutil.exe", "tokenElevationType": "%%1937", "processId": "0x11c0", "commandLine": "ntdsutil.exe  'ac i ntds' 'ifm' 'create full c:\\hacker' q q", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-06-05T19:36:20.9767079Z", "eventRecordID": "155496369", "processID": "4", "threadID": "3540", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x19cc\n\tNew Process Name:\tC:\\Windows\\System32\\taskhostw.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0x490\n\tCreator Process Name:\tC:\\Windows\\System32\\svchost.exe\n\tProcess Command Line:\ttaskhostw.exe SYSTEM\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x19cc", "newProcessName": "C:\\Windows\\System32\\taskhostw.exe", "tokenElevationType": "%%1936", "processId": "0x490", "commandLine": "taskhostw.exe SYSTEM", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\svchost.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-06-05T19:36:32.6837793Z", "eventRecordID": "155497352", "processID": "4", "threadID": "568", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xA8A1627A\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x1bec\n\tNew Process Name:\tC:\\Windows\\System32\\ntdsutil.exe\n\tToken Elevation Type:\t%%1937\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x11c0\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tntdsutil  \"activate instance ntds\" ifm \"create full c:\\hacker\" quit quit\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xa8a1627a", "newProcessId": "0x1bec", "newProcessName": "C:\\Windows\\System32\\ntdsutil.exe", "tokenElevationType": "%%1937", "processId": "0x11c0", "commandLine": "ntdsutil  \"activate instance ntds\" ifm \"create full c:\\hacker\" quit quit", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-06-05T19:36:34.6530358Z", "eventRecordID": "155498559", "processID": "4", "threadID": "4700", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x1978\n\tNew Process Name:\tC:\\Windows\\System32\\SearchProtocolHost.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-16384\n\tCreator Process ID:\t0xa38\n\tCreator Process Name:\tC:\\Windows\\System32\\SearchIndexer.exe\n\tProcess Command Line:\t\"C:\\Windows\\system32\\SearchProtocolHost.exe\" Global\\UsGthrFltPipeMssGthrPipe57_ Global\\UsGthrCtrlFltPipeMssGthrPipe57 1 -2147483646 \"Software\\Microsoft\\Windows Search\" \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT; MS Search 4.0 Robot)\" \"C:\\ProgramData\\Microsoft\\Search\\Data\\Temp\\usgthrsvc\" \"DownLevelDaemon\" \n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x1978", "newProcessName": "C:\\Windows\\System32\\SearchProtocolHost.exe", "tokenElevationType": "%%1936", "processId": "0xa38", "commandLine": "\"C:\\Windows\\system32\\SearchProtocolHost.exe\" Global\\UsGthrFltPipeMssGthrPipe57_ Global\\UsGthrCtrlFltPipeMssGthrPipe57 1 -2147483646 \"Software\\Microsoft\\Windows Search\" \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT; MS Search 4.0 Robot)\" \"C:\\ProgramData\\Microsoft\\Search\\Data\\Temp\\usgthrsvc\" \"DownLevelDaemon\"", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\SearchIndexer.exe", "mandatoryLabel": "S-1-16-16384"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-06-05T19:36:34.6887113Z", "eventRecordID": "155498563", "processID": "4", "threadID": "5624", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tROOTDC1$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x1798\n\tNew Process Name:\tC:\\Windows\\System32\\SearchFilterHost.exe\n\tToken Elevation Type:\t%%1936\n\tMandatory Label:\t\tS-1-16-8192\n\tCreator Process ID:\t0xa38\n\tCreator Process Name:\tC:\\Windows\\System32\\SearchIndexer.exe\n\tProcess Command Line:\t\"C:\\Windows\\system32\\SearchFilterHost.exe\" 0 648 652 660 8192 656 \n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "ROOTDC1$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x1798", "newProcessName": "C:\\Windows\\System32\\SearchFilterHost.exe", "tokenElevationType": "%%1936", "processId": "0xa38", "commandLine": "\"C:\\Windows\\system32\\SearchFilterHost.exe\" 0 648 652 660 8192 656", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\SearchIndexer.exe", "mandatoryLabel": "S-1-16-8192"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4688_task_manager_access_indicator_for_potential_lsass_dump(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "1", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T20:59:20.0449578Z", "eventRecordID": "1071922", "processID": "4", "threadID": "364", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x83F9EC\n\nProcess Information:\n\tNew Process ID:\t\t0xdac\n\tNew Process Name:\tC:\\Windows\\System32\\Taskmgr.exe\n\tToken Elevation Type:\tTokenElevationTypeLimited (3)\n\tCreator Process ID:\t0x874\n\tProcess Command Line:\t\"C:\\Windows\\system32\\taskmgr.exe\" /4\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x83f9ec", "newProcessId": "0xdac", "newProcessName": "C:\\Windows\\System32\\Taskmgr.exe", "tokenElevationType": "%%1938", "processId": "0x874", "commandLine": "\"C:\\Windows\\system32\\taskmgr.exe\" /4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "1", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T20:59:20.0449578Z", "eventRecordID": "1071923", "processID": "4", "threadID": "364", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS03VULN$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nProcess Information:\n\tNew Process ID:\t\t0x12a0\n\tNew Process Name:\tC:\\Windows\\System32\\consent.exe\n\tToken Elevation Type:\tTokenElevationTypeDefault (1)\n\tCreator Process ID:\t0x2e8\n\tProcess Command Line:\tconsent.exe 744 308 000000E3A2F6EE10\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS03VULN$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x12a0", "newProcessName": "C:\\Windows\\System32\\consent.exe", "tokenElevationType": "%%1936", "processId": "0x2e8", "commandLine": "consent.exe 744 308 000000E3A2F6EE10"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "1", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T20:59:20.1387079Z", "eventRecordID": "1071929", "processID": "4", "threadID": "4440", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS03VULN$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nProcess Information:\n\tNew Process ID:\t\t0x100\n\tNew Process Name:\tC:\\Windows\\System32\\Taskmgr.exe\n\tToken Elevation Type:\tTokenElevationTypeFull (2)\n\tCreator Process ID:\t0x874\n\tProcess Command Line:\t\"C:\\Windows\\system32\\taskmgr.exe\" /4\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS03VULN$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x100", "newProcessName": "C:\\Windows\\System32\\Taskmgr.exe", "tokenElevationType": "%%1937", "processId": "0x874", "commandLine": "\"C:\\Windows\\system32\\taskmgr.exe\" /4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "1", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T20:59:28.9219654Z", "eventRecordID": "1071931", "processID": "4", "threadID": "364", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS03VULN$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nProcess Information:\n\tNew Process ID:\t\t0xf34\n\tNew Process Name:\tC:\\Windows\\System32\\LaunchTM.exe\n\tToken Elevation Type:\tTokenElevationTypeLimited (3)\n\tCreator Process ID:\t0x680\n\tProcess Command Line:\tlaunchtm.exe /2 \n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS03VULN$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0xf34", "newProcessName": "C:\\Windows\\System32\\LaunchTM.exe", "tokenElevationType": "%%1938", "processId": "0x680", "commandLine": "launchtm.exe /2"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "1", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T20:59:28.9375833Z", "eventRecordID": "1071932", "processID": "4", "threadID": "4440", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x83F9EC\n\nProcess Information:\n\tNew Process ID:\t\t0x7b0\n\tNew Process Name:\tC:\\Windows\\System32\\Taskmgr.exe\n\tToken Elevation Type:\tTokenElevationTypeLimited (3)\n\tCreator Process ID:\t0xf34\n\tProcess Command Line:\t\"C:\\Windows\\System32\\Taskmgr.exe\" /2 \n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x83f9ec", "newProcessId": "0x7b0", "newProcessName": "C:\\Windows\\System32\\Taskmgr.exe", "tokenElevationType": "%%1938", "processId": "0xf34", "commandLine": "\"C:\\Windows\\System32\\Taskmgr.exe\" /2"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "1", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T20:59:28.9532105Z", "eventRecordID": "1071933", "processID": "4", "threadID": "4440", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS03VULN$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nProcess Information:\n\tNew Process ID:\t\t0xcd0\n\tNew Process Name:\tC:\\Windows\\System32\\consent.exe\n\tToken Elevation Type:\tTokenElevationTypeDefault (1)\n\tCreator Process ID:\t0x2e8\n\tProcess Command Line:\tconsent.exe 744 310 000000E3A2F6F950\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS03VULN$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0xcd0", "newProcessName": "C:\\Windows\\System32\\consent.exe", "tokenElevationType": "%%1936", "processId": "0x2e8", "commandLine": "consent.exe 744 310 000000E3A2F6F950"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "1", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T20:59:29.0000841Z", "eventRecordID": "1071939", "processID": "4", "threadID": "4440", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS03VULN$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nProcess Information:\n\tNew Process ID:\t\t0xdb0\n\tNew Process Name:\tC:\\Windows\\System32\\Taskmgr.exe\n\tToken Elevation Type:\tTokenElevationTypeFull (2)\n\tCreator Process ID:\t0xf34\n\tProcess Command Line:\t\"C:\\Windows\\System32\\Taskmgr.exe\" /2 \n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS03VULN$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0xdb0", "newProcessName": "C:\\Windows\\System32\\Taskmgr.exe", "tokenElevationType": "%%1937", "processId": "0xf34", "commandLine": "\"C:\\Windows\\System32\\Taskmgr.exe\" /2"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "1", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T20:59:31.4034742Z", "eventRecordID": "1071941", "processID": "4", "threadID": "4440", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS03VULN$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nProcess Information:\n\tNew Process ID:\t\t0x13a4\n\tNew Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tToken Elevation Type:\tTokenElevationTypeDefault (1)\n\tCreator Process ID:\t0x2e8\n\tProcess Command Line:\tC:\\Windows\\SYSTEM32\\cmd.exe /c \"C:\\tools\\shell.cmd\"\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS03VULN$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0x13a4", "newProcessName": "C:\\Windows\\System32\\cmd.exe", "tokenElevationType": "%%1936", "processId": "0x2e8", "commandLine": "C:\\Windows\\SYSTEM32\\cmd.exe /c \"C:\\tools\\shell.cmd\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "1", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-12-04T20:59:31.4034742Z", "eventRecordID": "1071942", "processID": "4", "threadID": "4440", "channel": "Security", "computer": "fs03vuln.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-18\n\tAccount Name:\t\tFS03VULN$\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x3E7\n\nProcess Information:\n\tNew Process ID:\t\t0xa48\n\tNew Process Name:\tC:\\Windows\\System32\\conhost.exe\n\tToken Elevation Type:\tTokenElevationTypeDefault (1)\n\tCreator Process ID:\t0x13a4\n\tProcess Command Line:\t\\??\\C:\\Windows\\system32\\conhost.exe 0xffffffff\n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-18", "subjectUserName": "FS03VULN$", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x3e7", "newProcessId": "0xa48", "newProcessName": "C:\\Windows\\System32\\conhost.exe", "tokenElevationType": "%%1936", "processId": "0x13a4", "commandLine": "\\??\\C:\\Windows\\system32\\conhost.exe 0xffffffff"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4756_exchange_critical_group_change_dcsync(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T15:41:44.6514590Z", "eventRecordID": "102640504", "processID": "556", "threadID": "2088", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC336506\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1204\n\tAccount Name:\t\tExchange Servers\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Exchange Servers", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1204", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc336506"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T15:41:44.6544157Z", "eventRecordID": "102640507", "processID": "556", "threadID": "972", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC336506\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1205\n\tAccount Name:\t\tExchange Trusted Subsystem\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Exchange Trusted Subsystem", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1205", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc336506"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4756", "version": "0", "level": "0", "task": "13826", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2021-02-02T15:41:44.6644215Z", "eventRecordID": "102640510", "processID": "556", "threadID": "972", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A member was added to a security-enabled universal group.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0xC336506\n\nMember:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1147\n\tAccount Name:\t\tCN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan\n\nGroup:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1207\n\tAccount Name:\t\tExchange Windows Permissions\n\tAccount Domain:\t\tOFFSEC\n\nAdditional Information:\n\tPrivileges:\t\t-"}, "eventdata": {"memberName": "CN=admin-hacker,OU=Test-OU,OU=OFFSEC-COMPANY,DC=offsec,DC=lan", "memberSid": "S-1-5-21-4230534742-2542757381-3142984815-1147", "targetUserName": "Exchange Windows Permissions", "targetDomainName": "OFFSEC", "targetSid": "S-1-5-21-4230534742-2542757381-3142984815-1207", "subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0xc336506"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id4794_4688_dsrm_password_set_with_ntdsutil(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4688", "version": "2", "level": "0", "task": "13312", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-13T08:34:13.2535414Z", "eventRecordID": "16569722", "processID": "4", "threadID": "4748", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "A new process has been created.\n\nCreator Subject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8EA64A3\n\nTarget Subject:\n\tSecurity ID:\t\tS-1-0-0\n\tAccount Name:\t\t-\n\tAccount Domain:\t\t-\n\tLogon ID:\t\t0x0\n\nProcess Information:\n\tNew Process ID:\t\t0x558\n\tNew Process Name:\tC:\\Windows\\System32\\ntdsutil.exe\n\tToken Elevation Type:\t%%1937\n\tMandatory Label:\t\tS-1-16-12288\n\tCreator Process ID:\t0x1728\n\tCreator Process Name:\tC:\\Windows\\System32\\cmd.exe\n\tProcess Command Line:\tntdsutil  \n\nToken Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\n\nType 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\n\nType 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\n\nType 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator."}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8ea64a3", "newProcessId": "0x558", "newProcessName": "C:\\Windows\\System32\\ntdsutil.exe", "tokenElevationType": "%%1937", "processId": "0x1728", "commandLine": "ntdsutil", "targetUserSid": "S-1-0-0", "targetLogonId": "0x0", "parentProcessName": "C:\\Windows\\System32\\cmd.exe", "mandatoryLabel": "S-1-16-12288"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-Security-Auditing", "providerGuid": "{54849625-5478-4994-a5ba-3e3b0328c30d}", "eventID": "4794", "version": "0", "level": "0", "task": "13824", "opcode": "0", "keywords": "0x8020000000000000", "systemTime": "2020-07-13T08:34:33.9153530Z", "eventRecordID": "16569750", "processID": "528", "threadID": "2796", "channel": "Security", "computer": "rootdc1.offsec.lan", "severityValue": "AUDIT_SUCCESS", "message": "An attempt was made to set the Directory Services Restore Mode\nadministrator password.\n\nSubject:\n\tSecurity ID:\t\tS-1-5-21-4230534742-2542757381-3142984815-1111\n\tAccount Name:\t\tadmmig\n\tAccount Domain:\t\tOFFSEC\n\tLogon ID:\t\t0x8EA64A3\n\nAdditional Information:\n\tCaller Workstation:\tROOTDC1\n\tStatus Code:\t0x0"}, "eventdata": {"subjectUserSid": "S-1-5-21-4230534742-2542757381-3142984815-1111", "subjectUserName": "admmig", "subjectDomainName": "OFFSEC", "subjectLogonId": "0x8ea64a3", "workstation": "ROOTDC1", "status": "0x0"}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")

    def test_id800_4103_4104_lsass_dump_with_lsassy_powershell(self) -> None:
        # Logs extracted from EVTX file
        logs = [
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "600", "level": "4", "task": "6", "keywords": "0x80000000000000", "systemTime": "2021-10-20T14:39:26.0000000Z", "eventRecordID": "126", "channel": "Windows PowerShell", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Provider \"Alias\" is Started. \n\nDetails: \n\tProviderName=Alias\n\tNewProviderState=Started\n\n\tSequenceNumber=1\n\n\tHostName=ConsoleHost\n\tHostVersion=4.0\n\tHostId=63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n\tHostApplication=powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "600", "level": "4", "task": "6", "keywords": "0x80000000000000", "systemTime": "2021-10-20T14:39:26.0000000Z", "eventRecordID": "127", "channel": "Windows PowerShell", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Provider \"Environment\" is Started. \n\nDetails: \n\tProviderName=Environment\n\tNewProviderState=Started\n\n\tSequenceNumber=3\n\n\tHostName=ConsoleHost\n\tHostVersion=4.0\n\tHostId=63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n\tHostApplication=powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "600", "level": "4", "task": "6", "keywords": "0x80000000000000", "systemTime": "2021-10-20T14:39:26.0000000Z", "eventRecordID": "128", "channel": "Windows PowerShell", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Provider \"FileSystem\" is Started. \n\nDetails: \n\tProviderName=FileSystem\n\tNewProviderState=Started\n\n\tSequenceNumber=5\n\n\tHostName=ConsoleHost\n\tHostVersion=4.0\n\tHostId=63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n\tHostApplication=powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "600", "level": "4", "task": "6", "keywords": "0x80000000000000", "systemTime": "2021-10-20T14:39:26.0000000Z", "eventRecordID": "129", "channel": "Windows PowerShell", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Provider \"Function\" is Started. \n\nDetails: \n\tProviderName=Function\n\tNewProviderState=Started\n\n\tSequenceNumber=7\n\n\tHostName=ConsoleHost\n\tHostVersion=4.0\n\tHostId=63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n\tHostApplication=powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "600", "level": "4", "task": "6", "keywords": "0x80000000000000", "systemTime": "2021-10-20T14:39:26.0000000Z", "eventRecordID": "130", "channel": "Windows PowerShell", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Provider \"Registry\" is Started. \n\nDetails: \n\tProviderName=Registry\n\tNewProviderState=Started\n\n\tSequenceNumber=9\n\n\tHostName=ConsoleHost\n\tHostVersion=4.0\n\tHostId=63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n\tHostApplication=powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "600", "level": "4", "task": "6", "keywords": "0x80000000000000", "systemTime": "2021-10-20T14:39:26.0000000Z", "eventRecordID": "131", "channel": "Windows PowerShell", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Provider \"Variable\" is Started. \n\nDetails: \n\tProviderName=Variable\n\tNewProviderState=Started\n\n\tSequenceNumber=11\n\n\tHostName=ConsoleHost\n\tHostVersion=4.0\n\tHostId=63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n\tHostApplication=powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n\tEngineVersion=\n\tRunspaceId=\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "400", "level": "4", "task": "4", "keywords": "0x80000000000000", "systemTime": "2021-10-20T14:39:26.0000000Z", "eventRecordID": "132", "channel": "Windows PowerShell", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Engine state is changed from None to Available. \n\nDetails: \n\tNewEngineState=Available\n\tPreviousEngineState=None\n\n\tSequenceNumber=13\n\n\tHostName=ConsoleHost\n\tHostVersion=4.0\n\tHostId=63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n\tHostApplication=powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n\tEngineVersion=4.0\n\tRunspaceId=1668d864-c13c-442c-bf70-3fe6a4dee2ca\n\tPipelineId=\n\tCommandName=\n\tCommandType=\n\tScriptName=\n\tCommandPath=\n\tCommandLine="}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "level": "4", "task": "8", "keywords": "0x80000000000000", "systemTime": "2021-10-20T14:39:26.0000000Z", "eventRecordID": "133", "channel": "Windows PowerShell", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=15\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=4.0\n\tHostId=63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n\tHostApplication=powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n\tEngineVersion=4.0\n\tRunspaceId=1668d864-c13c-442c-bf70-3fe6a4dee2ca\n\tPipelineId=1\n\tScriptName=\n\tCommandLine=C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id \n\nDetails: \nCommandInvocation(Get-Process): \"Get-Process\"\nParameterBinding(Get-Process): name=\"Name\"; value=\"lsass\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "PowerShell", "providerGuid": {"@Name": "PowerShell"}, "eventID": "800", "level": "4", "task": "8", "keywords": "0x80000000000000", "systemTime": "2021-10-20T14:39:26.0000000Z", "eventRecordID": "134", "channel": "Windows PowerShell", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "Pipeline execution details for command line: C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id. \n\nContext Information: \n\tDetailSequence=1\n\tDetailTotal=1\n\n\tSequenceNumber=17\n\n\tUserId=OFFSEC\\admmig\n\tHostName=ConsoleHost\n\tHostVersion=4.0\n\tHostId=63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n\tHostApplication=powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n\tEngineVersion=4.0\n\tRunspaceId=1668d864-c13c-442c-bf70-3fe6a4dee2ca\n\tPipelineId=1\n\tScriptName=\n\tCommandLine=C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id \n\nDetails: \nCommandInvocation(Get-Process): \"Get-Process\"\nParameterBinding(Get-Process): name=\"Name\"; value=\"rundll32\""}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "40961", "version": "1", "level": "4", "task": "4", "opcode": "1", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2245903Z", "eventRecordID": "1285", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "PowerShell console is starting up"}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2245903Z", "eventRecordID": "1286", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n\"PS $($executionContext.SessionState.Path.CurrentLocation)$('>' * ($nestedPromptLevel + 1)) \"\n# .Link\n# http://go.microsoft.com/fwlink/?LinkID=225750\n# .ExternalHelp System.Management.Automation.dll-help.xml\n\n\nScriptBlock ID: f61a7fd0-2926-4ac5-bcd6-c6c3e886f23c\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "\"PS $($executionContext.SessionState.Path.CurrentLocation)$('>' * ($nestedPromptLevel + 1)) \"\n# .Link\n# http://go.microsoft.com/fwlink/?LinkID=225750\n# .ExternalHelp System.Management.Automation.dll-help.xml", "scriptBlockId": "f61a7fd0-2926-4ac5-bcd6-c6c3e886f23c"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2402153Z", "eventRecordID": "1287", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n\n<# Options include:\n     RelativeFilePaths - [bool]\n         Always resolve file paths using Resolve-Path -Relative.\n         The default is to use some heuristics to guess if relative or absolute is better.\n\n   To customize your own custom options, pass a hashtable to CompleteInput, e.g.\n         return [System.Management.Automation.CommandCompletion]::CompleteInput($inputScript, $cursorColumn,\n             @{ RelativeFilePaths=$false }\n#>\n\n[CmdletBinding(DefaultParameterSetName = 'ScriptInputSet')]\nParam(\n    [Parameter(ParameterSetName = 'ScriptInputSet', Mandatory = $true, Position = 0)]\n    [string] $inputScript,\n    \n    [Parameter(ParameterSetName = 'ScriptInputSet', Mandatory = $true, Position = 1)]\n    [int] $cursorColumn,\n\n    [Parameter(ParameterSetName = 'AstInputSet', Mandatory = $true, Position = 0)]\n    [System.Management.Automation.Language.Ast] $ast,\n\n    [Parameter(ParameterSetName = 'AstInputSet', Mandatory = $true, Position = 1)]\n    [System.Management.Automation.Language.Token[]] $tokens,\n\n    [Parameter(ParameterSetName = 'AstInputSet', Mandatory = $true, Position = 2)]\n    [System.Management.Automation.Language.IScriptPosition] $positionOfCursor,\n    \n    [Parameter(ParameterSetName = 'ScriptInputSet', Position = 2)]\n    [Parameter(ParameterSetName = 'AstInputSet', Position = 3)]\n    [Hashtable] $options = $null\n)\n\nEnd\n{\n    if ($psCmdlet.ParameterSetName -eq 'ScriptInputSet')\n    {\n        return [System.Management.Automation.CommandCompletion]::CompleteInput(\n            <#inputScript#>  $inputScript,\n            <#cursorColumn#> $cursorColumn,\n            <#options#>      $options)\n    }\n    else\n    {\n        return [System.Management.Automation.CommandCompletion]::CompleteInput(\n            <#ast#>              $ast,\n            <#tokens#>           $tokens,\n            <#positionOfCursor#> $positionOfCursor,\n            <#options#>          $options)\n    }\n}\n        \n\nScriptBlock ID: 66868ed0-c888-425b-94c3-df6c50632d81\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "<# Options include:\n     RelativeFilePaths - [bool]\n         Always resolve file paths using Resolve-Path -Relative.\n         The default is to use some heuristics to guess if relative or absolute is better.\n\n   To customize your own custom options, pass a hashtable to CompleteInput, e.g.\n         return [System.Management.Automation.CommandCompletion]::CompleteInput($inputScript, $cursorColumn,\n             @{ RelativeFilePaths=$false }\n#>\n\n[CmdletBinding(DefaultParameterSetName = 'ScriptInputSet')]\nParam(\n    [Parameter(ParameterSetName = 'ScriptInputSet', Mandatory = $true, Position = 0)]\n    [string] $inputScript,\n    \n    [Parameter(ParameterSetName = 'ScriptInputSet', Mandatory = $true, Position = 1)]\n    [int] $cursorColumn,\n\n    [Parameter(ParameterSetName = 'AstInputSet', Mandatory = $true, Position = 0)]\n    [System.Management.Automation.Language.Ast] $ast,\n\n    [Parameter(ParameterSetName = 'AstInputSet', Mandatory = $true, Position = 1)]\n    [System.Management.Automation.Language.Token[]] $tokens,\n\n    [Parameter(ParameterSetName = 'AstInputSet', Mandatory = $true, Position = 2)]\n    [System.Management.Automation.Language.IScriptPosition] $positionOfCursor,\n    \n    [Parameter(ParameterSetName = 'ScriptInputSet', Position = 2)]\n    [Parameter(ParameterSetName = 'AstInputSet', Position = 3)]\n    [Hashtable] $options = $null\n)\n\nEnd\n{\n    if ($psCmdlet.ParameterSetName -eq 'ScriptInputSet')\n    {\n        return [System.Management.Automation.CommandCompletion]::CompleteInput(\n            <#inputScript#>  $inputScript,\n            <#cursorColumn#> $cursorColumn,\n            <#options#>      $options)\n    }\n    else\n    {\n        return [System.Management.Automation.CommandCompletion]::CompleteInput(\n            <#ast#>              $ast,\n            <#tokens#>           $tokens,\n            <#positionOfCursor#> $positionOfCursor,\n            <#options#>          $options)\n    }\n}", "scriptBlockId": "66868ed0-c888-425b-94c3-df6c50632d81"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2402153Z", "eventRecordID": "1288", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n$space = New-Object System.Management.Automation.Host.BufferCell\n$space.Character = ' '\n$space.ForegroundColor = $host.ui.rawui.ForegroundColor\n$space.BackgroundColor = $host.ui.rawui.BackgroundColor\n$rect = New-Object System.Management.Automation.Host.Rectangle\n$rect.Top = $rect.Bottom = $rect.Right = $rect.Left = -1\n$origin = New-Object System.Management.Automation.Host.Coordinates\n$Host.UI.RawUI.CursorPosition = $origin\n$Host.UI.RawUI.SetBufferContents($rect, $space)\n# .Link\n# http://go.microsoft.com/fwlink/?LinkID=225747\n# .ExternalHelp System.Management.Automation.dll-help.xml\n\n\nScriptBlock ID: 348ad715-185a-49c1-9122-a75725a8282e\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "$space = New-Object System.Management.Automation.Host.BufferCell\n$space.Character = ' '\n$space.ForegroundColor = $host.ui.rawui.ForegroundColor\n$space.BackgroundColor = $host.ui.rawui.BackgroundColor\n$rect = New-Object System.Management.Automation.Host.Rectangle\n$rect.Top = $rect.Bottom = $rect.Right = $rect.Left = -1\n$origin = New-Object System.Management.Automation.Host.Coordinates\n$Host.UI.RawUI.CursorPosition = $origin\n$Host.UI.RawUI.SetBufferContents($rect, $space)\n# .Link\n# http://go.microsoft.com/fwlink/?LinkID=225747\n# .ExternalHelp System.Management.Automation.dll-help.xml", "scriptBlockId": "348ad715-185a-49c1-9122-a75725a8282e"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2402153Z", "eventRecordID": "1289", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nparam([string[]]$paths)\n\n$OutputEncoding = [System.Console]::OutputEncoding\n\nif($paths)\n{\n    foreach ($file in $paths)\n    {\n        Get-Content $file | more.com\n    }\n}\nelse\n{\n    $input | more.com\n}\n\n\nScriptBlock ID: d178e9eb-ea8d-43fe-97f5-bf3c74a028dd\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "param([string[]]$paths)\n\n$OutputEncoding = [System.Console]::OutputEncoding\n\nif($paths)\n{\n    foreach ($file in $paths)\n    {\n        Get-Content $file | more.com\n    }\n}\nelse\n{\n    $input | more.com\n}", "scriptBlockId": "d178e9eb-ea8d-43fe-97f5-bf3c74a028dd"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1290", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n\n<#\n.FORWARDHELPTARGETNAME Get-Help\n.FORWARDHELPCATEGORY Cmdlet\n#>\n[CmdletBinding(DefaultParameterSetName='AllUsersView', HelpUri='http://go.microsoft.com/fwlink/?LinkID=113316')]\nparam(\n    [Parameter(Position=0, ValueFromPipelineByPropertyName=$true)]\n    [string]\n    ${Name},\n\n    [string]\n    ${Path},\n\n    [ValidateSet('Alias','Cmdlet','Provider','General','FAQ','Glossary','HelpFile','ScriptCommand','Function','Filter','ExternalScript','All','DefaultHelp','Workflow')]\n    [string[]]\n    ${Category},\n\n    [string[]]\n    ${Component},\n\n    [string[]]\n    ${Functionality},\n\n    [string[]]\n    ${Role},\n\n    [Parameter(ParameterSetName='DetailedView', Mandatory=$true)]\n    [switch]\n    ${Detailed},\n\n    [Parameter(ParameterSetName='AllUsersView')]\n    [switch]\n    ${Full},\n\n    [Parameter(ParameterSetName='Examples', Mandatory=$true)]\n    [switch]\n    ${Examples},\n\n    [Parameter(ParameterSetName='Parameters', Mandatory=$true)]\n    [string]\n    ${Parameter},\n\n    [Parameter(ParameterSetName='Online', Mandatory=$true)]\n    [switch]\n    ${Online},\n\n    [Parameter(ParameterSetName='ShowWindow', Mandatory=$true)]\n    [switch]\n    ${ShowWindow})\n\n      #Set the outputencoding to Console::OutputEncoding. More.com doesn't work well with Unicode.\n      $outputEncoding=[System.Console]::OutputEncoding\n\n      Get-Help @PSBoundParameters | more\n\n\nScriptBlock ID: d5252597-b584-43d6-83da-069e7c04687f\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "<#\n.FORWARDHELPTARGETNAME Get-Help\n.FORWARDHELPCATEGORY Cmdlet\n#>\n[CmdletBinding(DefaultParameterSetName='AllUsersView', HelpUri='http://go.microsoft.com/fwlink/?LinkID=113316')]\nparam(\n    [Parameter(Position=0, ValueFromPipelineByPropertyName=$true)]\n    [string]\n    ${Name},\n\n    [string]\n    ${Path},\n\n    [ValidateSet('Alias','Cmdlet','Provider','General','FAQ','Glossary','HelpFile','ScriptCommand','Function','Filter','ExternalScript','All','DefaultHelp','Workflow')]\n    [string[]]\n    ${Category},\n\n    [string[]]\n    ${Component},\n\n    [string[]]\n    ${Functionality},\n\n    [string[]]\n    ${Role},\n\n    [Parameter(ParameterSetName='DetailedView', Mandatory=$true)]\n    [switch]\n    ${Detailed},\n\n    [Parameter(ParameterSetName='AllUsersView')]\n    [switch]\n    ${Full},\n\n    [Parameter(ParameterSetName='Examples', Mandatory=$true)]\n    [switch]\n    ${Examples},\n\n    [Parameter(ParameterSetName='Parameters', Mandatory=$true)]\n    [string]\n    ${Parameter},\n\n    [Parameter(ParameterSetName='Online', Mandatory=$true)]\n    [switch]\n    ${Online},\n\n    [Parameter(ParameterSetName='ShowWindow', Mandatory=$true)]\n    [switch]\n    ${ShowWindow})\n\n      #Set the outputencoding to Console::OutputEncoding. More.com doesn't work well with Unicode.\n      $outputEncoding=[System.Console]::OutputEncoding\n\n      Get-Help @PSBoundParameters | more", "scriptBlockId": "d5252597-b584-43d6-83da-069e7c04687f"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1291", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n\n<#\n.FORWARDHELPTARGETNAME New-Item\n.FORWARDHELPCATEGORY Cmdlet\n#>\n[CmdletBinding(DefaultParameterSetName='pathSet',\n    SupportsShouldProcess=$true,\n    SupportsTransactions=$true,\n    ConfirmImpact='Medium')]\n    [OutputType([System.IO.DirectoryInfo])]\nparam(\n    [Parameter(ParameterSetName='nameSet', Position=0, ValueFromPipelineByPropertyName=$true)]\n    [Parameter(ParameterSetName='pathSet', Mandatory=$true, Position=0, ValueFromPipelineByPropertyName=$true)]\n    [System.String[]]\n    ${Path},\n\n    [Parameter(ParameterSetName='nameSet', Mandatory=$true, ValueFromPipelineByPropertyName=$true)]\n    [AllowNull()]\n    [AllowEmptyString()]\n    [System.String]\n    ${Name},\n\n    [Parameter(ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true)]\n    [System.Object]\n    ${Value},\n\n    [Switch]\n    ${Force},\n\n    [Parameter(ValueFromPipelineByPropertyName=$true)]\n    [System.Management.Automation.PSCredential]\n    ${Credential}\n)\n\nbegin {\n\n    try {\n        $wrappedCmd = $ExecutionContext.InvokeCommand.GetCommand('New-Item', [System.Management.Automation.CommandTypes]::Cmdlet)\n        $scriptCmd = {& $wrappedCmd -Type Directory @PSBoundParameters }\n        $steppablePipeline = $scriptCmd.GetSteppablePipeline()\n        $steppablePipeline.Begin($PSCmdlet)\n    } catch {\n        throw\n    }\n\n}\n\nprocess {\n\n    try {\n        $steppablePipeline.Process($_)\n    } catch {\n        throw\n    }\n\n}\n\nend {\n\n    try {\n        $steppablePipeline.End()\n    } catch {\n        throw\n    }\n\n}\n\n\n\nScriptBlock ID: 224e56f3-14a2-4d10-9982-81d0d14a3851\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "<#\n.FORWARDHELPTARGETNAME New-Item\n.FORWARDHELPCATEGORY Cmdlet\n#>\n[CmdletBinding(DefaultParameterSetName='pathSet',\n    SupportsShouldProcess=$true,\n    SupportsTransactions=$true,\n    ConfirmImpact='Medium')]\n    [OutputType([System.IO.DirectoryInfo])]\nparam(\n    [Parameter(ParameterSetName='nameSet', Position=0, ValueFromPipelineByPropertyName=$true)]\n    [Parameter(ParameterSetName='pathSet', Mandatory=$true, Position=0, ValueFromPipelineByPropertyName=$true)]\n    [System.String[]]\n    ${Path},\n\n    [Parameter(ParameterSetName='nameSet', Mandatory=$true, ValueFromPipelineByPropertyName=$true)]\n    [AllowNull()]\n    [AllowEmptyString()]\n    [System.String]\n    ${Name},\n\n    [Parameter(ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true)]\n    [System.Object]\n    ${Value},\n\n    [Switch]\n    ${Force},\n\n    [Parameter(ValueFromPipelineByPropertyName=$true)]\n    [System.Management.Automation.PSCredential]\n    ${Credential}\n)\n\nbegin {\n\n    try {\n        $wrappedCmd = $ExecutionContext.InvokeCommand.GetCommand('New-Item', [System.Management.Automation.CommandTypes]::Cmdlet)\n        $scriptCmd = {& $wrappedCmd -Type Directory @PSBoundParameters }\n        $steppablePipeline = $scriptCmd.GetSteppablePipeline()\n        $steppablePipeline.Begin($PSCmdlet)\n    } catch {\n        throw\n    }\n\n}\n\nprocess {\n\n    try {\n        $steppablePipeline.Process($_)\n    } catch {\n        throw\n    }\n\n}\n\nend {\n\n    try {\n        $steppablePipeline.End()\n    } catch {\n        throw\n    }\n\n}", "scriptBlockId": "224e56f3-14a2-4d10-9982-81d0d14a3851"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1292", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n\nparam(\n    [Parameter(ValueFromPipeline=$true)]\n    [string[]]\n    $verb = '*'\n)\nbegin {\n    $allVerbs = [PSObject].Assembly.GetTypes() |\n        Where-Object {$_.Name -match '^Verbs.'} |\n        Get-Member -type Properties -static |\n        Select-Object @{\n            Name='Verb'\n            Expression = {$_.Name}\n        }, @{\n            Name='Group'\n            Expression = {\n                $str = \"$($_.TypeName)\"\n                $str.Substring($str.LastIndexOf('Verbs') + 5)\n            }\n        }\n}\nprocess {\n    foreach ($v in $verb) {\n        $allVerbs | Where-Object { $_.Verb -like $v }\n    }\n}\n# .Link\n# http://go.microsoft.com/fwlink/?LinkID=160712\n# .ExternalHelp System.Management.Automation.dll-help.xml\n\n\nScriptBlock ID: 78bfcb10-c68f-466a-8f92-8fa4504f4a1b\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "param(\n    [Parameter(ValueFromPipeline=$true)]\n    [string[]]\n    $verb = '*'\n)\nbegin {\n    $allVerbs = [PSObject].Assembly.GetTypes() |\n        Where-Object {$_.Name -match '^Verbs.'} |\n        Get-Member -type Properties -static |\n        Select-Object @{\n            Name='Verb'\n            Expression = {$_.Name}\n        }, @{\n            Name='Group'\n            Expression = {\n                $str = \"$($_.TypeName)\"\n                $str.Substring($str.LastIndexOf('Verbs') + 5)\n            }\n        }\n}\nprocess {\n    foreach ($v in $verb) {\n        $allVerbs | Where-Object { $_.Verb -like $v }\n    }\n}\n# .Link\n# http://go.microsoft.com/fwlink/?LinkID=160712\n# .ExternalHelp System.Management.Automation.dll-help.xml", "scriptBlockId": "78bfcb10-c68f-466a-8f92-8fa4504f4a1b"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1293", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n\n[CmdletBinding()]\nparam(\n    [ValidateRange(2, 2147483647)]\n    [int]\n    ${Width},\n\n    [Parameter(ValueFromPipeline=$true)]\n    [psobject]\n    ${InputObject})\n\nbegin\n{\n    try {\n        $PSBoundParameters['Stream'] = $true\n        $wrappedCmd = $ExecutionContext.InvokeCommand.GetCommand('Out-String',[System.Management.Automation.CommandTypes]::Cmdlet)\n        $scriptCmd = {& $wrappedCmd @PSBoundParameters }\n        $steppablePipeline = $scriptCmd.GetSteppablePipeline($myInvocation.CommandOrigin)\n        $steppablePipeline.Begin($PSCmdlet)\n    } catch {\n        throw\n    }\n}\n\nprocess\n{\n    try {\n        $steppablePipeline.Process($_)\n    } catch {\n        throw\n    }\n}\n\nend\n{\n    try {\n        $steppablePipeline.End()\n    } catch {\n        throw\n    }\n}\n<#\n.ForwardHelpTargetName Out-String\n.ForwardHelpCategory Cmdlet\n#>\n\n\nScriptBlock ID: ed0d1dfc-abc8-443c-bb7a-d04089c79523\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "[CmdletBinding()]\nparam(\n    [ValidateRange(2, 2147483647)]\n    [int]\n    ${Width},\n\n    [Parameter(ValueFromPipeline=$true)]\n    [psobject]\n    ${InputObject})\n\nbegin\n{\n    try {\n        $PSBoundParameters['Stream'] = $true\n        $wrappedCmd = $ExecutionContext.InvokeCommand.GetCommand('Out-String',[System.Management.Automation.CommandTypes]::Cmdlet)\n        $scriptCmd = {& $wrappedCmd @PSBoundParameters }\n        $steppablePipeline = $scriptCmd.GetSteppablePipeline($myInvocation.CommandOrigin)\n        $steppablePipeline.Begin($PSCmdlet)\n    } catch {\n        throw\n    }\n}\n\nprocess\n{\n    try {\n        $steppablePipeline.Process($_)\n    } catch {\n        throw\n    }\n}\n\nend\n{\n    try {\n        $steppablePipeline.End()\n    } catch {\n        throw\n    }\n}\n<#\n.ForwardHelpTargetName Out-String\n.ForwardHelpCategory Cmdlet\n#>", "scriptBlockId": "ed0d1dfc-abc8-443c-bb7a-d04089c79523"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1294", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location A:\n\nScriptBlock ID: a7a8ac6e-44e9-4f59-8bac-08f6723bb96c\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location A:", "scriptBlockId": "a7a8ac6e-44e9-4f59-8bac-08f6723bb96c"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1295", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location B:\n\nScriptBlock ID: d349dff4-1b33-4f74-a75d-58c338469bee\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location B:", "scriptBlockId": "d349dff4-1b33-4f74-a75d-58c338469bee"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1296", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location C:\n\nScriptBlock ID: bba854a0-def6-46a5-8bb7-1148c2dee707\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location C:", "scriptBlockId": "bba854a0-def6-46a5-8bb7-1148c2dee707"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1297", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location D:\n\nScriptBlock ID: 337c5921-1256-48f0-aa49-2d99a0c89d42\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location D:", "scriptBlockId": "337c5921-1256-48f0-aa49-2d99a0c89d42"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1298", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location E:\n\nScriptBlock ID: 5ff5041a-7729-40ba-9360-4a67b66b02be\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location E:", "scriptBlockId": "5ff5041a-7729-40ba-9360-4a67b66b02be"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1299", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location F:\n\nScriptBlock ID: c09fb18f-c755-4d29-aa23-59b9e8db6f00\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location F:", "scriptBlockId": "c09fb18f-c755-4d29-aa23-59b9e8db6f00"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1300", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location G:\n\nScriptBlock ID: 94499135-462f-4e6c-912c-9c02f1395c91\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location G:", "scriptBlockId": "94499135-462f-4e6c-912c-9c02f1395c91"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1301", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location H:\n\nScriptBlock ID: fc3de4d3-5288-4949-ae31-20413ae88de4\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location H:", "scriptBlockId": "fc3de4d3-5288-4949-ae31-20413ae88de4"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1302", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location I:\n\nScriptBlock ID: 8557dd9a-4938-44c8-8c90-1e624d9fe001\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location I:", "scriptBlockId": "8557dd9a-4938-44c8-8c90-1e624d9fe001"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1303", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location J:\n\nScriptBlock ID: c5a74e47-9a83-459e-ba78-2a186f3f4b89\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location J:", "scriptBlockId": "c5a74e47-9a83-459e-ba78-2a186f3f4b89"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1304", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location K:\n\nScriptBlock ID: eb9be239-a0b7-47d8-9d09-f1fd8e8e308e\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location K:", "scriptBlockId": "eb9be239-a0b7-47d8-9d09-f1fd8e8e308e"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1305", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location L:\n\nScriptBlock ID: 38fc7c20-6e22-4297-9603-711614fea4fb\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location L:", "scriptBlockId": "38fc7c20-6e22-4297-9603-711614fea4fb"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1306", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location M:\n\nScriptBlock ID: 96bf0226-b104-4c70-996c-e0cddc8a906d\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location M:", "scriptBlockId": "96bf0226-b104-4c70-996c-e0cddc8a906d"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1307", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location N:\n\nScriptBlock ID: f853a427-32a2-477d-86d2-e8d55a29de4b\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location N:", "scriptBlockId": "f853a427-32a2-477d-86d2-e8d55a29de4b"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1308", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location O:\n\nScriptBlock ID: 34f07b98-3fa7-4c94-b23b-de4d409173dd\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location O:", "scriptBlockId": "34f07b98-3fa7-4c94-b23b-de4d409173dd"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1309", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location P:\n\nScriptBlock ID: 7643c353-2dd8-4588-bd19-068372f4449e\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location P:", "scriptBlockId": "7643c353-2dd8-4588-bd19-068372f4449e"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1310", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location Q:\n\nScriptBlock ID: bafee791-5f61-478c-b27e-fc6051f02424\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location Q:", "scriptBlockId": "bafee791-5f61-478c-b27e-fc6051f02424"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1311", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location R:\n\nScriptBlock ID: 6ae074a7-11e8-4034-94cb-0bca270db926\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location R:", "scriptBlockId": "6ae074a7-11e8-4034-94cb-0bca270db926"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1312", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location S:\n\nScriptBlock ID: bf31dd02-765f-415c-a7be-2928165332ab\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location S:", "scriptBlockId": "bf31dd02-765f-415c-a7be-2928165332ab"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1313", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location T:\n\nScriptBlock ID: d5101983-d5b5-4a4b-a4c2-1e28c394c17b\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location T:", "scriptBlockId": "d5101983-d5b5-4a4b-a4c2-1e28c394c17b"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1314", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location U:\n\nScriptBlock ID: b3436631-814a-4e9a-a9f5-f653e66afbb3\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location U:", "scriptBlockId": "b3436631-814a-4e9a-a9f5-f653e66afbb3"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1315", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location V:\n\nScriptBlock ID: 682fcbda-a369-44b6-964b-f807b55f4783\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location V:", "scriptBlockId": "682fcbda-a369-44b6-964b-f807b55f4783"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1316", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location W:\n\nScriptBlock ID: 506c4b22-1250-4c1e-ba20-04bfe17784e8\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location W:", "scriptBlockId": "506c4b22-1250-4c1e-ba20-04bfe17784e8"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1317", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location X:\n\nScriptBlock ID: 66d0e449-6174-4689-8701-954793f4319c\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location X:", "scriptBlockId": "66d0e449-6174-4689-8701-954793f4319c"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1318", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location Y:\n\nScriptBlock ID: a1df8479-12de-4867-91d2-8adbd07329e8\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location Y:", "scriptBlockId": "a1df8479-12de-4867-91d2-8adbd07329e8"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1319", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location Z:\n\nScriptBlock ID: 2bea488b-2464-494c-999e-3e03854df0e7\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location Z:", "scriptBlockId": "2bea488b-2464-494c-999e-3e03854df0e7"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1320", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location ..\n\nScriptBlock ID: 075b4a15-6529-4d7a-a310-86e866066eff\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location ..", "scriptBlockId": "075b4a15-6529-4d7a-a310-86e866066eff"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1321", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nSet-Location \\\n\nScriptBlock ID: f0d12f4c-3604-42e8-89c0-551e9edd388f\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Set-Location \\", "scriptBlockId": "f0d12f4c-3604-42e8-89c0-551e9edd388f"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1322", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n\n\nScriptBlock ID: 0783d7d2-2c3f-405e-b294-070c778241d6\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockId": "0783d7d2-2c3f-405e-b294-070c778241d6"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.2558412Z", "eventRecordID": "1323", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nRead-Host 'Press Enter to continue...' | Out-Null\n\nScriptBlock ID: 8bda6354-51f2-4779-ac7b-603934bc393a\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "Read-Host 'Press Enter to continue...' | Out-Null", "scriptBlockId": "8bda6354-51f2-4779-ac7b-603934bc393a"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.3027207Z", "eventRecordID": "1324", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n$this.ServiceName\n\nScriptBlock ID: 5336aa33-1fb7-4d40-bfbf-f0eb6d0c659f\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "$this.ServiceName", "scriptBlockId": "5336aa33-1fb7-4d40-bfbf-f0eb6d0c659f"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.3027207Z", "eventRecordID": "1325", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n[System.Management.ManagementDateTimeConverter]::ToDateTime($args[0])\n\nScriptBlock ID: 6183a262-7846-45f4-af7a-4622cd671790\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "[System.Management.ManagementDateTimeConverter]::ToDateTime($args[0])", "scriptBlockId": "6183a262-7846-45f4-af7a-4622cd671790"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.3027207Z", "eventRecordID": "1326", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n[System.Management.ManagementDateTimeConverter]::ToDmtfDateTime($args[0])\n\nScriptBlock ID: 701d6e25-2203-4c4a-83b0-f3f656166317\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "[System.Management.ManagementDateTimeConverter]::ToDmtfDateTime($args[0])", "scriptBlockId": "701d6e25-2203-4c4a-83b0-f3f656166317"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "40962", "version": "1", "level": "4", "task": "4", "opcode": "2", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.3339688Z", "eventRecordID": "1327", "processID": "3268", "threadID": "3532", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "PowerShell console is ready for user input"}, "eventdata": {}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.3495919Z", "eventRecordID": "1328", "processID": "3268", "threadID": "1584", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\nC:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n\nScriptBlock ID: 4b8cd779-8c92-48a7-b407-8a119e38c45a\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id", "scriptBlockId": "4b8cd779-8c92-48a7-b407-8a119e38c45a"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4104", "version": "1", "level": "5", "task": "102", "opcode": "15", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.3964706Z", "eventRecordID": "1329", "processID": "3268", "threadID": "1584", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "VERBOSE", "message": "Creating Scriptblock text (1 of 1):\n@{\nGUID=\"EEFCB906-B326-4E99-9F54-8B4BB6EF3C6D\"\nAuthor=\"Microsoft Corporation\"\nCompanyName=\"Microsoft Corporation\"\nCopyright=\"\u00a9 Microsoft Corporation. All rights reserved.\"\nModuleVersion=\"3.1.0.0\"\nPowerShellVersion=\"3.0\"\nCLRVersion=\"4.0\"\nNestedModules=\"Microsoft.PowerShell.Commands.Management.dll\"\nHelpInfoURI = 'http://go.microsoft.com/fwlink/?linkid=285756'\nCmdletsToExport=@(\"Add-Content\",\n    \"Clear-Content\",\n    \"Clear-ItemProperty\",\n    \"Join-Path\",\n    \"Convert-Path\",\n    \"Copy-ItemProperty\",\n    \"Get-EventLog\",\n    \"Clear-EventLog\",\n    \"Write-EventLog\",\n    \"Limit-EventLog\",\n    \"Show-EventLog\",\n    \"New-EventLog\",\n    \"Remove-EventLog\",\n    \"Get-ChildItem\",\n    \"Get-Content\",\n    \"Get-ItemProperty\",\n    \"Get-WmiObject\",\n    \"Invoke-WmiMethod\",\n    \"Move-ItemProperty\",\n    \"Get-Location\",\n    \"Set-Location\",\n    \"Push-Location\",\n    \"Pop-Location\",\n    \"New-PSDrive\",\n    \"Remove-PSDrive\",\n    \"Get-PSDrive\",\n    \"Get-Item\",\n    \"New-Item\",\n    \"Set-Item\",\n    \"Remove-Item\",\n    \"Move-Item\",\n    \"Rename-Item\",\n    \"Copy-Item\",\n    \"Clear-Item\",\n    \"Invoke-Item\",\n    \"Get-PSProvider\",\n    \"New-ItemProperty\",\n    \"Split-Path\",\n    \"Test-Path\",\n    \"Get-Process\",\n    \"Stop-Process\",\n    \"Wait-Process\",\n    \"Debug-Process\",\n    \"Start-Process\",\n    \"Remove-ItemProperty\",\n    \"Remove-WmiObject\",\n    \"Rename-ItemProperty\",\n    \"Register-WmiEvent\",\n    \"Resolve-Path\",\n    \"Get-Service\",\n    \"Stop-Service\",\n    \"Start-Service\",\n    \"Suspend-Service\",\n    \"Resume-Service\",\n    \"Restart-Service\",\n    \"Set-Service\",\n    \"New-Service\",\n    \"Set-Content\",\n    \"Set-ItemProperty\",\n    \"Set-WmiInstance\",\n    \"Get-Transaction\",\n    \"Start-Transaction\",\n    \"Complete-Transaction\",\n    \"Undo-Transaction\",\n    \"Use-Transaction\",\n    \"New-WebServiceProxy\",\n    \"Get-HotFix\",\n    \"Test-Connection\",\n    \"Enable-ComputerRestore\",\n    \"Disable-ComputerRestore\",\n    \"Checkpoint-Computer\",\n    \"Get-ComputerRestorePoint\",\n    \"Restart-Computer\",\n    \"Stop-Computer\",\n    \"Restore-Computer\",\n    \"Add-Computer\",\n    \"Remove-Computer\",\n    \"Test-ComputerSecureChannel\",\n    \"Reset-ComputerMachinePassword\",\n    \"Rename-Computer\",\n    \"Get-ControlPanelItem\",\n    \"Show-ControlPanelItem\")\n}\n\n\nScriptBlock ID: 62c273e1-22da-44fc-a6c3-5cb365453815\nPath: %5"}, "eventdata": {"messageNumber": "1", "messageTotal": "1", "scriptBlockText": "@{\nGUID=\"EEFCB906-B326-4E99-9F54-8B4BB6EF3C6D\"\nAuthor=\"Microsoft Corporation\"\nCompanyName=\"Microsoft Corporation\"\nCopyright=\"\u00a9 Microsoft Corporation. All rights reserved.\"\nModuleVersion=\"3.1.0.0\"\nPowerShellVersion=\"3.0\"\nCLRVersion=\"4.0\"\nNestedModules=\"Microsoft.PowerShell.Commands.Management.dll\"\nHelpInfoURI = 'http://go.microsoft.com/fwlink/?linkid=285756'\nCmdletsToExport=@(\"Add-Content\",\n    \"Clear-Content\",\n    \"Clear-ItemProperty\",\n    \"Join-Path\",\n    \"Convert-Path\",\n    \"Copy-ItemProperty\",\n    \"Get-EventLog\",\n    \"Clear-EventLog\",\n    \"Write-EventLog\",\n    \"Limit-EventLog\",\n    \"Show-EventLog\",\n    \"New-EventLog\",\n    \"Remove-EventLog\",\n    \"Get-ChildItem\",\n    \"Get-Content\",\n    \"Get-ItemProperty\",\n    \"Get-WmiObject\",\n    \"Invoke-WmiMethod\",\n    \"Move-ItemProperty\",\n    \"Get-Location\",\n    \"Set-Location\",\n    \"Push-Location\",\n    \"Pop-Location\",\n    \"New-PSDrive\",\n    \"Remove-PSDrive\",\n    \"Get-PSDrive\",\n    \"Get-Item\",\n    \"New-Item\",\n    \"Set-Item\",\n    \"Remove-Item\",\n    \"Move-Item\",\n    \"Rename-Item\",\n    \"Copy-Item\",\n    \"Clear-Item\",\n    \"Invoke-Item\",\n    \"Get-PSProvider\",\n    \"New-ItemProperty\",\n    \"Split-Path\",\n    \"Test-Path\",\n    \"Get-Process\",\n    \"Stop-Process\",\n    \"Wait-Process\",\n    \"Debug-Process\",\n    \"Start-Process\",\n    \"Remove-ItemProperty\",\n    \"Remove-WmiObject\",\n    \"Rename-ItemProperty\",\n    \"Register-WmiEvent\",\n    \"Resolve-Path\",\n    \"Get-Service\",\n    \"Stop-Service\",\n    \"Start-Service\",\n    \"Suspend-Service\",\n    \"Resume-Service\",\n    \"Restart-Service\",\n    \"Set-Service\",\n    \"New-Service\",\n    \"Set-Content\",\n    \"Set-ItemProperty\",\n    \"Set-WmiInstance\",\n    \"Get-Transaction\",\n    \"Start-Transaction\",\n    \"Complete-Transaction\",\n    \"Undo-Transaction\",\n    \"Use-Transaction\",\n    \"New-WebServiceProxy\",\n    \"Get-HotFix\",\n    \"Test-Connection\",\n    \"Enable-ComputerRestore\",\n    \"Disable-ComputerRestore\",\n    \"Checkpoint-Computer\",\n    \"Get-ComputerRestorePoint\",\n    \"Restart-Computer\",\n    \"Stop-Computer\",\n    \"Restore-Computer\",\n    \"Add-Computer\",\n    \"Remove-Computer\",\n    \"Test-ComputerSecureChannel\",\n    \"Reset-ComputerMachinePassword\",\n    \"Rename-Computer\",\n    \"Get-ControlPanelItem\",\n    \"Show-ControlPanelItem\")\n}", "scriptBlockId": "62c273e1-22da-44fc-a6c3-5cb365453815"}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.4277303Z", "eventRecordID": "1330", "processID": "3268", "threadID": "1584", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Get-Process): \"Get-Process\"\nParameterBinding(Get-Process): name=\"Name\"; value=\"lsass\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 4.0\n        Host ID = 63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n        Host Application = powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n        Engine Version = 4.0\n        Runspace ID = 1668d864-c13c-442c-bf70-3fe6a4dee2ca\n        Pipeline ID = 1\n        Command Name = Get-Process\n        Command Type = Cmdlet\n        Script Name = \n        Command Path = \n        Sequence Number = 16\n        User = OFFSEC\\admmig\n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 4.0\n        Host ID = 63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n        Host Application = powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n        Engine Version = 4.0\n        Runspace ID = 1668d864-c13c-442c-bf70-3fe6a4dee2ca\n        Pipeline ID = 1\n        Command Name = Get-Process\n        Command Type = Cmdlet\n        Script Name = \n        Command Path = \n        Sequence Number = 16\n        User = OFFSEC\\admmig\n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Get-Process): \"Get-Process\"\nParameterBinding(Get-Process): name=\"Name\"; value=\"lsass\""}}}''',
            r'''{"win": {"system": {"providerName": "Microsoft-Windows-PowerShell", "providerGuid": "{a0c1853b-5c40-4b15-8766-3cf1c58f985a}", "eventID": "4103", "version": "1", "level": "4", "task": "106", "opcode": "20", "keywords": "0x0", "systemTime": "2021-10-20T14:39:26.4277303Z", "eventRecordID": "1331", "processID": "3268", "threadID": "1584", "channel": "Microsoft-Windows-PowerShell/Operational", "computer": "FS03.offsec.lan", "severityValue": "INFORMATION", "message": "CommandInvocation(Get-Process): \"Get-Process\"\nParameterBinding(Get-Process): name=\"Name\"; value=\"rundll32\"\n\n\nContext:\n        Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 4.0\n        Host ID = 63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n        Host Application = powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n        Engine Version = 4.0\n        Runspace ID = 1668d864-c13c-442c-bf70-3fe6a4dee2ca\n        Pipeline ID = 1\n        Command Name = Get-Process\n        Command Type = Cmdlet\n        Script Name = \n        Command Path = \n        Sequence Number = 18\n        User = OFFSEC\\admmig\n        Shell ID = Microsoft.PowerShell\n\n\nUser Data:"}, "eventdata": {"contextInfo": "Severity = Informational\n        Host Name = ConsoleHost\n        Host Version = 4.0\n        Host ID = 63c2be9c-cd2c-46d7-ac07-01a9e98f2400\n        Host Application = powershell.exe -NoP -C C:\\Windows\\System32\\rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump (Get-Process lsass).Id \\Windows\\Temp\\vtnr8kff.dmp full;Wait-Process -Id (Get-Process rundll32).id\n        Engine Version = 4.0\n        Runspace ID = 1668d864-c13c-442c-bf70-3fe6a4dee2ca\n        Pipeline ID = 1\n        Command Name = Get-Process\n        Command Type = Cmdlet\n        Script Name = \n        Command Path = \n        Sequence Number = 18\n        User = OFFSEC\\admmig\n        Shell ID = Microsoft.PowerShell", "payload": "CommandInvocation(Get-Process): \"Get-Process\"\nParameterBinding(Get-Process): name=\"Name\"; value=\"rundll32\""}}}'''
        ]

        responses = send_multiple_logs(logs, location="stdin", log_format="json")

        # Ensure we receive a response for each log sent
        self.assertEqual(len(responses), len(logs))

        for _, response in enumerate(responses):
            self.assertEqual(response.status, LogtestStatus.RuleMatch)
            self.assertEqual(response.decoder, 'json')

            # Example: Set expected Wazuh rule ID and level when analyzing logs
            # expected_rule_id = None  # Replace with actual rule ID
            # expected_rule_level = None  # Replace with actual rule level

            # self.assertEqual(response.rule_id, expected_rule_id)
            # self.assertEqual(response.rule_level, expected_rule_level)

        # TODO: Write the expected result as test cases when the logs are analyzed by Wazuh.
        self.fail("Test not implemented yet. Define expected results.")
